<!doctype html>
<html class="no-js" lang="en" data-content_root="../../../">
  <head><meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="color-scheme" content="light dark"><link rel="index" title="Index" href="../../../genindex.html"><link rel="search" title="Search" href="../../../search.html">

    <!-- Generated with Sphinx 9.0.4 and Furo 2025.12.19 -->
        <title>PyART.models.ringdown_fits - PyART 0.0.1dev documentation</title>
      <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=d111a655" />
    <link rel="stylesheet" type="text/css" href="../../../_static/styles/furo.css?v=7bdb33bb" />
    <link rel="stylesheet" type="text/css" href="../../../_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/graphviz.css?v=4ae1632d" />
    <link rel="stylesheet" type="text/css" href="../../../_static/styles/furo-extensions.css?v=8dab3a3b" />
    
    


<style>
  body {
    --color-code-background: #f2f2f2;
  --color-code-foreground: #1e1e1e;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle site navigation sidebar">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc" aria-label="Toggle table of contents sidebar">
<label class="overlay sidebar-overlay" for="__navigation"></label>
<label class="overlay toc-overlay" for="__toc"></label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <span class="icon"><svg><use href="#svg-menu"></use></svg></span>
      </label>
    </div>
    <div class="header-center">
      <a href="../../../index.html"><div class="brand">PyART 0.0.1dev documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle" aria-label="Toggle Light / Dark / Auto color theme">
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon no-toc" for="__toc">
        <span class="icon"><svg><use href="#svg-toc"></use></svg></span>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../../../index.html">
  
  <span class="sidebar-brand-text">PyART 0.0.1dev documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="../../../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../tutorials/intro_to_waveforms.html">1. Intro to Waveforms</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../tutorials/catalog_downloads.html">Downloading Waveforms from Different Catalogs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../tutorials/phase_alignment.html">Time and Phase Alignment</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../tutorials/nr_eob_mismatch.html">Computing Mismatches Between NR and EOB Waveforms</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../tutorials/optimizing_initial_conditions.html">Optimizing Initial Conditions for EOB Waveforms</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../tutorials/iccub_waveform_integration.html">Working with ICCUB Catalog and Waveform Integration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../tutorials/scattering_angles.html">Scattering Angles from EOB Data</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../autoapi/index.html">API Reference</a><input aria-label="Toggle navigation of API Reference" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../autoapi/PyART/index.html">PyART</a><input aria-label="Toggle navigation of PyART" class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../../autoapi/PyART/analysis/index.html">PyART.analysis</a><input aria-label="Toggle navigation of PyART.analysis" class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../autoapi/PyART/analysis/calc_coprecessing/index.html">PyART.analysis.calc_coprecessing</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../autoapi/PyART/analysis/eccentricity_calc/index.html">PyART.analysis.eccentricity_calc</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../autoapi/PyART/analysis/hypfit/index.html">PyART.analysis.hypfit</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../autoapi/PyART/analysis/integrate_wave/index.html">PyART.analysis.integrate_wave</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../autoapi/PyART/analysis/match/index.html">PyART.analysis.match</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../autoapi/PyART/analysis/opt_ic/index.html">PyART.analysis.opt_ic</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../autoapi/PyART/analysis/parspace_TEOB/index.html">PyART.analysis.parspace_TEOB</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../autoapi/PyART/analysis/scattering_angle/index.html">PyART.analysis.scattering_angle</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../../autoapi/PyART/analytic/index.html">PyART.analytic</a><input aria-label="Toggle navigation of PyART.analytic" class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../autoapi/PyART/analytic/coordschange/index.html">PyART.analytic.coordschange</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../../autoapi/PyART/catalogs/index.html">PyART.catalogs</a><input aria-label="Toggle navigation of PyART.catalogs" class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" role="switch" type="checkbox"/><label for="toctree-checkbox-5"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../autoapi/PyART/catalogs/cataloger/index.html">PyART.catalogs.cataloger</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../autoapi/PyART/catalogs/core/index.html">PyART.catalogs.core</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../autoapi/PyART/catalogs/gra/index.html">PyART.catalogs.gra</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../autoapi/PyART/catalogs/gra_hyp/index.html">PyART.catalogs.gra_hyp</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../autoapi/PyART/catalogs/icc/index.html">PyART.catalogs.icc</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../autoapi/PyART/catalogs/icc_public/index.html">PyART.catalogs.icc_public</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../autoapi/PyART/catalogs/lvknr/index.html">PyART.catalogs.lvknr</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../autoapi/PyART/catalogs/maya/index.html">PyART.catalogs.maya</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../autoapi/PyART/catalogs/rit/index.html">PyART.catalogs.rit</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../autoapi/PyART/catalogs/rwz/index.html">PyART.catalogs.rwz</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../autoapi/PyART/catalogs/sacra/index.html">PyART.catalogs.sacra</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../autoapi/PyART/catalogs/sxs/index.html">PyART.catalogs.sxs</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../autoapi/PyART/logging_config/index.html">PyART.logging_config</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../../autoapi/PyART/models/index.html">PyART.models</a><input aria-label="Toggle navigation of PyART.models" class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" role="switch" type="checkbox"/><label for="toctree-checkbox-6"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../autoapi/PyART/models/bajes/index.html">PyART.models.bajes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../autoapi/PyART/models/lal/index.html">PyART.models.lal</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../autoapi/PyART/models/ringdown/index.html">PyART.models.ringdown</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../autoapi/PyART/models/ringdown_fits/index.html">PyART.models.ringdown_fits</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../autoapi/PyART/models/ringdown_fits_noncirc/index.html">PyART.models.ringdown_fits_noncirc</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../autoapi/PyART/models/seob/index.html">PyART.models.seob</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../autoapi/PyART/models/teob/index.html">PyART.models.teob</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../autoapi/PyART/models/teob_matlab/index.html">PyART.models.teob_matlab</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../../autoapi/PyART/numerical/index.html">PyART.numerical</a><input aria-label="Toggle navigation of PyART.numerical" class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" role="switch" type="checkbox"/><label for="toctree-checkbox-7"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../autoapi/PyART/numerical/twopuncts_ID/index.html">PyART.numerical.twopuncts_ID</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../autoapi/PyART/simulations/index.html">PyART.simulations</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../../autoapi/PyART/utils/index.html">PyART.utils</a><input aria-label="Toggle navigation of PyART.utils" class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" role="switch" type="checkbox"/><label for="toctree-checkbox-8"><span class="icon"><svg><use href="#svg-arrow-right"></use></svg></span></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../autoapi/PyART/utils/cat_utils/index.html">PyART.utils.cat_utils</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../autoapi/PyART/utils/convert_sxs_to_lvc/index.html">PyART.utils.convert_sxs_to_lvc</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../autoapi/PyART/utils/load_nr_utils/index.html">PyART.utils.load_nr_utils</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../autoapi/PyART/utils/os_utils/index.html">PyART.utils.os_utils</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../autoapi/PyART/utils/utils/index.html">PyART.utils.utils</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../autoapi/PyART/utils/wf_utils/index.html">PyART.utils.wf_utils</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../autoapi/PyART/waveform/index.html">PyART.waveform</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../autoapi/simulations/index.html">simulations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../autoapi/tocatalog_icc/index.html">tocatalog_icc</a></li>
</ul>
</li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle" aria-label="Toggle Light / Dark / Auto color theme">
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon no-toc" for="__toc">
            <span class="icon"><svg><use href="#svg-toc"></use></svg></span>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <h1>Source code for PyART.models.ringdown_fits</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Pure python implementation of the (old) TEOBResumS ringdown.</span>
<span class="sd">Copy-paste of PyRing, with minor mods.</span>
<span class="sd">https://git.ligo.org/lscsoft/pyring/-/blob/master/pyRing/eob_utils.pyx?ref_type=heads</span>
<span class="sd">https://bitbucket.org/eob_ihes/teobresums/src/master/C/src/TEOBResumSFits.c</span>

<span class="sd">TODO: it would be better to have all fixed coefficients called/computed only once, and then stored</span>
<span class="sd">in e.g. a dictionary. Now, they are evaluated every time the function is called, which is suboptimal.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>


<div class="viewcode-block" id="Y">
<a class="viewcode-back" href="../../../autoapi/PyART/models/ringdown_fits/index.html#PyART.models.ringdown_fits.Y">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">Y</span><span class="p">(</span><span class="n">Y_0</span><span class="p">,</span> <span class="n">b_1</span><span class="p">,</span> <span class="n">b_2</span><span class="p">,</span> <span class="n">b_3</span><span class="p">,</span> <span class="n">c_1</span><span class="p">,</span> <span class="n">c_2</span><span class="p">,</span> <span class="n">c_3</span><span class="p">,</span> <span class="n">af</span><span class="p">,</span> <span class="n">af2</span><span class="p">,</span> <span class="n">af3</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">_Y</span><span class="p">(</span><span class="n">Y_0</span><span class="p">,</span> <span class="n">b_1</span><span class="p">,</span> <span class="n">b_2</span><span class="p">,</span> <span class="n">b_3</span><span class="p">,</span> <span class="n">c_1</span><span class="p">,</span> <span class="n">c_2</span><span class="p">,</span> <span class="n">c_3</span><span class="p">,</span> <span class="n">af</span><span class="p">,</span> <span class="n">af2</span><span class="p">,</span> <span class="n">af3</span><span class="p">)</span></div>



<span class="c1"># eq. 5.21 of arXiv:1904.09550v2</span>
<div class="viewcode-block" id="_Y">
<a class="viewcode-back" href="../../../autoapi/PyART/models/ringdown_fits/index.html#PyART.models.ringdown_fits._Y">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">_Y</span><span class="p">(</span><span class="n">Y_0</span><span class="p">,</span> <span class="n">b_1</span><span class="p">,</span> <span class="n">b_2</span><span class="p">,</span> <span class="n">b_3</span><span class="p">,</span> <span class="n">c_1</span><span class="p">,</span> <span class="n">c_2</span><span class="p">,</span> <span class="n">c_3</span><span class="p">,</span> <span class="n">af</span><span class="p">,</span> <span class="n">af2</span><span class="p">,</span> <span class="n">af3</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Function implementing eq. 5.21 of arXiv:1904.09550v2.</span>
<span class="sd">    It is the same fitting equation for the three coefficients alpha1, alpha21, omega1.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">res</span> <span class="o">=</span> <span class="mf">0.0</span>

    <span class="n">num</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">b_1</span> <span class="o">*</span> <span class="n">af</span> <span class="o">+</span> <span class="n">b_2</span> <span class="o">*</span> <span class="n">af2</span> <span class="o">+</span> <span class="n">b_3</span> <span class="o">*</span> <span class="n">af3</span>
    <span class="n">den</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">c_1</span> <span class="o">*</span> <span class="n">af</span> <span class="o">+</span> <span class="n">c_2</span> <span class="o">*</span> <span class="n">af2</span> <span class="o">+</span> <span class="n">c_3</span> <span class="o">*</span> <span class="n">af3</span>
    <span class="n">res</span> <span class="o">=</span> <span class="n">Y_0</span> <span class="o">*</span> <span class="n">num</span> <span class="o">/</span> <span class="n">den</span>

    <span class="k">return</span> <span class="n">res</span></div>



<div class="viewcode-block" id="_alpha1">
<a class="viewcode-back" href="../../../autoapi/PyART/models/ringdown_fits/index.html#PyART.models.ringdown_fits._alpha1">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">_alpha1</span><span class="p">(</span><span class="n">af</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">m</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Function returning the value of alpha1 for each mode, following appendix C.2 of arXiv:2001.09082v2.</span>
<span class="sd">    It is called in function EOBPM_SetupFitCoefficients of waveform.pyx.</span>
<span class="sd">    ---------------------------------------------------------------------------------------</span>
<span class="sd">    The fitting coefficients and equations are implemented from:</span>
<span class="sd">    (2,2) (2,1) (3,3) (3,2) (3,1) (4,4) (4,3) (4,2) (4,1) - arXiv:1904.09550v2, section V.D</span>
<span class="sd">    ---------------------------------------------------------------------------------------</span>
<span class="sd">    Note that, as outlined in appendix C.1 of arXiv:2001.09082v2, we use the non-spinning values (i.e.</span>
<span class="sd">    taken from arXiv:1904.09550v2) for the post-peak coefficients also for the spinning case.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">res</span> <span class="o">=</span> <span class="mf">0.0</span>
    <span class="n">af2</span> <span class="o">=</span> <span class="n">af</span> <span class="o">*</span> <span class="n">af</span>
    <span class="n">af3</span> <span class="o">=</span> <span class="n">af2</span> <span class="o">*</span> <span class="n">af</span>

    <span class="c1"># -------------------------------------------------------------------------------- #</span>
    <span class="c1"># (2,2) - TEOBResumSFits.c, line 2803</span>
    <span class="n">alp1_22_0</span> <span class="o">=</span> <span class="mf">0.08896</span>
    <span class="n">b_1_22</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.90036</span>
    <span class="n">b_2_22</span> <span class="o">=</span> <span class="mf">0.86200</span>
    <span class="n">b_3_22</span> <span class="o">=</span> <span class="mf">0.0384893</span>
    <span class="n">c_1_22</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.87933</span>
    <span class="n">c_2_22</span> <span class="o">=</span> <span class="mf">0.88062</span>
    <span class="n">c_3_22</span> <span class="o">=</span> <span class="mf">0.0</span>

    <span class="c1"># (2,1) - TEOBResumSFits.c, line 2798</span>
    <span class="n">alp1_21_0</span> <span class="o">=</span> <span class="mf">0.0889623</span>
    <span class="n">b_1_21</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.31253</span>
    <span class="n">b_2_21</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.21033</span>
    <span class="n">b_3_21</span> <span class="o">=</span> <span class="mf">0.52502</span>
    <span class="n">c_1_21</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.30041</span>
    <span class="n">c_2_21</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.15660</span>
    <span class="n">c_3_21</span> <span class="o">=</span> <span class="mf">0.46204</span>

    <span class="c1"># (3,3) - TEOBResumSFits.c, line 2832</span>
    <span class="n">alp1_33_0</span> <span class="o">=</span> <span class="mf">0.0927030</span>
    <span class="n">b_1_33</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.8310</span>
    <span class="n">b_2_33</span> <span class="o">=</span> <span class="mf">0.7568</span>
    <span class="n">b_3_33</span> <span class="o">=</span> <span class="mf">0.0745</span>
    <span class="n">c_1_33</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.8098</span>
    <span class="n">c_2_33</span> <span class="o">=</span> <span class="mf">0.7926</span>
    <span class="n">c_3_33</span> <span class="o">=</span> <span class="mf">0.0196</span>

    <span class="c1"># (3,2) - TEOBResumSFits.c, line 2827</span>
    <span class="n">alp1_32_0</span> <span class="o">=</span> <span class="mf">0.0927030</span>
    <span class="n">b_1_32</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.58277</span>
    <span class="n">b_2_32</span> <span class="o">=</span> <span class="mf">0.2783</span>
    <span class="n">b_3_32</span> <span class="o">=</span> <span class="mf">0.30503</span>
    <span class="n">c_1_32</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.56797</span>
    <span class="n">c_2_32</span> <span class="o">=</span> <span class="mf">0.3290</span>
    <span class="n">c_3_32</span> <span class="o">=</span> <span class="mf">0.24155</span>

    <span class="c1"># (3,1) - TEOBResumSFits.c, line 2822</span>
    <span class="n">alp1_31_0</span> <span class="o">=</span> <span class="mf">0.0927030</span>
    <span class="n">b_1_31</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.2345</span>
    <span class="n">b_2_31</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.30447</span>
    <span class="n">b_3_31</span> <span class="o">=</span> <span class="mf">0.5446</span>
    <span class="n">c_1_31</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.2263</span>
    <span class="n">c_2_31</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.24223</span>
    <span class="n">c_3_31</span> <span class="o">=</span> <span class="mf">0.47738</span>

    <span class="c1"># (4,4) - TEOBResumSFits.c, line 2852</span>
    <span class="n">alp1_44_0</span> <span class="o">=</span> <span class="mf">0.0941640</span>
    <span class="n">b_1_44</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.8662</span>
    <span class="n">b_2_44</span> <span class="o">=</span> <span class="mf">0.8248</span>
    <span class="n">b_3_44</span> <span class="o">=</span> <span class="mf">0.0417</span>
    <span class="n">c_1_44</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.8514</span>
    <span class="n">c_2_44</span> <span class="o">=</span> <span class="mf">0.8736</span>
    <span class="n">c_3_44</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.0198</span>

    <span class="c1"># (4,3) - TEOBResumSFits.c, line 2847</span>
    <span class="n">alp1_43_0</span> <span class="o">=</span> <span class="mf">0.0941640</span>
    <span class="n">b_1_43</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.7177</span>
    <span class="n">b_2_43</span> <span class="o">=</span> <span class="mf">0.5320</span>
    <span class="n">b_3_43</span> <span class="o">=</span> <span class="mf">0.1860</span>
    <span class="n">c_1_43</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.7065</span>
    <span class="n">c_2_43</span> <span class="o">=</span> <span class="mf">0.5876</span>
    <span class="n">c_3_43</span> <span class="o">=</span> <span class="mf">0.120939</span>

    <span class="c1"># (4,2) - TEOBResumSFits.c, line 2842</span>
    <span class="n">alp1_42_0</span> <span class="o">=</span> <span class="mf">0.0941640</span>
    <span class="n">b_1_42</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.44152</span>
    <span class="n">b_2_42</span> <span class="o">=</span> <span class="mf">0.0542</span>
    <span class="n">b_3_42</span> <span class="o">=</span> <span class="mf">0.39020</span>
    <span class="n">c_1_42</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.43312</span>
    <span class="n">c_2_42</span> <span class="o">=</span> <span class="mf">0.1167</span>
    <span class="n">c_3_42</span> <span class="o">=</span> <span class="mf">0.32253</span>

    <span class="c1"># (4,1) - TEOBResumSFits.c, line 2837</span>
    <span class="n">alp1_41_0</span> <span class="o">=</span> <span class="mf">0.0941640</span>
    <span class="n">b_1_41</span> <span class="o">=</span> <span class="mf">1.1018882</span>
    <span class="n">b_2_41</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.88643</span>
    <span class="n">b_3_41</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.78266</span>
    <span class="n">c_1_41</span> <span class="o">=</span> <span class="mf">1.1065495</span>
    <span class="n">c_2_41</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.80961</span>
    <span class="n">c_3_41</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.68905</span>

    <span class="c1"># (5,5) - TEOBResumSFits.c, line 2857</span>
    <span class="n">alp1_55_0</span> <span class="o">=</span> <span class="mf">0.0948705</span>
    <span class="n">b_1_55</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.8845</span>
    <span class="n">b_2_55</span> <span class="o">=</span> <span class="mf">0.8585</span>
    <span class="n">b_3_55</span> <span class="o">=</span> <span class="mf">0.0263</span>
    <span class="n">c_1_55</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.8740</span>
    <span class="n">c_2_55</span> <span class="o">=</span> <span class="mf">0.9147</span>
    <span class="n">c_3_55</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.0384</span>
    <span class="c1"># -------------------------------------------------------------------------------- #</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">l</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">m</span> <span class="o">==</span> <span class="mi">2</span><span class="p">):</span>
        <span class="n">alpha1_22</span> <span class="o">=</span> <span class="n">_Y</span><span class="p">(</span>
            <span class="n">alp1_22_0</span><span class="p">,</span> <span class="n">b_1_22</span><span class="p">,</span> <span class="n">b_2_22</span><span class="p">,</span> <span class="n">b_3_22</span><span class="p">,</span> <span class="n">c_1_22</span><span class="p">,</span> <span class="n">c_2_22</span><span class="p">,</span> <span class="n">c_3_22</span><span class="p">,</span> <span class="n">af</span><span class="p">,</span> <span class="n">af2</span><span class="p">,</span> <span class="n">af3</span>
        <span class="p">)</span>
        <span class="n">res</span> <span class="o">=</span> <span class="n">alpha1_22</span>

    <span class="k">elif</span> <span class="p">(</span><span class="n">l</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">m</span> <span class="o">==</span> <span class="mi">1</span><span class="p">):</span>
        <span class="n">alpha1_21</span> <span class="o">=</span> <span class="n">_Y</span><span class="p">(</span>
            <span class="n">alp1_21_0</span><span class="p">,</span> <span class="n">b_1_21</span><span class="p">,</span> <span class="n">b_2_21</span><span class="p">,</span> <span class="n">b_3_21</span><span class="p">,</span> <span class="n">c_1_21</span><span class="p">,</span> <span class="n">c_2_21</span><span class="p">,</span> <span class="n">c_3_21</span><span class="p">,</span> <span class="n">af</span><span class="p">,</span> <span class="n">af2</span><span class="p">,</span> <span class="n">af3</span>
        <span class="p">)</span>
        <span class="n">res</span> <span class="o">=</span> <span class="n">alpha1_21</span>

    <span class="k">elif</span> <span class="p">(</span><span class="n">l</span> <span class="o">==</span> <span class="mi">3</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">m</span> <span class="o">==</span> <span class="mi">3</span><span class="p">):</span>
        <span class="n">alpha1_33</span> <span class="o">=</span> <span class="n">_Y</span><span class="p">(</span>
            <span class="n">alp1_33_0</span><span class="p">,</span> <span class="n">b_1_33</span><span class="p">,</span> <span class="n">b_2_33</span><span class="p">,</span> <span class="n">b_3_33</span><span class="p">,</span> <span class="n">c_1_33</span><span class="p">,</span> <span class="n">c_2_33</span><span class="p">,</span> <span class="n">c_3_33</span><span class="p">,</span> <span class="n">af</span><span class="p">,</span> <span class="n">af2</span><span class="p">,</span> <span class="n">af3</span>
        <span class="p">)</span>
        <span class="n">res</span> <span class="o">=</span> <span class="n">alpha1_33</span>

    <span class="k">elif</span> <span class="p">(</span><span class="n">l</span> <span class="o">==</span> <span class="mi">3</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">m</span> <span class="o">==</span> <span class="mi">2</span><span class="p">):</span>
        <span class="n">alpha1_32</span> <span class="o">=</span> <span class="n">_Y</span><span class="p">(</span>
            <span class="n">alp1_32_0</span><span class="p">,</span> <span class="n">b_1_32</span><span class="p">,</span> <span class="n">b_2_32</span><span class="p">,</span> <span class="n">b_3_32</span><span class="p">,</span> <span class="n">c_1_32</span><span class="p">,</span> <span class="n">c_2_32</span><span class="p">,</span> <span class="n">c_3_32</span><span class="p">,</span> <span class="n">af</span><span class="p">,</span> <span class="n">af2</span><span class="p">,</span> <span class="n">af3</span>
        <span class="p">)</span>
        <span class="n">res</span> <span class="o">=</span> <span class="n">alpha1_32</span>

    <span class="k">elif</span> <span class="p">(</span><span class="n">l</span> <span class="o">==</span> <span class="mi">3</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">m</span> <span class="o">==</span> <span class="mi">1</span><span class="p">):</span>
        <span class="n">alpha1_31</span> <span class="o">=</span> <span class="n">_Y</span><span class="p">(</span>
            <span class="n">alp1_31_0</span><span class="p">,</span> <span class="n">b_1_31</span><span class="p">,</span> <span class="n">b_2_31</span><span class="p">,</span> <span class="n">b_3_31</span><span class="p">,</span> <span class="n">c_1_31</span><span class="p">,</span> <span class="n">c_2_31</span><span class="p">,</span> <span class="n">c_3_31</span><span class="p">,</span> <span class="n">af</span><span class="p">,</span> <span class="n">af2</span><span class="p">,</span> <span class="n">af3</span>
        <span class="p">)</span>
        <span class="n">res</span> <span class="o">=</span> <span class="n">alpha1_31</span>

    <span class="k">elif</span> <span class="p">(</span><span class="n">l</span> <span class="o">==</span> <span class="mi">4</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">m</span> <span class="o">==</span> <span class="mi">4</span><span class="p">):</span>
        <span class="n">alpha1_44</span> <span class="o">=</span> <span class="n">_Y</span><span class="p">(</span>
            <span class="n">alp1_44_0</span><span class="p">,</span> <span class="n">b_1_44</span><span class="p">,</span> <span class="n">b_2_44</span><span class="p">,</span> <span class="n">b_3_44</span><span class="p">,</span> <span class="n">c_1_44</span><span class="p">,</span> <span class="n">c_2_44</span><span class="p">,</span> <span class="n">c_3_44</span><span class="p">,</span> <span class="n">af</span><span class="p">,</span> <span class="n">af2</span><span class="p">,</span> <span class="n">af3</span>
        <span class="p">)</span>
        <span class="n">res</span> <span class="o">=</span> <span class="n">alpha1_44</span>

    <span class="k">elif</span> <span class="p">(</span><span class="n">l</span> <span class="o">==</span> <span class="mi">4</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">m</span> <span class="o">==</span> <span class="mi">3</span><span class="p">):</span>
        <span class="n">alpha1_43</span> <span class="o">=</span> <span class="n">_Y</span><span class="p">(</span>
            <span class="n">alp1_43_0</span><span class="p">,</span> <span class="n">b_1_43</span><span class="p">,</span> <span class="n">b_2_43</span><span class="p">,</span> <span class="n">b_3_43</span><span class="p">,</span> <span class="n">c_1_43</span><span class="p">,</span> <span class="n">c_2_43</span><span class="p">,</span> <span class="n">c_3_43</span><span class="p">,</span> <span class="n">af</span><span class="p">,</span> <span class="n">af2</span><span class="p">,</span> <span class="n">af3</span>
        <span class="p">)</span>
        <span class="n">res</span> <span class="o">=</span> <span class="n">alpha1_43</span>

    <span class="k">elif</span> <span class="p">(</span><span class="n">l</span> <span class="o">==</span> <span class="mi">4</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">m</span> <span class="o">==</span> <span class="mi">2</span><span class="p">):</span>
        <span class="n">alpha1_42</span> <span class="o">=</span> <span class="n">_Y</span><span class="p">(</span>
            <span class="n">alp1_42_0</span><span class="p">,</span> <span class="n">b_1_42</span><span class="p">,</span> <span class="n">b_2_42</span><span class="p">,</span> <span class="n">b_3_42</span><span class="p">,</span> <span class="n">c_1_42</span><span class="p">,</span> <span class="n">c_2_42</span><span class="p">,</span> <span class="n">c_3_42</span><span class="p">,</span> <span class="n">af</span><span class="p">,</span> <span class="n">af2</span><span class="p">,</span> <span class="n">af3</span>
        <span class="p">)</span>
        <span class="n">res</span> <span class="o">=</span> <span class="n">alpha1_42</span>

    <span class="k">elif</span> <span class="p">(</span><span class="n">l</span> <span class="o">==</span> <span class="mi">4</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">m</span> <span class="o">==</span> <span class="mi">1</span><span class="p">):</span>
        <span class="n">alpha1_41</span> <span class="o">=</span> <span class="n">_Y</span><span class="p">(</span>
            <span class="n">alp1_41_0</span><span class="p">,</span> <span class="n">b_1_41</span><span class="p">,</span> <span class="n">b_2_41</span><span class="p">,</span> <span class="n">b_3_41</span><span class="p">,</span> <span class="n">c_1_41</span><span class="p">,</span> <span class="n">c_2_41</span><span class="p">,</span> <span class="n">c_3_41</span><span class="p">,</span> <span class="n">af</span><span class="p">,</span> <span class="n">af2</span><span class="p">,</span> <span class="n">af3</span>
        <span class="p">)</span>
        <span class="n">res</span> <span class="o">=</span> <span class="n">alpha1_41</span>

    <span class="k">elif</span> <span class="p">(</span><span class="n">l</span> <span class="o">==</span> <span class="mi">5</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">m</span> <span class="o">==</span> <span class="mi">5</span><span class="p">):</span>
        <span class="n">alpha1_55</span> <span class="o">=</span> <span class="n">_Y</span><span class="p">(</span>
            <span class="n">alp1_55_0</span><span class="p">,</span> <span class="n">b_1_55</span><span class="p">,</span> <span class="n">b_2_55</span><span class="p">,</span> <span class="n">b_3_55</span><span class="p">,</span> <span class="n">c_1_55</span><span class="p">,</span> <span class="n">c_2_55</span><span class="p">,</span> <span class="n">c_3_55</span><span class="p">,</span> <span class="n">af</span><span class="p">,</span> <span class="n">af2</span><span class="p">,</span> <span class="n">af3</span>
        <span class="p">)</span>
        <span class="n">res</span> <span class="o">=</span> <span class="n">alpha1_55</span>

    <span class="k">return</span> <span class="n">res</span></div>



<div class="viewcode-block" id="_alpha21">
<a class="viewcode-back" href="../../../autoapi/PyART/models/ringdown_fits/index.html#PyART.models.ringdown_fits._alpha21">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">_alpha21</span><span class="p">(</span><span class="n">af</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">m</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Function returning the value of alpha21 for each mode, following appendix C.2 of arXiv:2001.09082v2.</span>
<span class="sd">    It is called in function EOBPM_SetupFitCoefficients of waveform.pyx.</span>
<span class="sd">    ---------------------------------------------------------------------------------------</span>
<span class="sd">    The fitting coefficients and equations are implemented from:</span>
<span class="sd">    (2,2) (2,1) (3,3) (3,2) (3,1) (4,4) (4,3) (4,2) (4,1) - arXiv:1904.09550v2, section V.D</span>
<span class="sd">    ---------------------------------------------------------------------------------------</span>
<span class="sd">    Note that, as outlined in appendix C.1 of arXiv:2001.09082v2, we use the non-spinning values (i.e.</span>
<span class="sd">    taken from arXiv:1904.09550v2) for the post-peak coefficients also for the spinning case.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">res</span> <span class="o">=</span> <span class="mf">0.0</span>
    <span class="n">af2</span> <span class="o">=</span> <span class="n">af</span> <span class="o">*</span> <span class="n">af</span>
    <span class="n">af3</span> <span class="o">=</span> <span class="n">af2</span> <span class="o">*</span> <span class="n">af</span>

    <span class="c1"># -------------------------------------------------------------------------------- #</span>
    <span class="c1"># (2,2) - TEOBResumSFits.c, line 2804</span>
    <span class="n">alp21_22_0</span> <span class="o">=</span> <span class="mf">0.184953</span>
    <span class="n">b_1_22</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.89397</span>
    <span class="n">b_2_22</span> <span class="o">=</span> <span class="mf">0.88126</span>
    <span class="n">b_3_22</span> <span class="o">=</span> <span class="mf">0.0130256</span>
    <span class="n">c_1_22</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.83901</span>
    <span class="n">c_2_22</span> <span class="o">=</span> <span class="mf">0.84162</span>
    <span class="n">c_3_22</span> <span class="o">=</span> <span class="mf">0.0</span>

    <span class="c1"># (2,1) - TEOBResumSFits.c, line 2799</span>
    <span class="n">alp21_21_0</span> <span class="o">=</span> <span class="mf">0.184952</span>
    <span class="n">b_1_21</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.13290</span>
    <span class="n">b_2_21</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.3520</span>
    <span class="n">b_3_21</span> <span class="o">=</span> <span class="mf">0.4924</span>
    <span class="n">c_1_21</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.10334</span>
    <span class="n">c_2_21</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.3037</span>
    <span class="n">c_3_21</span> <span class="o">=</span> <span class="mf">0.4262</span>

    <span class="c1"># (3,3) - TEOBResumSFits.c, line 2833</span>
    <span class="n">alp21_33_0</span> <span class="o">=</span> <span class="mf">0.188595</span>
    <span class="n">b_1_33</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.8011</span>
    <span class="n">b_2_33</span> <span class="o">=</span> <span class="mf">0.7046</span>
    <span class="n">b_3_33</span> <span class="o">=</span> <span class="mf">0.0968</span>
    <span class="n">c_1_33</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.7653</span>
    <span class="n">c_2_33</span> <span class="o">=</span> <span class="mf">0.7176</span>
    <span class="n">c_3_33</span> <span class="o">=</span> <span class="mf">0.0504</span>

    <span class="c1"># (3,2) - TEOBResumSFits.c, line 2828</span>
    <span class="n">alp21_32_0</span> <span class="o">=</span> <span class="mf">0.188595</span>
    <span class="n">b_1_32</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.5212</span>
    <span class="n">b_2_32</span> <span class="o">=</span> <span class="mf">0.1563</span>
    <span class="n">b_3_32</span> <span class="o">=</span> <span class="mf">0.3652</span>
    <span class="n">c_1_32</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.4968</span>
    <span class="n">c_2_32</span> <span class="o">=</span> <span class="mf">0.1968</span>
    <span class="n">c_3_32</span> <span class="o">=</span> <span class="mf">0.3021</span>

    <span class="c1"># (3,1) - TEOBResumSFits.c, line 2823</span>
    <span class="n">alp21_31_0</span> <span class="o">=</span> <span class="mf">0.188595</span>
    <span class="n">b_1_31</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.035</span>
    <span class="n">b_2_31</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.3816</span>
    <span class="n">b_3_31</span> <span class="o">=</span> <span class="mf">0.4486</span>
    <span class="n">c_1_31</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.023</span>
    <span class="n">c_2_31</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.3170</span>
    <span class="n">c_3_31</span> <span class="o">=</span> <span class="mf">0.3898</span>

    <span class="c1"># (4,4) - TEOBResumSFits.c, line 2853</span>
    <span class="n">alp21_44_0</span> <span class="o">=</span> <span class="mf">0.190170</span>
    <span class="n">b_1_44</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.8546</span>
    <span class="n">b_2_44</span> <span class="o">=</span> <span class="mf">0.8041</span>
    <span class="n">b_3_44</span> <span class="o">=</span> <span class="mf">0.0507</span>
    <span class="n">c_1_44</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.8315</span>
    <span class="n">c_2_44</span> <span class="o">=</span> <span class="mf">0.8391</span>
    <span class="n">c_3_44</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.0051</span>

    <span class="c1"># (4,3) - TEOBResumSFits.c, line 2848</span>
    <span class="n">alp21_43_0</span> <span class="o">=</span> <span class="mf">0.190170</span>
    <span class="n">b_1_43</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.6860</span>
    <span class="n">b_2_43</span> <span class="o">=</span> <span class="mf">0.4724</span>
    <span class="n">b_3_43</span> <span class="o">=</span> <span class="mf">0.2139</span>
    <span class="n">c_1_43</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.6684</span>
    <span class="n">c_2_43</span> <span class="o">=</span> <span class="mf">0.5198</span>
    <span class="n">c_3_43</span> <span class="o">=</span> <span class="mf">0.1508</span>

    <span class="c1"># (4,2) - TEOBResumSFits.c, line 2843</span>
    <span class="n">alp21_42_0</span> <span class="o">=</span> <span class="mf">0.190170</span>
    <span class="n">b_1_42</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.38840</span>
    <span class="n">b_2_42</span> <span class="o">=</span> <span class="mf">0.0</span>
    <span class="n">b_3_42</span> <span class="o">=</span> <span class="mf">0.39333</span>
    <span class="n">c_1_42</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.37584</span>
    <span class="n">c_2_42</span> <span class="o">=</span> <span class="mf">0.0600017</span>
    <span class="n">c_3_42</span> <span class="o">=</span> <span class="mf">0.32632</span>

    <span class="c1"># (4,1) - TEOBResumSFits.c, line 2838</span>
    <span class="n">alp21_41_0</span> <span class="o">=</span> <span class="mf">0.190170</span>
    <span class="n">b_1_41</span> <span class="o">=</span> <span class="mf">1.0590157</span>
    <span class="n">b_2_41</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.8650630</span>
    <span class="n">b_3_41</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.75222</span>
    <span class="n">c_1_41</span> <span class="o">=</span> <span class="mf">1.0654880</span>
    <span class="n">c_2_41</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.7830051</span>
    <span class="n">c_3_41</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.65814</span>

    <span class="c1"># (5,5) - TEOBResumSFits.c, line 2858</span>
    <span class="n">alp21_55_0</span> <span class="o">=</span> <span class="mf">0.190947</span>
    <span class="n">b_1_55</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.8780</span>
    <span class="n">b_2_55</span> <span class="o">=</span> <span class="mf">0.8467</span>
    <span class="n">b_3_55</span> <span class="o">=</span> <span class="mf">0.0315</span>
    <span class="n">c_1_55</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.8619</span>
    <span class="n">c_2_55</span> <span class="o">=</span> <span class="mf">0.8936</span>
    <span class="n">c_3_55</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.0293</span>
    <span class="c1"># -------------------------------------------------------------------------------- #</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">l</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">m</span> <span class="o">==</span> <span class="mi">2</span><span class="p">):</span>
        <span class="n">alpha21_22</span> <span class="o">=</span> <span class="n">_Y</span><span class="p">(</span>
            <span class="n">alp21_22_0</span><span class="p">,</span> <span class="n">b_1_22</span><span class="p">,</span> <span class="n">b_2_22</span><span class="p">,</span> <span class="n">b_3_22</span><span class="p">,</span> <span class="n">c_1_22</span><span class="p">,</span> <span class="n">c_2_22</span><span class="p">,</span> <span class="n">c_3_22</span><span class="p">,</span> <span class="n">af</span><span class="p">,</span> <span class="n">af2</span><span class="p">,</span> <span class="n">af3</span>
        <span class="p">)</span>
        <span class="n">res</span> <span class="o">=</span> <span class="n">alpha21_22</span>

    <span class="k">elif</span> <span class="p">(</span><span class="n">l</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">m</span> <span class="o">==</span> <span class="mi">1</span><span class="p">):</span>
        <span class="n">alpha21_21</span> <span class="o">=</span> <span class="n">_Y</span><span class="p">(</span>
            <span class="n">alp21_21_0</span><span class="p">,</span> <span class="n">b_1_21</span><span class="p">,</span> <span class="n">b_2_21</span><span class="p">,</span> <span class="n">b_3_21</span><span class="p">,</span> <span class="n">c_1_21</span><span class="p">,</span> <span class="n">c_2_21</span><span class="p">,</span> <span class="n">c_3_21</span><span class="p">,</span> <span class="n">af</span><span class="p">,</span> <span class="n">af2</span><span class="p">,</span> <span class="n">af3</span>
        <span class="p">)</span>
        <span class="n">res</span> <span class="o">=</span> <span class="n">alpha21_21</span>

    <span class="k">elif</span> <span class="p">(</span><span class="n">l</span> <span class="o">==</span> <span class="mi">3</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">m</span> <span class="o">==</span> <span class="mi">3</span><span class="p">):</span>
        <span class="n">alpha21_33</span> <span class="o">=</span> <span class="n">_Y</span><span class="p">(</span>
            <span class="n">alp21_33_0</span><span class="p">,</span> <span class="n">b_1_33</span><span class="p">,</span> <span class="n">b_2_33</span><span class="p">,</span> <span class="n">b_3_33</span><span class="p">,</span> <span class="n">c_1_33</span><span class="p">,</span> <span class="n">c_2_33</span><span class="p">,</span> <span class="n">c_3_33</span><span class="p">,</span> <span class="n">af</span><span class="p">,</span> <span class="n">af2</span><span class="p">,</span> <span class="n">af3</span>
        <span class="p">)</span>
        <span class="n">res</span> <span class="o">=</span> <span class="n">alpha21_33</span>

    <span class="k">elif</span> <span class="p">(</span><span class="n">l</span> <span class="o">==</span> <span class="mi">3</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">m</span> <span class="o">==</span> <span class="mi">2</span><span class="p">):</span>
        <span class="n">alpha21_32</span> <span class="o">=</span> <span class="n">_Y</span><span class="p">(</span>
            <span class="n">alp21_32_0</span><span class="p">,</span> <span class="n">b_1_32</span><span class="p">,</span> <span class="n">b_2_32</span><span class="p">,</span> <span class="n">b_3_32</span><span class="p">,</span> <span class="n">c_1_32</span><span class="p">,</span> <span class="n">c_2_32</span><span class="p">,</span> <span class="n">c_3_32</span><span class="p">,</span> <span class="n">af</span><span class="p">,</span> <span class="n">af2</span><span class="p">,</span> <span class="n">af3</span>
        <span class="p">)</span>
        <span class="n">res</span> <span class="o">=</span> <span class="n">alpha21_32</span>

    <span class="k">elif</span> <span class="p">(</span><span class="n">l</span> <span class="o">==</span> <span class="mi">3</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">m</span> <span class="o">==</span> <span class="mi">1</span><span class="p">):</span>
        <span class="n">alpha21_31</span> <span class="o">=</span> <span class="n">_Y</span><span class="p">(</span>
            <span class="n">alp21_31_0</span><span class="p">,</span> <span class="n">b_1_31</span><span class="p">,</span> <span class="n">b_2_31</span><span class="p">,</span> <span class="n">b_3_31</span><span class="p">,</span> <span class="n">c_1_31</span><span class="p">,</span> <span class="n">c_2_31</span><span class="p">,</span> <span class="n">c_3_31</span><span class="p">,</span> <span class="n">af</span><span class="p">,</span> <span class="n">af2</span><span class="p">,</span> <span class="n">af3</span>
        <span class="p">)</span>
        <span class="n">res</span> <span class="o">=</span> <span class="n">alpha21_31</span>

    <span class="k">elif</span> <span class="p">(</span><span class="n">l</span> <span class="o">==</span> <span class="mi">4</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">m</span> <span class="o">==</span> <span class="mi">4</span><span class="p">):</span>
        <span class="n">alpha21_44</span> <span class="o">=</span> <span class="n">_Y</span><span class="p">(</span>
            <span class="n">alp21_44_0</span><span class="p">,</span> <span class="n">b_1_44</span><span class="p">,</span> <span class="n">b_2_44</span><span class="p">,</span> <span class="n">b_3_44</span><span class="p">,</span> <span class="n">c_1_44</span><span class="p">,</span> <span class="n">c_2_44</span><span class="p">,</span> <span class="n">c_3_44</span><span class="p">,</span> <span class="n">af</span><span class="p">,</span> <span class="n">af2</span><span class="p">,</span> <span class="n">af3</span>
        <span class="p">)</span>
        <span class="n">res</span> <span class="o">=</span> <span class="n">alpha21_44</span>

    <span class="k">elif</span> <span class="p">(</span><span class="n">l</span> <span class="o">==</span> <span class="mi">4</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">m</span> <span class="o">==</span> <span class="mi">3</span><span class="p">):</span>
        <span class="n">alpha21_43</span> <span class="o">=</span> <span class="n">_Y</span><span class="p">(</span>
            <span class="n">alp21_43_0</span><span class="p">,</span> <span class="n">b_1_43</span><span class="p">,</span> <span class="n">b_2_43</span><span class="p">,</span> <span class="n">b_3_43</span><span class="p">,</span> <span class="n">c_1_43</span><span class="p">,</span> <span class="n">c_2_43</span><span class="p">,</span> <span class="n">c_3_43</span><span class="p">,</span> <span class="n">af</span><span class="p">,</span> <span class="n">af2</span><span class="p">,</span> <span class="n">af3</span>
        <span class="p">)</span>
        <span class="n">res</span> <span class="o">=</span> <span class="n">alpha21_43</span>

    <span class="k">elif</span> <span class="p">(</span><span class="n">l</span> <span class="o">==</span> <span class="mi">4</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">m</span> <span class="o">==</span> <span class="mi">2</span><span class="p">):</span>
        <span class="n">alpha21_42</span> <span class="o">=</span> <span class="n">_Y</span><span class="p">(</span>
            <span class="n">alp21_42_0</span><span class="p">,</span> <span class="n">b_1_42</span><span class="p">,</span> <span class="n">b_2_42</span><span class="p">,</span> <span class="n">b_3_42</span><span class="p">,</span> <span class="n">c_1_42</span><span class="p">,</span> <span class="n">c_2_42</span><span class="p">,</span> <span class="n">c_3_42</span><span class="p">,</span> <span class="n">af</span><span class="p">,</span> <span class="n">af2</span><span class="p">,</span> <span class="n">af3</span>
        <span class="p">)</span>
        <span class="n">res</span> <span class="o">=</span> <span class="n">alpha21_42</span>

    <span class="k">elif</span> <span class="p">(</span><span class="n">l</span> <span class="o">==</span> <span class="mi">4</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">m</span> <span class="o">==</span> <span class="mi">1</span><span class="p">):</span>
        <span class="n">alpha21_41</span> <span class="o">=</span> <span class="n">_Y</span><span class="p">(</span>
            <span class="n">alp21_41_0</span><span class="p">,</span> <span class="n">b_1_41</span><span class="p">,</span> <span class="n">b_2_41</span><span class="p">,</span> <span class="n">b_3_41</span><span class="p">,</span> <span class="n">c_1_41</span><span class="p">,</span> <span class="n">c_2_41</span><span class="p">,</span> <span class="n">c_3_41</span><span class="p">,</span> <span class="n">af</span><span class="p">,</span> <span class="n">af2</span><span class="p">,</span> <span class="n">af3</span>
        <span class="p">)</span>
        <span class="n">res</span> <span class="o">=</span> <span class="n">alpha21_41</span>

    <span class="k">elif</span> <span class="p">(</span><span class="n">l</span> <span class="o">==</span> <span class="mi">5</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">m</span> <span class="o">==</span> <span class="mi">5</span><span class="p">):</span>
        <span class="n">alpha21_55</span> <span class="o">=</span> <span class="n">_Y</span><span class="p">(</span>
            <span class="n">alp21_55_0</span><span class="p">,</span> <span class="n">b_1_55</span><span class="p">,</span> <span class="n">b_2_55</span><span class="p">,</span> <span class="n">b_3_55</span><span class="p">,</span> <span class="n">c_1_55</span><span class="p">,</span> <span class="n">c_2_55</span><span class="p">,</span> <span class="n">c_3_55</span><span class="p">,</span> <span class="n">af</span><span class="p">,</span> <span class="n">af2</span><span class="p">,</span> <span class="n">af3</span>
        <span class="p">)</span>
        <span class="n">res</span> <span class="o">=</span> <span class="n">alpha21_55</span>

    <span class="k">return</span> <span class="n">res</span></div>



<div class="viewcode-block" id="_omega1">
<a class="viewcode-back" href="../../../autoapi/PyART/models/ringdown_fits/index.html#PyART.models.ringdown_fits._omega1">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">_omega1</span><span class="p">(</span><span class="n">af</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">m</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Function returning the value of omega1 for each mode, following appendix C.2 of arXiv:2001.09082v2.</span>
<span class="sd">    It is called in function EOBPM_SetupFitCoefficients of waveform.pyx.</span>
<span class="sd">    ---------------------------------------------------------------------------------------</span>
<span class="sd">    The fitting coefficients and equations are implemented from:</span>
<span class="sd">    (2,2) (2,1) (3,3) (3,2) (3,1) (4,4) (4,3) (4,2) (4,1) - arXiv:1904.09550v2, section V.D</span>
<span class="sd">    ---------------------------------------------------------------------------------------</span>
<span class="sd">    Note that, as outlined in appendix C.1 of arXiv:2001.09082v2, we use the non-spinning values (i.e.</span>
<span class="sd">    taken from arXiv:1904.09550v2) for the post-peak coefficients also for the spinning case.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">res</span> <span class="o">=</span> <span class="mf">0.0</span>
    <span class="n">af2</span> <span class="o">=</span> <span class="n">af</span> <span class="o">*</span> <span class="n">af</span>
    <span class="n">af3</span> <span class="o">=</span> <span class="n">af2</span> <span class="o">*</span> <span class="n">af</span>

    <span class="c1"># -------------------------------------------------------------------------------- #</span>
    <span class="c1"># (2,2) - TEOBResumSFits.c, line 2802</span>
    <span class="n">omg1_22_0</span> <span class="o">=</span> <span class="mf">0.373672</span>
    <span class="n">b_1_22</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.5367</span>
    <span class="n">b_2_22</span> <span class="o">=</span> <span class="mf">0.5503</span>
    <span class="n">b_3_22</span> <span class="o">=</span> <span class="mf">0.0</span>
    <span class="n">c_1_22</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.8700</span>
    <span class="n">c_2_22</span> <span class="o">=</span> <span class="mf">0.9848</span>
    <span class="n">c_3_22</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.10943</span>

    <span class="c1"># (2,1) - TEOBResumSFits.c, line 2797</span>
    <span class="n">omg1_21_0</span> <span class="o">=</span> <span class="mf">0.373672</span>
    <span class="n">b_1_21</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.79546</span>
    <span class="n">b_2_21</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.1908</span>
    <span class="n">b_3_21</span> <span class="o">=</span> <span class="mf">0.11460</span>
    <span class="n">c_1_21</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.96337</span>
    <span class="n">c_2_21</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.1495</span>
    <span class="n">c_3_21</span> <span class="o">=</span> <span class="mf">0.19522</span>

    <span class="c1"># (3,3) - TEOBResumSFits.c, line 2831</span>
    <span class="n">omg1_33_0</span> <span class="o">=</span> <span class="mf">0.599443</span>
    <span class="n">b_1_33</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.84922</span>
    <span class="n">b_2_33</span> <span class="o">=</span> <span class="mf">0.9294</span>
    <span class="n">b_3_33</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.07613</span>
    <span class="n">c_1_33</span> <span class="o">=</span> <span class="o">-</span><span class="mf">2.18719</span>
    <span class="n">c_2_33</span> <span class="o">=</span> <span class="mf">1.4903</span>
    <span class="n">c_3_33</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.3014</span>

    <span class="c1"># (3,2) - TEOBResumSFits.c, line 2826</span>
    <span class="n">omg1_32_0</span> <span class="o">=</span> <span class="mf">0.599443</span>
    <span class="n">b_1_32</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.251</span>
    <span class="n">b_2_32</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.891</span>
    <span class="n">b_3_32</span> <span class="o">=</span> <span class="mf">0.2706</span>
    <span class="n">c_1_32</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.475</span>
    <span class="n">c_2_32</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.911</span>
    <span class="n">c_3_32</span> <span class="o">=</span> <span class="mf">0.4609</span>

    <span class="c1"># (3,1) - TEOBResumSFits.c, line 2821</span>
    <span class="n">omg1_31_0</span> <span class="o">=</span> <span class="mf">0.599443</span>
    <span class="n">b_1_31</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.70941</span>
    <span class="n">b_2_31</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.16975</span>
    <span class="n">b_3_31</span> <span class="o">=</span> <span class="mf">0.08559</span>
    <span class="n">c_1_31</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.82174</span>
    <span class="n">c_2_31</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.16792</span>
    <span class="n">c_3_31</span> <span class="o">=</span> <span class="mf">0.14524</span>

    <span class="c1"># (4,4) - TEOBResumSFits.c, line 2851</span>
    <span class="n">omg1_44_0</span> <span class="o">=</span> <span class="mf">0.809178</span>
    <span class="n">b_1_44</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.83156</span>
    <span class="n">b_2_44</span> <span class="o">=</span> <span class="mf">0.9016</span>
    <span class="n">b_3_44</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.06579</span>
    <span class="n">c_1_44</span> <span class="o">=</span> <span class="o">-</span><span class="mf">2.17745</span>
    <span class="n">c_2_44</span> <span class="o">=</span> <span class="mf">1.4753</span>
    <span class="n">c_3_44</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.2961</span>

    <span class="c1"># (4,3) - TEOBResumSFits.c, line 2846</span>
    <span class="n">omg1_43_0</span> <span class="o">=</span> <span class="mf">0.809178</span>
    <span class="n">b_1_43</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.8397</span>
    <span class="n">b_2_43</span> <span class="o">=</span> <span class="mf">0.9616</span>
    <span class="n">b_3_43</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.11339</span>
    <span class="n">c_1_43</span> <span class="o">=</span> <span class="o">-</span><span class="mf">2.0979</span>
    <span class="n">c_2_43</span> <span class="o">=</span> <span class="mf">1.3701</span>
    <span class="n">c_3_43</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.2675</span>

    <span class="c1"># (4,2) - TEOBResumSFits.c, line 2841</span>
    <span class="n">omg1_42_0</span> <span class="o">=</span> <span class="mf">0.809178</span>
    <span class="n">b_1_42</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.6644</span>
    <span class="n">b_2_42</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.3357</span>
    <span class="n">b_3_42</span> <span class="o">=</span> <span class="mf">0.1425</span>
    <span class="n">c_1_42</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.8366</span>
    <span class="n">c_2_42</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.2921</span>
    <span class="n">c_3_42</span> <span class="o">=</span> <span class="mf">0.2254</span>

    <span class="c1"># (4,1) - TEOBResumSFits.c, line 2836</span>
    <span class="n">omg1_41_0</span> <span class="o">=</span> <span class="mf">0.809178</span>
    <span class="n">b_1_41</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.68647</span>
    <span class="n">b_2_41</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.1852590</span>
    <span class="n">b_3_41</span> <span class="o">=</span> <span class="mf">0.0934997</span>
    <span class="n">c_1_41</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.77272</span>
    <span class="n">c_2_41</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.1986852</span>
    <span class="n">c_3_41</span> <span class="o">=</span> <span class="mf">0.1485093</span>

    <span class="c1"># (5,5) - TEOBResumSFits.c, line 2856</span>
    <span class="n">omg1_55_0</span> <span class="o">=</span> <span class="mf">1.012295</span>
    <span class="n">b_1_55</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.5659</span>
    <span class="n">b_2_55</span> <span class="o">=</span> <span class="mf">0.5783</span>
    <span class="n">b_3_55</span> <span class="o">=</span> <span class="mf">0.0</span>
    <span class="n">c_1_55</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.9149</span>
    <span class="n">c_2_55</span> <span class="o">=</span> <span class="mf">1.0668</span>
    <span class="n">c_3_55</span> <span class="o">=</span> <span class="mf">0.14663</span>
    <span class="c1"># -------------------------------------------------------------------------------- #</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">l</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">m</span> <span class="o">==</span> <span class="mi">2</span><span class="p">):</span>
        <span class="n">omega1_22</span> <span class="o">=</span> <span class="n">_Y</span><span class="p">(</span>
            <span class="n">omg1_22_0</span><span class="p">,</span> <span class="n">b_1_22</span><span class="p">,</span> <span class="n">b_2_22</span><span class="p">,</span> <span class="n">b_3_22</span><span class="p">,</span> <span class="n">c_1_22</span><span class="p">,</span> <span class="n">c_2_22</span><span class="p">,</span> <span class="n">c_3_22</span><span class="p">,</span> <span class="n">af</span><span class="p">,</span> <span class="n">af2</span><span class="p">,</span> <span class="n">af3</span>
        <span class="p">)</span>
        <span class="n">res</span> <span class="o">=</span> <span class="n">omega1_22</span>

    <span class="k">elif</span> <span class="p">(</span><span class="n">l</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">m</span> <span class="o">==</span> <span class="mi">1</span><span class="p">):</span>
        <span class="n">omega1_21</span> <span class="o">=</span> <span class="n">_Y</span><span class="p">(</span>
            <span class="n">omg1_21_0</span><span class="p">,</span> <span class="n">b_1_21</span><span class="p">,</span> <span class="n">b_2_21</span><span class="p">,</span> <span class="n">b_3_21</span><span class="p">,</span> <span class="n">c_1_21</span><span class="p">,</span> <span class="n">c_2_21</span><span class="p">,</span> <span class="n">c_3_21</span><span class="p">,</span> <span class="n">af</span><span class="p">,</span> <span class="n">af2</span><span class="p">,</span> <span class="n">af3</span>
        <span class="p">)</span>
        <span class="n">res</span> <span class="o">=</span> <span class="n">omega1_21</span>

    <span class="k">elif</span> <span class="p">(</span><span class="n">l</span> <span class="o">==</span> <span class="mi">3</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">m</span> <span class="o">==</span> <span class="mi">3</span><span class="p">):</span>
        <span class="n">omega1_33</span> <span class="o">=</span> <span class="n">_Y</span><span class="p">(</span>
            <span class="n">omg1_33_0</span><span class="p">,</span> <span class="n">b_1_33</span><span class="p">,</span> <span class="n">b_2_33</span><span class="p">,</span> <span class="n">b_3_33</span><span class="p">,</span> <span class="n">c_1_33</span><span class="p">,</span> <span class="n">c_2_33</span><span class="p">,</span> <span class="n">c_3_33</span><span class="p">,</span> <span class="n">af</span><span class="p">,</span> <span class="n">af2</span><span class="p">,</span> <span class="n">af3</span>
        <span class="p">)</span>
        <span class="n">res</span> <span class="o">=</span> <span class="n">omega1_33</span>

    <span class="k">elif</span> <span class="p">(</span><span class="n">l</span> <span class="o">==</span> <span class="mi">3</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">m</span> <span class="o">==</span> <span class="mi">2</span><span class="p">):</span>
        <span class="n">omega1_32</span> <span class="o">=</span> <span class="n">_Y</span><span class="p">(</span>
            <span class="n">omg1_32_0</span><span class="p">,</span> <span class="n">b_1_32</span><span class="p">,</span> <span class="n">b_2_32</span><span class="p">,</span> <span class="n">b_3_32</span><span class="p">,</span> <span class="n">c_1_32</span><span class="p">,</span> <span class="n">c_2_32</span><span class="p">,</span> <span class="n">c_3_32</span><span class="p">,</span> <span class="n">af</span><span class="p">,</span> <span class="n">af2</span><span class="p">,</span> <span class="n">af3</span>
        <span class="p">)</span>
        <span class="n">res</span> <span class="o">=</span> <span class="n">omega1_32</span>

    <span class="k">elif</span> <span class="p">(</span><span class="n">l</span> <span class="o">==</span> <span class="mi">3</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">m</span> <span class="o">==</span> <span class="mi">1</span><span class="p">):</span>
        <span class="n">omega1_31</span> <span class="o">=</span> <span class="n">_Y</span><span class="p">(</span>
            <span class="n">omg1_31_0</span><span class="p">,</span> <span class="n">b_1_31</span><span class="p">,</span> <span class="n">b_2_31</span><span class="p">,</span> <span class="n">b_3_31</span><span class="p">,</span> <span class="n">c_1_31</span><span class="p">,</span> <span class="n">c_2_31</span><span class="p">,</span> <span class="n">c_3_31</span><span class="p">,</span> <span class="n">af</span><span class="p">,</span> <span class="n">af2</span><span class="p">,</span> <span class="n">af3</span>
        <span class="p">)</span>
        <span class="n">res</span> <span class="o">=</span> <span class="n">omega1_31</span>

    <span class="k">elif</span> <span class="p">(</span><span class="n">l</span> <span class="o">==</span> <span class="mi">4</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">m</span> <span class="o">==</span> <span class="mi">4</span><span class="p">):</span>
        <span class="n">omega1_44</span> <span class="o">=</span> <span class="n">_Y</span><span class="p">(</span>
            <span class="n">omg1_44_0</span><span class="p">,</span> <span class="n">b_1_44</span><span class="p">,</span> <span class="n">b_2_44</span><span class="p">,</span> <span class="n">b_3_44</span><span class="p">,</span> <span class="n">c_1_44</span><span class="p">,</span> <span class="n">c_2_44</span><span class="p">,</span> <span class="n">c_3_44</span><span class="p">,</span> <span class="n">af</span><span class="p">,</span> <span class="n">af2</span><span class="p">,</span> <span class="n">af3</span>
        <span class="p">)</span>
        <span class="n">res</span> <span class="o">=</span> <span class="n">omega1_44</span>

    <span class="k">elif</span> <span class="p">(</span><span class="n">l</span> <span class="o">==</span> <span class="mi">4</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">m</span> <span class="o">==</span> <span class="mi">3</span><span class="p">):</span>
        <span class="n">omega1_43</span> <span class="o">=</span> <span class="n">_Y</span><span class="p">(</span>
            <span class="n">omg1_43_0</span><span class="p">,</span> <span class="n">b_1_43</span><span class="p">,</span> <span class="n">b_2_43</span><span class="p">,</span> <span class="n">b_3_43</span><span class="p">,</span> <span class="n">c_1_43</span><span class="p">,</span> <span class="n">c_2_43</span><span class="p">,</span> <span class="n">c_3_43</span><span class="p">,</span> <span class="n">af</span><span class="p">,</span> <span class="n">af2</span><span class="p">,</span> <span class="n">af3</span>
        <span class="p">)</span>
        <span class="n">res</span> <span class="o">=</span> <span class="n">omega1_43</span>

    <span class="k">elif</span> <span class="p">(</span><span class="n">l</span> <span class="o">==</span> <span class="mi">4</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">m</span> <span class="o">==</span> <span class="mi">2</span><span class="p">):</span>
        <span class="n">omega1_42</span> <span class="o">=</span> <span class="n">_Y</span><span class="p">(</span>
            <span class="n">omg1_42_0</span><span class="p">,</span> <span class="n">b_1_42</span><span class="p">,</span> <span class="n">b_2_42</span><span class="p">,</span> <span class="n">b_3_42</span><span class="p">,</span> <span class="n">c_1_42</span><span class="p">,</span> <span class="n">c_2_42</span><span class="p">,</span> <span class="n">c_3_42</span><span class="p">,</span> <span class="n">af</span><span class="p">,</span> <span class="n">af2</span><span class="p">,</span> <span class="n">af3</span>
        <span class="p">)</span>
        <span class="n">res</span> <span class="o">=</span> <span class="n">omega1_42</span>

    <span class="k">elif</span> <span class="p">(</span><span class="n">l</span> <span class="o">==</span> <span class="mi">4</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">m</span> <span class="o">==</span> <span class="mi">1</span><span class="p">):</span>
        <span class="n">omega1_41</span> <span class="o">=</span> <span class="n">_Y</span><span class="p">(</span>
            <span class="n">omg1_41_0</span><span class="p">,</span> <span class="n">b_1_41</span><span class="p">,</span> <span class="n">b_2_41</span><span class="p">,</span> <span class="n">b_3_41</span><span class="p">,</span> <span class="n">c_1_41</span><span class="p">,</span> <span class="n">c_2_41</span><span class="p">,</span> <span class="n">c_3_41</span><span class="p">,</span> <span class="n">af</span><span class="p">,</span> <span class="n">af2</span><span class="p">,</span> <span class="n">af3</span>
        <span class="p">)</span>
        <span class="n">res</span> <span class="o">=</span> <span class="n">omega1_41</span>

    <span class="k">elif</span> <span class="p">(</span><span class="n">l</span> <span class="o">==</span> <span class="mi">5</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">m</span> <span class="o">==</span> <span class="mi">5</span><span class="p">):</span>
        <span class="n">omega1_55</span> <span class="o">=</span> <span class="n">_Y</span><span class="p">(</span>
            <span class="n">omg1_55_0</span><span class="p">,</span> <span class="n">b_1_55</span><span class="p">,</span> <span class="n">b_2_55</span><span class="p">,</span> <span class="n">b_3_55</span><span class="p">,</span> <span class="n">c_1_55</span><span class="p">,</span> <span class="n">c_2_55</span><span class="p">,</span> <span class="n">c_3_55</span><span class="p">,</span> <span class="n">af</span><span class="p">,</span> <span class="n">af2</span><span class="p">,</span> <span class="n">af3</span>
        <span class="p">)</span>
        <span class="n">res</span> <span class="o">=</span> <span class="n">omega1_55</span>

    <span class="k">return</span> <span class="n">res</span></div>



<span class="c1">#############################################################</span>
<span class="c1"># Utils Section 3: Amplitude and phase fitting coefficients #</span>
<span class="c1"># functions: c3_A, c3_phi, c4_phi                           #</span>
<span class="c1">#############################################################</span>


<div class="viewcode-block" id="_c3_A">
<a class="viewcode-back" href="../../../autoapi/PyART/models/ringdown_fits/index.html#PyART.models.ringdown_fits._c3_A">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">_c3_A</span><span class="p">(</span><span class="n">nu</span><span class="p">,</span> <span class="n">X12</span><span class="p">,</span> <span class="n">S_hat</span><span class="p">,</span> <span class="n">a12</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">m</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Function returning the coefficient c3_A of the ringdown model in section V.A of arXiv:1904.09550v2.</span>
<span class="sd">    It is called in function EOBPM_SetupFitCoefficients of waveform.pyx.</span>
<span class="sd">    -----------------------------------------------------------------------------------</span>
<span class="sd">    The fitting coefficients and equations are implemented from:</span>
<span class="sd">    (2,2) (3,3) (4,4) (5,5) - arXiv:2001.09082v2, appendix C.3</span>
<span class="sd">    (2,1) (3,2) (3,1) (4,3) (4,2) (4,1) - arXiv:1904.09550v2, section V.D</span>
<span class="sd">    -----------------------------------------------------------------------------------</span>
<span class="sd">    Note that paper arXiv:1904.09550v2 refers to the non-spinning case, while arXiv:2001.09082v2 includes spin effects.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">res</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.0</span><span class="p">,)</span>
    <span class="n">nu2</span> <span class="o">=</span> <span class="n">nu</span> <span class="o">*</span> <span class="n">nu</span>
    <span class="n">nu3</span> <span class="o">=</span> <span class="n">nu2</span> <span class="o">*</span> <span class="n">nu</span>
    <span class="n">S_hat2</span> <span class="o">=</span> <span class="n">S_hat</span> <span class="o">*</span> <span class="n">S_hat</span>
    <span class="n">S_hat3</span> <span class="o">=</span> <span class="n">S_hat2</span> <span class="o">*</span> <span class="n">S_hat</span>
    <span class="n">S_hat4</span> <span class="o">=</span> <span class="n">S_hat3</span> <span class="o">*</span> <span class="n">S_hat</span>
    <span class="n">X12_2</span> <span class="o">=</span> <span class="n">X12</span> <span class="o">*</span> <span class="n">X12</span>
    <span class="n">a12_2</span> <span class="o">=</span> <span class="n">a12</span> <span class="o">*</span> <span class="n">a12</span>

    <span class="c1"># ------------------------------------------------------------------------------------------------------------------------------------------------ #</span>
    <span class="c1"># (2,2) - TEOBResumSFits.c, line 2577-2580</span>
    <span class="n">b_0_A22</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.5585</span> <span class="o">+</span> <span class="mf">0.81196</span> <span class="o">*</span> <span class="n">nu</span>
    <span class="n">b_1_A22</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.398576</span> <span class="o">+</span> <span class="mf">0.1659421</span> <span class="o">*</span> <span class="n">X12</span>
    <span class="n">b_2_A22</span> <span class="o">=</span> <span class="mf">0.099805</span> <span class="o">-</span> <span class="mf">0.2560047</span> <span class="o">*</span> <span class="n">X12</span>
    <span class="n">b_3_A22</span> <span class="o">=</span> <span class="mf">0.72125</span> <span class="o">-</span> <span class="mf">0.9418946</span> <span class="o">*</span> <span class="n">X12</span>

    <span class="c1"># (2,1) - TEOBResumSFits.c, line 2700</span>
    <span class="n">c_3_A21_num</span> <span class="o">=</span> <span class="mf">0.23882</span> <span class="o">-</span> <span class="mf">2.2982</span> <span class="o">*</span> <span class="n">nu</span> <span class="o">+</span> <span class="mf">5.7022</span> <span class="o">*</span> <span class="n">nu2</span>
    <span class="n">c_3_A21_den</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="mf">7.7463</span> <span class="o">*</span> <span class="n">nu</span> <span class="o">+</span> <span class="mf">27.266</span> <span class="o">*</span> <span class="n">nu2</span>

    <span class="c1"># (3,3) - TEOBResumSFits.c, line 2591-2594</span>
    <span class="n">b_0_A33</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.41455</span> <span class="o">+</span> <span class="mf">1.3225</span> <span class="o">*</span> <span class="n">nu</span>
    <span class="n">b_1_A33</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.3502608</span> <span class="o">+</span> <span class="mf">1.587606</span> <span class="o">*</span> <span class="n">X12</span> <span class="o">-</span> <span class="mf">1.555325</span> <span class="o">*</span> <span class="n">X12_2</span>

    <span class="c1"># (3,2) - TEOBResumSFits.c, line 2716</span>
    <span class="n">c_3_A32_num</span> <span class="o">=</span> <span class="mf">0.1877</span> <span class="o">-</span> <span class="mf">3.0017</span> <span class="o">*</span> <span class="n">nu</span> <span class="o">+</span> <span class="mf">19.501</span> <span class="o">*</span> <span class="n">nu2</span>
    <span class="n">c_3_A32_den</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="mf">1.8199</span> <span class="o">*</span> <span class="n">nu</span>
    <span class="n">c_3_A32_exp</span> <span class="o">=</span> <span class="o">-</span><span class="mf">703.67</span>

    <span class="c1"># (3,1) - TEOBResumSFits.c, line 2705</span>
    <span class="n">c_3_A31_num</span> <span class="o">=</span> <span class="mf">3.5042</span> <span class="o">-</span> <span class="mf">55.171</span> <span class="o">*</span> <span class="n">nu</span> <span class="o">+</span> <span class="mi">217</span> <span class="o">*</span> <span class="n">nu2</span>
    <span class="n">c_3_A31_den</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="mf">15.749</span> <span class="o">*</span> <span class="n">nu</span> <span class="o">+</span> <span class="mf">605.17</span> <span class="o">*</span> <span class="n">nu3</span>

    <span class="c1"># (4,4) - TEOBResumSFits.c, line 2597-2599</span>
    <span class="n">b_0_A44</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.41591</span> <span class="o">+</span> <span class="mf">3.2099</span> <span class="o">*</span> <span class="n">nu</span>
    <span class="n">b_1_A44</span> <span class="o">=</span> <span class="o">-</span><span class="mf">9.614738</span> <span class="o">*</span> <span class="n">nu</span>
    <span class="n">b_2_A44</span> <span class="o">=</span> <span class="mf">122.461125</span> <span class="o">*</span> <span class="n">nu</span>

    <span class="c1"># (4,3) - TEOBResumSFits.c, line 2741</span>
    <span class="n">c_3_A43_num</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.02833</span> <span class="o">+</span> <span class="mf">2.8738</span> <span class="o">*</span> <span class="n">nu</span> <span class="o">-</span> <span class="mf">31.503</span> <span class="o">*</span> <span class="n">nu2</span> <span class="o">+</span> <span class="mf">93.513</span> <span class="o">*</span> <span class="n">nu3</span>
    <span class="n">c_3_A43_den</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="mf">10.051</span> <span class="o">*</span> <span class="n">nu</span> <span class="o">+</span> <span class="mf">156.14</span> <span class="o">*</span> <span class="n">nu3</span>

    <span class="c1"># (4,2) - TEOBResumSFits.c, line 2731</span>
    <span class="n">c_3_A42_num</span> <span class="o">=</span> <span class="mf">0.27143</span> <span class="o">-</span> <span class="mf">2.2629</span> <span class="o">*</span> <span class="n">nu</span> <span class="o">+</span> <span class="mf">4.6249</span> <span class="o">*</span> <span class="n">nu2</span>
    <span class="n">c_3_A42_den</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="mf">7.6762</span> <span class="o">*</span> <span class="n">nu</span> <span class="o">+</span> <span class="mf">15.117</span> <span class="o">*</span> <span class="n">nu2</span>

    <span class="c1"># (4,1) - TEOBResumSFits.c, line 2721</span>
    <span class="n">c_3_A41</span> <span class="o">=</span> <span class="mf">11.47</span> <span class="o">+</span> <span class="mf">10.936</span> <span class="o">*</span> <span class="n">nu</span>

    <span class="c1"># (5,5) - TEOBResumSFits.c, line 2604-2609</span>
    <span class="n">b_0_A55</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.5970347579708830</span> <span class="o">+</span> <span class="mf">9.1187519178640084</span> <span class="o">*</span> <span class="n">nu</span>
    <span class="n">b_1_A55</span> <span class="o">=</span> <span class="o">-</span><span class="mf">2.055335</span> <span class="o">-</span> <span class="mf">0.585373</span> <span class="o">*</span> <span class="n">X12</span>
    <span class="n">b_2_A55</span> <span class="o">=</span> <span class="o">-</span><span class="mf">12.631409</span> <span class="o">+</span> <span class="mf">19.271346</span> <span class="o">*</span> <span class="n">X12</span>
    <span class="c1"># ------------------------------------------------------------------------------------------------------------------------------------------------ #</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">l</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">m</span> <span class="o">==</span> <span class="mi">2</span><span class="p">):</span>

        <span class="n">c_3_A22</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">b_0_A22</span> <span class="o">+</span> <span class="n">b_1_A22</span> <span class="o">*</span> <span class="n">S_hat</span> <span class="o">+</span> <span class="n">b_2_A22</span> <span class="o">*</span> <span class="n">S_hat2</span> <span class="o">+</span> <span class="n">b_3_A22</span> <span class="o">*</span> <span class="n">S_hat3</span>
        <span class="p">)</span>  <span class="c1"># eq. C107 of arXiv:2001.09082v2</span>
        <span class="n">res</span> <span class="o">=</span> <span class="n">c_3_A22</span>

    <span class="k">elif</span> <span class="p">(</span><span class="n">l</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">m</span> <span class="o">==</span> <span class="mi">1</span><span class="p">):</span>

        <span class="n">c_3_A21</span> <span class="o">=</span> <span class="n">c_3_A21_num</span> <span class="o">/</span> <span class="n">c_3_A21_den</span>  <span class="c1"># table IV of arXiv:1904.09550v2</span>
        <span class="n">res</span> <span class="o">=</span> <span class="n">c_3_A21</span>

    <span class="k">elif</span> <span class="p">(</span><span class="n">l</span> <span class="o">==</span> <span class="mi">3</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">m</span> <span class="o">==</span> <span class="mi">3</span><span class="p">):</span>

        <span class="n">c_3_A33</span> <span class="o">=</span> <span class="n">b_0_A33</span> <span class="o">+</span> <span class="n">b_1_A33</span> <span class="o">*</span> <span class="n">a12</span>  <span class="c1"># eq. C108 of arXiv:2001.09082v2</span>
        <span class="n">res</span> <span class="o">=</span> <span class="n">c_3_A33</span>

    <span class="k">elif</span> <span class="p">(</span><span class="n">l</span> <span class="o">==</span> <span class="mi">3</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">m</span> <span class="o">==</span> <span class="mi">2</span><span class="p">):</span>

        <span class="n">exp_A32</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span>
            <span class="n">c_3_A32_exp</span> <span class="o">*</span> <span class="p">(</span><span class="n">nu</span> <span class="o">-</span> <span class="mf">2.0</span> <span class="o">/</span> <span class="mf">9.0</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">nu</span> <span class="o">-</span> <span class="mf">2.0</span> <span class="o">/</span> <span class="mf">9.0</span><span class="p">)</span>
        <span class="p">)</span>  <span class="c1"># table IV of arXiv:1904.09550v2</span>
        <span class="n">c_3_A32</span> <span class="o">=</span> <span class="n">c_3_A32_num</span> <span class="o">/</span> <span class="n">c_3_A32_den</span> <span class="o">-</span> <span class="n">exp_A32</span>
        <span class="n">res</span> <span class="o">=</span> <span class="n">c_3_A32</span>

    <span class="k">elif</span> <span class="p">(</span><span class="n">l</span> <span class="o">==</span> <span class="mi">3</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">m</span> <span class="o">==</span> <span class="mi">1</span><span class="p">):</span>

        <span class="n">c_3_A31</span> <span class="o">=</span> <span class="n">c_3_A31_num</span> <span class="o">/</span> <span class="n">c_3_A31_den</span>  <span class="c1"># table IV of arXiv:1904.09550v2</span>
        <span class="n">res</span> <span class="o">=</span> <span class="n">c_3_A31</span>

    <span class="k">elif</span> <span class="p">(</span><span class="n">l</span> <span class="o">==</span> <span class="mi">4</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">m</span> <span class="o">==</span> <span class="mi">4</span><span class="p">):</span>

        <span class="n">c_3_A44</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">b_0_A44</span> <span class="o">+</span> <span class="n">b_1_A44</span> <span class="o">*</span> <span class="n">S_hat</span> <span class="o">+</span> <span class="n">b_2_A44</span> <span class="o">*</span> <span class="n">S_hat2</span>
        <span class="p">)</span>  <span class="c1"># eq. C110 of arXiv:2001.09082v2</span>
        <span class="n">res</span> <span class="o">=</span> <span class="n">c_3_A44</span>

    <span class="k">elif</span> <span class="p">(</span><span class="n">l</span> <span class="o">==</span> <span class="mi">4</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">m</span> <span class="o">==</span> <span class="mi">3</span><span class="p">):</span>

        <span class="n">c_3_A43</span> <span class="o">=</span> <span class="n">c_3_A43_num</span> <span class="o">/</span> <span class="n">c_3_A43_den</span>  <span class="c1"># table IV of arXiv:1904.09550v2</span>
        <span class="n">res</span> <span class="o">=</span> <span class="n">c_3_A43</span>

    <span class="k">elif</span> <span class="p">(</span><span class="n">l</span> <span class="o">==</span> <span class="mi">4</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">m</span> <span class="o">==</span> <span class="mi">2</span><span class="p">):</span>

        <span class="n">c_3_A42</span> <span class="o">=</span> <span class="n">c_3_A42_num</span> <span class="o">/</span> <span class="n">c_3_A42_den</span>  <span class="c1"># table IV of arXiv:1904.09550v2</span>
        <span class="n">res</span> <span class="o">=</span> <span class="n">c_3_A42</span>

    <span class="k">elif</span> <span class="p">(</span><span class="n">l</span> <span class="o">==</span> <span class="mi">4</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">m</span> <span class="o">==</span> <span class="mi">1</span><span class="p">):</span>

        <span class="n">res</span> <span class="o">=</span> <span class="n">c_3_A41</span>  <span class="c1"># table IV of arXiv:1904.09550v2</span>

    <span class="k">elif</span> <span class="p">(</span><span class="n">l</span> <span class="o">==</span> <span class="mi">5</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">m</span> <span class="o">==</span> <span class="mi">5</span><span class="p">):</span>

        <span class="n">c_3_A55</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">b_0_A55</span> <span class="o">+</span> <span class="n">b_1_A55</span> <span class="o">*</span> <span class="n">a12</span> <span class="o">+</span> <span class="n">b_2_A55</span> <span class="o">*</span> <span class="n">a12_2</span>
        <span class="p">)</span>  <span class="c1"># eq. C111 of arXiv:2001.09082v2</span>
        <span class="n">res</span> <span class="o">=</span> <span class="n">c_3_A55</span>

    <span class="k">return</span> <span class="n">res</span></div>



<div class="viewcode-block" id="_c3_phi">
<a class="viewcode-back" href="../../../autoapi/PyART/models/ringdown_fits/index.html#PyART.models.ringdown_fits._c3_phi">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">_c3_phi</span><span class="p">(</span><span class="n">nu</span><span class="p">,</span> <span class="n">X12</span><span class="p">,</span> <span class="n">S_hat</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">m</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Function returning the coefficient c3_phi of the ringdown model in section V.A of arXiv:1904.09550v2.</span>
<span class="sd">    It is called in function EOBPM_SetupFitCoefficients of waveform.pyx.</span>
<span class="sd">    -----------------------------------------------------------------------------------</span>
<span class="sd">    The fitting coefficients and equations are implemented from:</span>
<span class="sd">    (2,2) (3,3) (4,4) (5,5) - arXiv:2001.09082v2, appendix C.3</span>
<span class="sd">    (2,1) (3,2) (3,1) (4,3) (4,2) (4,1) - arXiv:1904.09550v2, section V.D</span>
<span class="sd">    -----------------------------------------------------------------------------------</span>
<span class="sd">    Note that paper arXiv:1904.09550v2 refers to the non-spinning case, while arXiv:2001.09082v2 includes spin effects.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">res</span> <span class="o">=</span> <span class="mf">0.0</span>
    <span class="n">nu2</span> <span class="o">=</span> <span class="n">nu</span> <span class="o">*</span> <span class="n">nu</span>
    <span class="n">nu3</span> <span class="o">=</span> <span class="n">nu2</span> <span class="o">*</span> <span class="n">nu</span>
    <span class="n">S_hat2</span> <span class="o">=</span> <span class="n">S_hat</span> <span class="o">*</span> <span class="n">S_hat</span>
    <span class="n">S_hat3</span> <span class="o">=</span> <span class="n">S_hat2</span> <span class="o">*</span> <span class="n">S_hat</span>
    <span class="n">S_hat4</span> <span class="o">=</span> <span class="n">S_hat3</span> <span class="o">*</span> <span class="n">S_hat</span>
    <span class="n">X12_2</span> <span class="o">=</span> <span class="n">X12</span> <span class="o">*</span> <span class="n">X12</span>
    <span class="n">nu_d</span> <span class="o">=</span> <span class="mf">0.08271</span>
    <span class="n">nu_d2</span> <span class="o">=</span> <span class="n">nu_d</span> <span class="o">*</span> <span class="n">nu_d</span>  <span class="c1"># TEOBResumSFits.c, line 2711</span>

    <span class="c1"># ------------------------------------------------------------------------------------------------------------------------------------------------ #</span>
    <span class="c1"># (2,2) - TEOBResumSFits.c, line 2613-2617</span>
    <span class="n">b_0_phi22</span> <span class="o">=</span> <span class="mf">3.8436</span> <span class="o">+</span> <span class="mf">0.71565</span> <span class="o">*</span> <span class="n">nu</span>
    <span class="n">b_1_phi22</span> <span class="o">=</span> <span class="mf">5.12794</span> <span class="o">-</span> <span class="mf">1.323643</span> <span class="o">*</span> <span class="n">X12</span>
    <span class="n">b_2_phi22</span> <span class="o">=</span> <span class="mf">9.9136</span> <span class="o">-</span> <span class="mf">3.555007</span> <span class="o">*</span> <span class="n">X12</span>
    <span class="n">b_3_phi22</span> <span class="o">=</span> <span class="o">-</span><span class="mf">4.1075</span> <span class="o">+</span> <span class="mf">7.011267</span> <span class="o">*</span> <span class="n">X12</span>
    <span class="n">b_4_phi22</span> <span class="o">=</span> <span class="o">-</span><span class="mf">31.5562</span> <span class="o">+</span> <span class="mf">32.737824</span> <span class="o">*</span> <span class="n">X12</span>

    <span class="c1"># (2,1) - TEOBResumSFits.c, line 2701</span>
    <span class="n">c_3_phi21_num</span> <span class="o">=</span> <span class="mf">2.6269</span> <span class="o">-</span> <span class="mf">37.677</span> <span class="o">*</span> <span class="n">nu</span> <span class="o">+</span> <span class="mf">181.61</span> <span class="o">*</span> <span class="n">nu2</span>
    <span class="n">c_3_phi21_den</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="mf">16.082</span> <span class="o">*</span> <span class="n">nu</span> <span class="o">+</span> <span class="mf">89.836</span> <span class="o">*</span> <span class="n">nu2</span>

    <span class="c1"># (3,3) - TEOBResumSFits.c, line 2632</span>
    <span class="n">b_0_phi33</span> <span class="o">=</span> <span class="mf">3.0611</span> <span class="o">-</span> <span class="mf">6.1597</span> <span class="o">*</span> <span class="n">nu</span>

    <span class="c1"># (3,2) - TEOBResumSFits.c, line 2717</span>
    <span class="n">c_3_phi32_num</span> <span class="o">=</span> <span class="mf">0.90944</span> <span class="o">-</span> <span class="mf">1.8924</span> <span class="o">*</span> <span class="n">nu</span> <span class="o">+</span> <span class="mf">3.6848</span> <span class="o">*</span> <span class="n">nu2</span>
    <span class="n">c_3_phi32_den</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="mf">8.9739</span> <span class="o">*</span> <span class="n">nu</span> <span class="o">+</span> <span class="mf">21.024</span> <span class="o">*</span> <span class="n">nu2</span>

    <span class="c1"># (3,1) - TEOBResumSFits.c, line 2708-2712</span>
    <span class="n">c_3_phi31_num</span> <span class="o">=</span> <span class="o">-</span><span class="mf">6.1719</span> <span class="o">+</span> <span class="mf">29.617</span> <span class="o">*</span> <span class="n">nu</span> <span class="o">+</span> <span class="mf">254.24</span> <span class="o">*</span> <span class="n">nu2</span>
    <span class="n">c_3_phi31_den</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="mf">1.5435</span> <span class="o">*</span> <span class="n">nu</span>
    <span class="n">c_3_phi31_num_nu</span> <span class="o">=</span> <span class="o">-</span><span class="mf">6.1719</span> <span class="o">+</span> <span class="mf">29.617</span> <span class="o">*</span> <span class="n">nu_d</span> <span class="o">+</span> <span class="mf">254.24</span> <span class="o">*</span> <span class="n">nu_d2</span>
    <span class="n">c_3_phi31_den_nu</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="mf">1.5435</span> <span class="o">*</span> <span class="n">nu_d</span>

    <span class="c1"># (4,4) - TEOBResumSFits.c, line 2637</span>
    <span class="n">b_0_phi44</span> <span class="o">=</span> <span class="p">(</span><span class="mf">3.6662</span> <span class="o">-</span> <span class="mf">30.072</span> <span class="o">*</span> <span class="n">nu</span> <span class="o">+</span> <span class="mf">76.371</span> <span class="o">*</span> <span class="n">nu2</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="mf">3.5522</span> <span class="o">*</span> <span class="n">nu</span><span class="p">)</span>

    <span class="c1"># (4,3) - TEOBResumSFits.c, line 2742</span>
    <span class="n">c_3_phi43_num</span> <span class="o">=</span> <span class="mf">2.284</span> <span class="o">-</span> <span class="mf">23.817</span> <span class="o">*</span> <span class="n">nu</span> <span class="o">+</span> <span class="mf">70.952</span> <span class="o">*</span> <span class="n">nu2</span>
    <span class="n">c_3_phi43_den</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="mf">10.909</span> <span class="o">*</span> <span class="n">nu</span> <span class="o">+</span> <span class="mf">30.723</span> <span class="o">*</span> <span class="n">nu2</span>

    <span class="c1"># (4,2) - TEOBResumSFits.c, line 2732</span>
    <span class="n">c_3_phi42_num</span> <span class="o">=</span> <span class="mf">2.2065</span> <span class="o">-</span> <span class="mf">17.629</span> <span class="o">*</span> <span class="n">nu</span> <span class="o">+</span> <span class="mf">65.372</span> <span class="o">*</span> <span class="n">nu2</span>
    <span class="n">c_3_phi42_den</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="mf">4.7744</span> <span class="o">*</span> <span class="n">nu</span> <span class="o">+</span> <span class="mf">3.1876</span> <span class="o">*</span> <span class="n">nu2</span>

    <span class="c1"># (4,1) - TEOBResumSFits.c, line 2721-2727</span>
    <span class="n">c_3_phi41</span> <span class="o">=</span> <span class="o">-</span><span class="mf">6.0286</span> <span class="o">+</span> <span class="mf">46.632</span> <span class="o">*</span> <span class="n">nu</span>
    <span class="n">c_3_phi41_nu</span> <span class="o">=</span> <span class="o">-</span><span class="mf">2.1747</span>

    <span class="c1"># (5,5) - TEOBResumSFits.c, line 2642-2647</span>
    <span class="n">b_0_phi55</span> <span class="o">=</span> <span class="mf">4.226238</span> <span class="o">-</span> <span class="mf">59.69284</span> <span class="o">*</span> <span class="n">nu</span> <span class="o">+</span> <span class="mf">373.312597</span> <span class="o">*</span> <span class="n">nu2</span>
    <span class="n">b_1_phi55</span> <span class="o">=</span> <span class="o">-</span><span class="mf">2.687133</span> <span class="o">+</span> <span class="mf">4.873750</span> <span class="o">*</span> <span class="n">X12</span>
    <span class="n">b_2_phi55</span> <span class="o">=</span> <span class="o">-</span><span class="mf">14.629684</span> <span class="o">+</span> <span class="mf">19.696954</span> <span class="o">*</span> <span class="n">X12</span>
    <span class="c1"># ------------------------------------------------------------------------------------------------------------------------------------------------ #</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">l</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">m</span> <span class="o">==</span> <span class="mi">2</span><span class="p">):</span>

        <span class="n">c_3_phi22</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">b_0_phi22</span>
            <span class="o">+</span> <span class="n">b_1_phi22</span> <span class="o">*</span> <span class="n">S_hat</span>
            <span class="o">+</span> <span class="n">b_2_phi22</span> <span class="o">*</span> <span class="n">S_hat2</span>
            <span class="o">+</span> <span class="n">b_3_phi22</span> <span class="o">*</span> <span class="n">S_hat3</span>
            <span class="o">+</span> <span class="n">b_4_phi22</span> <span class="o">*</span> <span class="n">S_hat4</span>
        <span class="p">)</span>  <span class="c1"># eq. C107 of arXiv:2001.09082v2</span>
        <span class="n">res</span> <span class="o">=</span> <span class="n">c_3_phi22</span>

    <span class="k">elif</span> <span class="p">(</span><span class="n">l</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">m</span> <span class="o">==</span> <span class="mi">1</span><span class="p">):</span>

        <span class="n">c_3_phi21</span> <span class="o">=</span> <span class="n">c_3_phi21_num</span> <span class="o">/</span> <span class="n">c_3_phi21_den</span>  <span class="c1"># table IV of arXiv:1904.09550v2</span>
        <span class="n">res</span> <span class="o">=</span> <span class="n">c_3_phi21</span>

    <span class="k">elif</span> <span class="p">(</span><span class="n">l</span> <span class="o">==</span> <span class="mi">3</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">m</span> <span class="o">==</span> <span class="mi">3</span><span class="p">):</span>

        <span class="n">c_3_phi33</span> <span class="o">=</span> <span class="n">b_0_phi33</span>  <span class="c1"># TEOBResumSFits.c; line 2632</span>
        <span class="n">res</span> <span class="o">=</span> <span class="n">c_3_phi33</span>

    <span class="k">elif</span> <span class="p">(</span><span class="n">l</span> <span class="o">==</span> <span class="mi">3</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">m</span> <span class="o">==</span> <span class="mi">2</span><span class="p">):</span>

        <span class="n">c_3_phi32</span> <span class="o">=</span> <span class="n">c_3_phi32_num</span> <span class="o">/</span> <span class="n">c_3_phi32_den</span>  <span class="c1"># table IV of arXiv:1904.09550v2</span>
        <span class="n">res</span> <span class="o">=</span> <span class="n">c_3_phi32</span>

    <span class="k">elif</span> <span class="p">(</span><span class="n">l</span> <span class="o">==</span> <span class="mi">3</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">m</span> <span class="o">==</span> <span class="mi">1</span><span class="p">):</span>

        <span class="k">if</span> <span class="n">nu</span> <span class="o">&gt;</span> <span class="mf">0.08271</span><span class="p">:</span>
            <span class="n">c_3_phi31</span> <span class="o">=</span> <span class="n">c_3_phi31_num</span> <span class="o">/</span> <span class="n">c_3_phi31_den</span>  <span class="c1"># table IV of arXiv:1904.09550v2</span>
            <span class="n">res</span> <span class="o">=</span> <span class="n">c_3_phi31</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">c_3_phi31_nu</span> <span class="o">=</span> <span class="n">c_3_phi31_num_nu</span> <span class="o">/</span> <span class="n">c_3_phi31_den_nu</span>
            <span class="n">res</span> <span class="o">=</span> <span class="n">c_3_phi31_nu</span>

    <span class="k">elif</span> <span class="p">(</span><span class="n">l</span> <span class="o">==</span> <span class="mi">4</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">m</span> <span class="o">==</span> <span class="mi">4</span><span class="p">):</span>

        <span class="n">c_3_phi44</span> <span class="o">=</span> <span class="n">b_0_phi44</span>  <span class="c1"># TEOBResumSFits.c; line 2637</span>
        <span class="n">res</span> <span class="o">=</span> <span class="n">c_3_phi44</span>

    <span class="k">elif</span> <span class="p">(</span><span class="n">l</span> <span class="o">==</span> <span class="mi">4</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">m</span> <span class="o">==</span> <span class="mi">3</span><span class="p">):</span>

        <span class="n">c_3_phi43</span> <span class="o">=</span> <span class="n">c_3_phi43_num</span> <span class="o">/</span> <span class="n">c_3_phi43_den</span>  <span class="c1"># table IV of arXiv:1904.09550v2</span>
        <span class="n">res</span> <span class="o">=</span> <span class="n">c_3_phi43</span>

    <span class="k">elif</span> <span class="p">(</span><span class="n">l</span> <span class="o">==</span> <span class="mi">4</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">m</span> <span class="o">==</span> <span class="mi">2</span><span class="p">):</span>

        <span class="n">c_3_phi42</span> <span class="o">=</span> <span class="n">c_3_phi42_num</span> <span class="o">/</span> <span class="n">c_3_phi42_den</span>  <span class="c1"># table IV of arXiv:1904.09550v2</span>
        <span class="n">res</span> <span class="o">=</span> <span class="n">c_3_phi42</span>

    <span class="k">elif</span> <span class="p">(</span><span class="n">l</span> <span class="o">==</span> <span class="mi">4</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">m</span> <span class="o">==</span> <span class="mi">1</span><span class="p">):</span>

        <span class="k">if</span> <span class="n">nu</span> <span class="o">&gt;=</span> <span class="mf">10.0</span> <span class="o">/</span> <span class="mf">121.0</span><span class="p">:</span>
            <span class="n">res</span> <span class="o">=</span> <span class="n">c_3_phi41</span>  <span class="c1"># table IV of arXiv:1904.09550v2</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">res</span> <span class="o">=</span> <span class="n">c_3_phi41_nu</span>

    <span class="k">elif</span> <span class="p">(</span><span class="n">l</span> <span class="o">==</span> <span class="mi">5</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">m</span> <span class="o">==</span> <span class="mi">5</span><span class="p">):</span>

        <span class="n">c_3_phi55</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">b_0_phi55</span> <span class="o">+</span> <span class="n">b_1_phi55</span> <span class="o">*</span> <span class="n">S_hat</span> <span class="o">+</span> <span class="n">b_2_phi55</span> <span class="o">*</span> <span class="n">S_hat2</span>
        <span class="p">)</span>  <span class="c1"># eq. C111 of arXiv:2001.09082v2</span>
        <span class="n">res</span> <span class="o">=</span> <span class="n">c_3_phi55</span>

    <span class="k">return</span> <span class="n">res</span></div>



<div class="viewcode-block" id="_c4_phi">
<a class="viewcode-back" href="../../../autoapi/PyART/models/ringdown_fits/index.html#PyART.models.ringdown_fits._c4_phi">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">_c4_phi</span><span class="p">(</span><span class="n">nu</span><span class="p">,</span> <span class="n">X12</span><span class="p">,</span> <span class="n">S_hat</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">m</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Function returning the coefficient c4_phi of the ringdown model in section V.A of arXiv:1904.09550v2.</span>
<span class="sd">    It is called in function EOBPM_SetupFitCoefficients of waveform.pyx.</span>
<span class="sd">    -----------------------------------------------------------------------------------</span>
<span class="sd">    The fitting coefficients and equations are implemented from:</span>
<span class="sd">    (2,2) (3,3) (4,4) (5,5) - arXiv:2001.09082v2, appendix C.3</span>
<span class="sd">    (2,1) (3,2) (3,1) (4,3) (4,2) (4,1) - arXiv:1904.09550v2, section V.D</span>
<span class="sd">    -----------------------------------------------------------------------------------</span>
<span class="sd">    Note that paper arXiv:1904.09550v2 refers to the non-spinning case, while arXiv:2001.09082v2 includes spin effects.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">res</span> <span class="o">=</span> <span class="mf">0.0</span>
    <span class="n">nu2</span> <span class="o">=</span> <span class="n">nu</span> <span class="o">*</span> <span class="n">nu</span>
    <span class="n">nu4</span> <span class="o">=</span> <span class="n">nu2</span> <span class="o">*</span> <span class="n">nu2</span>
    <span class="n">S_hat2</span> <span class="o">=</span> <span class="n">S_hat</span> <span class="o">*</span> <span class="n">S_hat</span>
    <span class="n">S_hat3</span> <span class="o">=</span> <span class="n">S_hat2</span> <span class="o">*</span> <span class="n">S_hat</span>
    <span class="n">S_hat4</span> <span class="o">=</span> <span class="n">S_hat3</span> <span class="o">*</span> <span class="n">S_hat</span>
    <span class="n">X12_2</span> <span class="o">=</span> <span class="n">X12</span> <span class="o">*</span> <span class="n">X12</span>

    <span class="c1"># ------------------------------------------------------------------------------------------------------------------------------------------------ #</span>
    <span class="c1"># (2,2) - TEOBResumSFits.c, line 2651-2653</span>
    <span class="n">b_0_phi22</span> <span class="o">=</span> <span class="mf">1.4736</span> <span class="o">+</span> <span class="mf">2.2337</span> <span class="o">*</span> <span class="n">nu</span>
    <span class="n">b_1_phi22</span> <span class="o">=</span> <span class="mf">8.26539</span> <span class="o">+</span> <span class="mf">0.779683</span> <span class="o">*</span> <span class="n">X12</span>
    <span class="n">b_2_phi22</span> <span class="o">=</span> <span class="mf">14.2053</span> <span class="o">-</span> <span class="mf">0.069638</span> <span class="o">*</span> <span class="n">X12</span>

    <span class="c1"># (2,1) - TEOBResumSFits.c, line 2702</span>
    <span class="n">c_4_phi21_num</span> <span class="o">=</span> <span class="mf">4.355</span> <span class="o">-</span> <span class="mf">53.763</span> <span class="o">*</span> <span class="n">nu</span> <span class="o">+</span> <span class="mf">188.06</span> <span class="o">*</span> <span class="n">nu2</span>
    <span class="n">c_4_phi21_den</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="mf">18.427</span> <span class="o">*</span> <span class="n">nu</span> <span class="o">+</span> <span class="mf">147.16</span> <span class="o">*</span> <span class="n">nu2</span>

    <span class="c1"># (3,3) - TEOBResumSFits.c, line 2666</span>
    <span class="n">b_0_phi33</span> <span class="o">=</span> <span class="mf">1.789</span> <span class="o">-</span> <span class="mf">5.6684</span> <span class="o">*</span> <span class="n">nu</span>

    <span class="c1"># (3,2) - TEOBResumSFits.c, line 2718</span>
    <span class="n">c_4_phi32_num</span> <span class="o">=</span> <span class="mf">2.3038</span> <span class="o">-</span> <span class="mf">50.79</span> <span class="o">*</span> <span class="n">nu</span> <span class="o">+</span> <span class="mf">334.41</span> <span class="o">*</span> <span class="n">nu2</span>
    <span class="n">c_4_phi32_den</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="mf">18.326</span> <span class="o">*</span> <span class="n">nu</span> <span class="o">+</span> <span class="mf">99.54</span> <span class="o">*</span> <span class="n">nu2</span>

    <span class="c1"># (3,1) - TEOBResumSFits.c, line 2706</span>
    <span class="n">c_4_phi31</span> <span class="o">=</span> <span class="mf">3.6485</span> <span class="o">+</span> <span class="mf">5.4536</span> <span class="o">*</span> <span class="n">nu</span>

    <span class="c1"># (4,4) - TEOBResumSFits.c, line 2671</span>
    <span class="n">b_0_phi44</span> <span class="o">=</span> <span class="mf">0.21595</span> <span class="o">+</span> <span class="mf">23.216</span> <span class="o">*</span> <span class="n">nu</span>

    <span class="c1"># (4,3) - TEOBResumSFits.c, line 2743</span>
    <span class="n">c_4_phi43_num</span> <span class="o">=</span> <span class="mf">2.4966</span> <span class="o">-</span> <span class="mf">6.2043</span> <span class="o">*</span> <span class="n">nu</span>
    <span class="n">c_4_phi43_den</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="mf">252.47</span> <span class="o">*</span> <span class="n">nu4</span>

    <span class="c1"># (4,2) - TEOBResumSFits.c, line 2734-2737</span>
    <span class="n">c_4_phi42_num_nu_a</span> <span class="o">=</span> <span class="mf">132.56</span> <span class="o">-</span> <span class="mf">1155.5</span> <span class="o">*</span> <span class="n">nu</span> <span class="o">+</span> <span class="mf">2516.8</span> <span class="o">*</span> <span class="n">nu2</span>
    <span class="n">c_4_phi42_den_nu_a</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="mf">3.8231</span> <span class="o">*</span> <span class="n">nu</span>
    <span class="n">c_4_phi42_num_nu_b</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.58736</span> <span class="o">+</span> <span class="mf">16.401</span> <span class="o">*</span> <span class="n">nu</span>
    <span class="n">c_4_phi42_den_nu_b</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="mf">4.5202</span> <span class="o">*</span> <span class="n">nu</span>

    <span class="c1"># (4,1) - TEOBResumSFits.c, line 2722</span>
    <span class="n">c_4_phi41</span> <span class="o">=</span> <span class="mf">1.6629</span> <span class="o">+</span> <span class="mf">11.497</span> <span class="o">*</span> <span class="n">nu</span>

    <span class="c1"># (5,5) - TEOBResumSFits.c, line 2676-2681</span>
    <span class="n">b_0_phi55</span> <span class="o">=</span> <span class="mf">1.3639723340485870</span> <span class="o">+</span> <span class="mf">14.9111373110275380</span> <span class="o">*</span> <span class="n">nu</span>
    <span class="n">b_1_phi55</span> <span class="o">=</span> <span class="mf">7.198729</span> <span class="o">-</span> <span class="mf">3.870998</span> <span class="o">*</span> <span class="n">X12</span>
    <span class="n">b_2_phi55</span> <span class="o">=</span> <span class="o">-</span><span class="mf">25.992190</span> <span class="o">+</span> <span class="mf">36.882645</span> <span class="o">*</span> <span class="n">X12</span>
    <span class="c1"># ------------------------------------------------------------------------------------------------------------------------------------------------ #</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">l</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">m</span> <span class="o">==</span> <span class="mi">2</span><span class="p">):</span>

        <span class="n">c_4_phi22</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">b_0_phi22</span> <span class="o">+</span> <span class="n">b_1_phi22</span> <span class="o">*</span> <span class="n">S_hat</span> <span class="o">+</span> <span class="n">b_2_phi22</span> <span class="o">*</span> <span class="n">S_hat2</span>
        <span class="p">)</span>  <span class="c1"># eq. C107 of arXiv:2001.09082v2</span>
        <span class="n">res</span> <span class="o">=</span> <span class="n">c_4_phi22</span>

    <span class="k">elif</span> <span class="p">(</span><span class="n">l</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">m</span> <span class="o">==</span> <span class="mi">1</span><span class="p">):</span>

        <span class="n">c_4_phi21</span> <span class="o">=</span> <span class="n">c_4_phi21_num</span> <span class="o">/</span> <span class="n">c_4_phi21_den</span>  <span class="c1"># table IV of arXiv:1904.09550v2</span>
        <span class="n">res</span> <span class="o">=</span> <span class="n">c_4_phi21</span>

    <span class="k">elif</span> <span class="p">(</span><span class="n">l</span> <span class="o">==</span> <span class="mi">3</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">m</span> <span class="o">==</span> <span class="mi">3</span><span class="p">):</span>

        <span class="n">c_4_phi33</span> <span class="o">=</span> <span class="n">b_0_phi33</span>  <span class="c1"># TEOBResumSFits.c, line 2666</span>
        <span class="n">res</span> <span class="o">=</span> <span class="n">c_4_phi33</span>

    <span class="k">elif</span> <span class="p">(</span><span class="n">l</span> <span class="o">==</span> <span class="mi">3</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">m</span> <span class="o">==</span> <span class="mi">2</span><span class="p">):</span>

        <span class="n">c_4_phi32</span> <span class="o">=</span> <span class="n">c_4_phi32_num</span> <span class="o">/</span> <span class="n">c_4_phi32_den</span>  <span class="c1"># table IV of arXiv:1904.09550v2</span>
        <span class="n">res</span> <span class="o">=</span> <span class="n">c_4_phi32</span>

    <span class="k">elif</span> <span class="p">(</span><span class="n">l</span> <span class="o">==</span> <span class="mi">3</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">m</span> <span class="o">==</span> <span class="mi">1</span><span class="p">):</span>

        <span class="n">res</span> <span class="o">=</span> <span class="n">c_4_phi31</span>  <span class="c1"># table IV of arXiv:1904.09550v2</span>

    <span class="k">elif</span> <span class="p">(</span><span class="n">l</span> <span class="o">==</span> <span class="mi">4</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">m</span> <span class="o">==</span> <span class="mi">4</span><span class="p">):</span>

        <span class="n">c_4_phi44</span> <span class="o">=</span> <span class="n">b_0_phi44</span>  <span class="c1"># TEOBResumSFits.c, line 2671</span>
        <span class="n">res</span> <span class="o">=</span> <span class="n">c_4_phi44</span>

    <span class="k">elif</span> <span class="p">(</span><span class="n">l</span> <span class="o">==</span> <span class="mi">4</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">m</span> <span class="o">==</span> <span class="mi">3</span><span class="p">):</span>

        <span class="n">c_4_phi43</span> <span class="o">=</span> <span class="n">c_4_phi43_num</span> <span class="o">/</span> <span class="n">c_4_phi43_den</span>  <span class="c1"># table IV of arXiv:1904.09550v2</span>
        <span class="n">res</span> <span class="o">=</span> <span class="n">c_4_phi43</span>

    <span class="k">elif</span> <span class="p">(</span><span class="n">l</span> <span class="o">==</span> <span class="mi">4</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">m</span> <span class="o">==</span> <span class="mi">2</span><span class="p">):</span>  <span class="c1"># eq. 5.20 of arXiv:1904.09550v2</span>

        <span class="k">if</span> <span class="n">nu</span> <span class="o">&gt;=</span> <span class="mf">2.5</span> <span class="o">/</span> <span class="mf">12.25</span><span class="p">:</span>
            <span class="n">c_4_phi42</span> <span class="o">=</span> <span class="n">c_4_phi42_num_nu_a</span> <span class="o">/</span> <span class="n">c_4_phi42_den_nu_a</span>
            <span class="n">res</span> <span class="o">=</span> <span class="n">c_4_phi42</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">c_4_phi42</span> <span class="o">=</span> <span class="n">c_4_phi42_num_nu_b</span> <span class="o">/</span> <span class="n">c_4_phi42_den_nu_b</span>
            <span class="n">res</span> <span class="o">=</span> <span class="n">c_4_phi42</span>

    <span class="k">elif</span> <span class="p">(</span><span class="n">l</span> <span class="o">==</span> <span class="mi">4</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">m</span> <span class="o">==</span> <span class="mi">1</span><span class="p">):</span>

        <span class="n">res</span> <span class="o">=</span> <span class="n">c_4_phi41</span>  <span class="c1"># table IV of arXiv:1904.09550v2</span>

    <span class="k">elif</span> <span class="p">(</span><span class="n">l</span> <span class="o">==</span> <span class="mi">5</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">m</span> <span class="o">==</span> <span class="mi">5</span><span class="p">):</span>

        <span class="n">c_4_phi55</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">b_0_phi55</span> <span class="o">+</span> <span class="n">b_1_phi55</span> <span class="o">*</span> <span class="n">S_hat</span> <span class="o">+</span> <span class="n">b_2_phi55</span> <span class="o">*</span> <span class="n">S_hat2</span>
        <span class="p">)</span>  <span class="c1"># eq. C111 of arXiv:2001.09082v2</span>
        <span class="n">res</span> <span class="o">=</span> <span class="n">c_4_phi55</span>

    <span class="k">return</span> <span class="n">res</span></div>



<span class="c1">#################################################</span>
<span class="c1"># Utils Section 4: Fits for peak quantities     #</span>
<span class="c1"># functions: dOmega, amplitude_peak, omega_peak #</span>
<span class="c1">#################################################</span>


<div class="viewcode-block" id="_dOmega">
<a class="viewcode-back" href="../../../autoapi/PyART/models/ringdown_fits/index.html#PyART.models.ringdown_fits._dOmega">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">_dOmega</span><span class="p">(</span><span class="n">omega1</span><span class="p">,</span> <span class="n">Mf</span><span class="p">,</span> <span class="n">omega_peak</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;In the papers is referred to as Delta_omega, e.g. see in section V.A of arXiv:1904.09550v2&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">omega1</span> <span class="o">-</span> <span class="n">Mf</span> <span class="o">*</span> <span class="n">omega_peak</span></div>



<div class="viewcode-block" id="_amplitude_peak">
<a class="viewcode-back" href="../../../autoapi/PyART/models/ringdown_fits/index.html#PyART.models.ringdown_fits._amplitude_peak">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">_amplitude_peak</span><span class="p">(</span><span class="n">nu</span><span class="p">,</span> <span class="n">X12</span><span class="p">,</span> <span class="n">S_hat</span><span class="p">,</span> <span class="n">a12</span><span class="p">,</span> <span class="n">S_bar</span><span class="p">,</span> <span class="n">a0</span><span class="p">,</span> <span class="n">omega_peak</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">m</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Function returning the value of A at the peak, following appendix C.2 of arXiv:2001.09082v2.</span>
<span class="sd">    It is called in function EOBPM_SetupFitCoefficients of waveform.pyx.</span>
<span class="sd">    -----------------------------------------------------------------------------------</span>
<span class="sd">    The fitting coefficients and equations are implemented from:</span>
<span class="sd">    (2,2) (2,1) (3,3) (3,2) (4,4) (4,3) (4,2) (5,5) - arXiv:2001.09082v2, appendix C.3</span>
<span class="sd">    (3,1) (4,1) - arXiv:1904.09550v2, section V.D</span>
<span class="sd">    -----------------------------------------------------------------------------------</span>
<span class="sd">    Note that paper arXiv:1904.09550v2 refers to the non-spinning case, while arXiv:2001.09082v2 includes spin effects.</span>
<span class="sd">    -----------------------------------------------------------------------------------</span>
<span class="sd">    Note: To fit the amplitude peak, the waveform is scaled as in eqs. C6-C12 of arXiv:2001.09082v2,</span>
<span class="sd">          but the amplitude peak in eqs. 7-8 of arXiv:1406.0401v2 is just nu-rescaled (see eq. (1) of arXiv:1606.03952v4).</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">res</span> <span class="o">=</span> <span class="mf">0.0</span>
    <span class="n">nu2</span> <span class="o">=</span> <span class="n">nu</span> <span class="o">*</span> <span class="n">nu</span>
    <span class="n">X12_2</span> <span class="o">=</span> <span class="n">X12</span> <span class="o">*</span> <span class="n">X12</span>
    <span class="n">S_hat2</span> <span class="o">=</span> <span class="n">S_hat</span> <span class="o">*</span> <span class="n">S_hat</span>
    <span class="n">S_hat3</span> <span class="o">=</span> <span class="n">S_hat2</span> <span class="o">*</span> <span class="n">S_hat</span>
    <span class="n">S_bar2</span> <span class="o">=</span> <span class="n">S_bar</span> <span class="o">*</span> <span class="n">S_bar</span>
    <span class="n">a0_2</span> <span class="o">=</span> <span class="n">a0</span> <span class="o">*</span> <span class="n">a0</span>
    <span class="n">a12_2</span> <span class="o">=</span> <span class="n">a12</span> <span class="o">*</span> <span class="n">a12</span>
    <span class="n">S_bar_21</span> <span class="o">=</span> <span class="o">-</span><span class="nb">abs</span><span class="p">(</span><span class="n">S_bar</span><span class="p">)</span>
    <span class="n">a12_33</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">a12</span><span class="p">)</span>

    <span class="c1"># ------------------------------------------------------------------------------------------------------------------------------------------------ #</span>
    <span class="c1"># (2,2) - TEOBResumSFits.c, line 2423-2431</span>
    <span class="n">A22_0</span> <span class="o">=</span> <span class="mf">1.44959</span>  <span class="c1"># TEOBResumSFits.c, line 1993</span>
    <span class="n">a_1_A22</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.041285</span>
    <span class="n">a_2_A22</span> <span class="o">=</span> <span class="mf">1.5971</span>
    <span class="n">b_1_A22</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.741</span>
    <span class="n">b_2_A22</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.0887</span>
    <span class="n">b_3_A22</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.094</span>
    <span class="n">c_11_A22</span> <span class="o">=</span> <span class="mf">0.4446696</span>
    <span class="n">c_12_A22</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.3254310</span>
    <span class="n">c_31_A22</span> <span class="o">=</span> <span class="mf">0.4582812</span>
    <span class="n">c_32_A22</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.2124477</span>

    <span class="c1"># (2;1) - TEOBResumSFits.c; line 2375-2389</span>
    <span class="n">A21_0</span> <span class="o">=</span> <span class="mf">0.5238781992</span>  <span class="c1"># TEOBResumSFits.c; line 1992</span>
    <span class="n">a_1_A21</span> <span class="o">=</span> <span class="mf">3.3362232268</span>
    <span class="n">a_2_A21</span> <span class="o">=</span> <span class="mf">3.4708521429</span>
    <span class="n">a_3_A21</span> <span class="o">=</span> <span class="mf">4.7623643259</span>
    <span class="n">b_1_A21</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.4281863</span>
    <span class="n">b_2_A21</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.335659</span>
    <span class="n">b_3_A21</span> <span class="o">=</span> <span class="mf">0.828923</span>
    <span class="n">c_11_A21</span> <span class="o">=</span> <span class="mf">0.891139</span>
    <span class="n">c_12_A21</span> <span class="o">=</span> <span class="o">-</span><span class="mf">5.191702</span>
    <span class="n">c_21_A21</span> <span class="o">=</span> <span class="mf">3.480139</span>
    <span class="n">c_22_A21</span> <span class="o">=</span> <span class="mf">10.237782</span>
    <span class="n">c_31_A21</span> <span class="o">=</span> <span class="o">-</span><span class="mf">13.867475</span>
    <span class="n">c_32_A21</span> <span class="o">=</span> <span class="mf">10.525510</span>

    <span class="c1"># (3,3) - TEOBResumSFits.c, line 2458-2468</span>
    <span class="n">A33_0</span> <span class="o">=</span> <span class="mf">0.5660165890</span>  <span class="c1"># TEOBResumSFits.c, line 1996</span>
    <span class="n">a_1_A33</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.22523</span>
    <span class="n">a_2_A33</span> <span class="o">=</span> <span class="mf">3.0569</span>
    <span class="n">a_3_A33</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.396851</span>
    <span class="n">b_1_A33</span> <span class="o">=</span> <span class="mf">0.100069</span>
    <span class="n">b_2_A33</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.455859</span>
    <span class="n">c_11_A33</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.401156</span>
    <span class="n">c_12_A33</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.141551</span>
    <span class="n">c_13_A33</span> <span class="o">=</span> <span class="o">-</span><span class="mf">15.4949</span>
    <span class="n">c_21_A33</span> <span class="o">=</span> <span class="mf">1.84962</span>
    <span class="n">c_22_A33</span> <span class="o">=</span> <span class="o">-</span><span class="mf">2.03512</span>
    <span class="n">c_23_A33</span> <span class="o">=</span> <span class="o">-</span><span class="mf">4.92334</span>

    <span class="c1"># (3;2) - TEOBResumSFits.c; line 2435-2447</span>
    <span class="n">A32_0</span> <span class="o">=</span> <span class="mf">0.1990192432</span>  <span class="c1"># TEOBResumSFits.c; line 1995</span>
    <span class="n">a_1_A32</span> <span class="o">=</span> <span class="o">-</span><span class="mf">6.06831</span>
    <span class="n">a_2_A32</span> <span class="o">=</span> <span class="mf">10.7505</span>
    <span class="n">a_3_A32</span> <span class="o">=</span> <span class="o">-</span><span class="mf">3.68883</span>
    <span class="n">b_1_A32</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.258378</span>
    <span class="n">b_2_A32</span> <span class="o">=</span> <span class="mf">0.679163</span>
    <span class="n">c_11_A32</span> <span class="o">=</span> <span class="mf">4.36263</span>
    <span class="n">c_12_A32</span> <span class="o">=</span> <span class="o">-</span><span class="mf">12.5897</span>
    <span class="n">c_13_A32</span> <span class="o">=</span> <span class="o">-</span><span class="mf">7.73233</span>
    <span class="n">c_14_A32</span> <span class="o">=</span> <span class="mf">16.2082</span>
    <span class="n">c_21_A32</span> <span class="o">=</span> <span class="mf">3.04724</span>
    <span class="n">c_22_A32</span> <span class="o">=</span> <span class="mf">46.5711</span>
    <span class="n">c_23_A32</span> <span class="o">=</span> <span class="mf">2.10475</span>
    <span class="n">c_24_A32</span> <span class="o">=</span> <span class="mf">56.9136</span>

    <span class="c1"># (3,1) - TEOBResumSFits.c, line 2690</span>
    <span class="n">A31_0</span> <span class="o">=</span> <span class="mf">0.0623783</span>  <span class="c1"># TEOBResumSFits.c, line 1994</span>
    <span class="n">n_1_A31</span> <span class="o">=</span> <span class="o">-</span><span class="mf">5.49</span>
    <span class="n">n_2_A31</span> <span class="o">=</span> <span class="mf">10.915</span>

    <span class="c1"># (4,4) - TEOBResumSFits.c, line 2536-2553</span>
    <span class="n">A44_0</span> <span class="o">=</span> <span class="mf">0.2766182761</span>  <span class="c1"># TEOBResumSFits.c, line 2000</span>
    <span class="n">a_1_A44</span> <span class="o">=</span> <span class="o">-</span><span class="mf">3.7082</span>
    <span class="n">a_2_A44</span> <span class="o">=</span> <span class="mf">0.280906</span>
    <span class="n">a_3_A44</span> <span class="o">=</span> <span class="o">-</span><span class="mf">3.71276</span>
    <span class="n">b_1_A44</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.316647</span>
    <span class="n">b_2_A44</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.062423</span>
    <span class="n">b_3_A44</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.852876</span>
    <span class="n">c_11_A44</span> <span class="o">=</span> <span class="mf">1.2436</span>
    <span class="n">c_12_A44</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.60555</span>
    <span class="n">c_13_A44</span> <span class="o">=</span> <span class="o">-</span><span class="mf">4.05685</span>
    <span class="n">c_14_A44</span> <span class="o">=</span> <span class="mf">1.59143</span>
    <span class="n">c_21_A44</span> <span class="o">=</span> <span class="mf">0.837418</span>
    <span class="n">c_22_A44</span> <span class="o">=</span> <span class="o">-</span><span class="mf">2.93528</span>
    <span class="n">c_23_A44</span> <span class="o">=</span> <span class="o">-</span><span class="mf">11.5591</span>
    <span class="n">c_24_A44</span> <span class="o">=</span> <span class="mf">34.1863</span>
    <span class="n">c_31_A44</span> <span class="o">=</span> <span class="mf">0.950035</span>
    <span class="n">c_32_A44</span> <span class="o">=</span> <span class="mf">7.95168</span>
    <span class="n">c_33_A44</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.26899</span>
    <span class="n">c_34_A44</span> <span class="o">=</span> <span class="o">-</span><span class="mf">9.72147</span>

    <span class="c1"># (4,3) - TEOBResumSFits.c, line 2510-2531</span>
    <span class="n">A43_0</span> <span class="o">=</span> <span class="mf">0.0941569508</span>  <span class="c1"># TEOBResumSFits.c, line 1999</span>
    <span class="n">a_1_A43</span> <span class="o">=</span> <span class="o">-</span><span class="mf">5.74386</span>
    <span class="n">a_2_A43</span> <span class="o">=</span> <span class="mf">12.6016</span>
    <span class="n">a_3_A43</span> <span class="o">=</span> <span class="o">-</span><span class="mf">3.27435</span>
    <span class="n">b_1_A43</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.02132252</span>
    <span class="n">b_2_A43</span> <span class="o">=</span> <span class="mf">0.02592749</span>
    <span class="n">b_3_A43</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.826977</span>
    <span class="n">b_1_A43_nu</span> <span class="o">=</span> <span class="mf">0.00452129</span>
    <span class="n">b_2_A43_nu</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.00471163</span>
    <span class="n">b_3_A43_nu</span> <span class="o">=</span> <span class="mf">0.0291409</span>
    <span class="n">b_4_A43_nu</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.351031</span>
    <span class="n">c_11_A43</span> <span class="o">=</span> <span class="mf">0.249099</span>
    <span class="n">c_12_A43</span> <span class="o">=</span> <span class="o">-</span><span class="mf">7.345984</span>
    <span class="n">c_13_A43</span> <span class="o">=</span> <span class="mf">108.923746</span>
    <span class="n">c_21_A43</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.104206</span>
    <span class="n">c_22_A43</span> <span class="o">=</span> <span class="mf">7.073534</span>
    <span class="n">c_23_A43</span> <span class="o">=</span> <span class="o">-</span><span class="mf">44.374738</span>
    <span class="n">c_31_A43</span> <span class="o">=</span> <span class="mf">3.545134</span>
    <span class="n">c_32_A43</span> <span class="o">=</span> <span class="mf">1.341375</span>
    <span class="n">c_33_A43</span> <span class="o">=</span> <span class="o">-</span><span class="mf">19.552083</span>

    <span class="c1"># (4;2) - TEOBResumSFits.c; line 2483-2498</span>
    <span class="n">A42_0</span> <span class="o">=</span> <span class="mf">0.0314363901</span>  <span class="c1"># TEOBResumSFits.c; line 1998</span>
    <span class="n">a_1_A42</span> <span class="o">=</span> <span class="o">-</span><span class="mf">4.56243</span>
    <span class="n">a_2_A42</span> <span class="o">=</span> <span class="mf">6.4522</span>
    <span class="n">b_1_A42</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.63682</span>
    <span class="n">b_2_A42</span> <span class="o">=</span> <span class="mf">0.854459</span>
    <span class="n">b_3_A42</span> <span class="o">=</span> <span class="mf">0.120537</span>
    <span class="n">b_4_A42</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.399718</span>
    <span class="n">c_11_A42</span> <span class="o">=</span> <span class="mf">6.53943</span>
    <span class="n">c_12_A42</span> <span class="o">=</span> <span class="o">-</span><span class="mf">4.00073</span>
    <span class="n">c_21_A42</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.638688</span>
    <span class="n">c_22_A42</span> <span class="o">=</span> <span class="o">-</span><span class="mf">3.94066</span>
    <span class="n">c_31_A42</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.482148</span>
    <span class="n">c_32_A42</span> <span class="o">=</span> <span class="o">-</span><span class="mf">3.9999999923319502</span>
    <span class="n">c_41_A42</span> <span class="o">=</span> <span class="mf">1.25617</span>
    <span class="n">c_42_A42</span> <span class="o">=</span> <span class="o">-</span><span class="mf">4.04848</span>

    <span class="c1"># (4;1) - TEOBResumSFits.c; line 2695</span>
    <span class="n">A41_0</span> <span class="o">=</span> <span class="mf">0.00925061</span>  <span class="c1"># TEOBResumSFits.c; line 1997</span>
    <span class="n">n_1_A41</span> <span class="o">=</span> <span class="o">-</span><span class="mf">8.4449</span>
    <span class="n">n_2_A41</span> <span class="o">=</span> <span class="mf">26.825</span>
    <span class="n">d_1_A41</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.2565</span>

    <span class="c1"># (5;5) - TEOBResumSFits.c; line 2565-2572</span>
    <span class="n">A55_0</span> <span class="o">=</span> <span class="mf">0.151492</span>  <span class="c1"># TEOBResumSFits.c; line 2001</span>
    <span class="n">a_1_A55</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.9750925916632546</span>
    <span class="n">a_2_A55</span> <span class="o">=</span> <span class="mf">11.2008774621215608</span>
    <span class="n">b_1_A55</span> <span class="o">=</span> <span class="mf">0.04360530</span>
    <span class="n">b_2_A55</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.5769451</span>
    <span class="n">c_11_A55</span> <span class="o">=</span> <span class="mf">5.720690</span>
    <span class="n">c_12_A55</span> <span class="o">=</span> <span class="mf">44.868515</span>
    <span class="n">c_21_A55</span> <span class="o">=</span> <span class="mf">12.777090</span>
    <span class="n">c_22_A55</span> <span class="o">=</span> <span class="o">-</span><span class="mf">42.548247</span>
    <span class="c1"># ------------------------------------------------------------------------------------------------------------------------------------------------ #</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">l</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">m</span> <span class="o">==</span> <span class="mi">2</span><span class="p">):</span>  <span class="c1"># eqs. C17-C20 of arXiv:2001.09082v2</span>

        <span class="n">b1_A</span> <span class="o">=</span> <span class="p">(</span><span class="n">b_1_A22</span> <span class="o">+</span> <span class="n">c_11_A22</span> <span class="o">*</span> <span class="n">X12</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">c_12_A22</span> <span class="o">*</span> <span class="n">X12</span><span class="p">)</span>
        <span class="n">b2_A</span> <span class="o">=</span> <span class="n">b_2_A22</span>
        <span class="n">b3_A</span> <span class="o">=</span> <span class="p">(</span><span class="n">b_3_A22</span> <span class="o">+</span> <span class="n">c_31_A22</span> <span class="o">*</span> <span class="n">X12</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">c_32_A22</span> <span class="o">*</span> <span class="n">X12</span><span class="p">)</span>

        <span class="n">A22_orb</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">a_1_A22</span> <span class="o">*</span> <span class="n">nu</span> <span class="o">+</span> <span class="n">a_2_A22</span> <span class="o">*</span> <span class="n">nu2</span>
        <span class="n">num_spin</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">b1_A</span> <span class="o">*</span> <span class="n">S_hat</span> <span class="o">+</span> <span class="n">b2_A</span> <span class="o">*</span> <span class="n">S_hat2</span>
        <span class="n">den_spin</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">b3_A</span> <span class="o">*</span> <span class="n">S_hat</span>

        <span class="n">A22_spin</span> <span class="o">=</span> <span class="n">num_spin</span> <span class="o">/</span> <span class="n">den_spin</span>

        <span class="n">res</span> <span class="o">=</span> <span class="n">A22_0</span> <span class="o">*</span> <span class="n">A22_orb</span> <span class="o">*</span> <span class="n">A22_spin</span>

        <span class="n">scale</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">S_hat</span> <span class="o">*</span> <span class="n">omega_peak</span>  <span class="c1"># eq. C6 of arXiv:2001.09082v2</span>
        <span class="n">res</span> <span class="o">=</span> <span class="n">res</span> <span class="o">*</span> <span class="n">scale</span>

    <span class="k">elif</span> <span class="p">(</span><span class="n">l</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">m</span> <span class="o">==</span> <span class="mi">1</span><span class="p">):</span>  <span class="c1"># eqs. C21-C24 of arXiv:2001.09082v2</span>

        <span class="n">b1_A</span> <span class="o">=</span> <span class="n">b_1_A21</span> <span class="o">+</span> <span class="n">c_11_A21</span> <span class="o">*</span> <span class="n">nu</span> <span class="o">+</span> <span class="n">c_12_A21</span> <span class="o">*</span> <span class="n">nu2</span>
        <span class="n">b2_A</span> <span class="o">=</span> <span class="n">b_2_A21</span> <span class="o">+</span> <span class="n">c_21_A21</span> <span class="o">*</span> <span class="n">nu</span> <span class="o">+</span> <span class="n">c_22_A21</span> <span class="o">*</span> <span class="n">nu2</span>
        <span class="n">b3_A</span> <span class="o">=</span> <span class="n">b_3_A21</span> <span class="o">+</span> <span class="n">c_31_A21</span> <span class="o">*</span> <span class="n">nu</span> <span class="o">+</span> <span class="n">c_32_A21</span> <span class="o">*</span> <span class="n">nu2</span>

        <span class="n">num_orb</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">a_1_A21</span> <span class="o">*</span> <span class="n">nu</span> <span class="o">+</span> <span class="n">a_2_A21</span> <span class="o">*</span> <span class="n">nu2</span>
        <span class="n">den_orb</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">a_3_A21</span> <span class="o">*</span> <span class="n">nu</span>

        <span class="k">if</span> <span class="n">nu</span> <span class="o">==</span> <span class="mf">0.25</span><span class="p">:</span>  <span class="c1"># TEOBResumSFits.c, line 2382</span>
            <span class="n">num_spin</span> <span class="o">=</span> <span class="n">b1_A</span> <span class="o">*</span> <span class="n">S_bar_21</span> <span class="o">+</span> <span class="n">b2_A</span> <span class="o">*</span> <span class="n">S_bar_21</span> <span class="o">*</span> <span class="n">S_bar_21</span>
            <span class="n">den_spin</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">b3_A</span> <span class="o">*</span> <span class="n">S_bar_21</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">num_spin</span> <span class="o">=</span> <span class="n">b1_A</span> <span class="o">*</span> <span class="n">S_bar</span> <span class="o">+</span> <span class="n">b2_A</span> <span class="o">*</span> <span class="n">S_bar2</span>
            <span class="n">den_spin</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">b3_A</span> <span class="o">*</span> <span class="n">S_bar</span>

        <span class="n">A21_orb</span> <span class="o">=</span> <span class="n">num_orb</span> <span class="o">/</span> <span class="n">den_orb</span>
        <span class="n">A21_spin</span> <span class="o">=</span> <span class="n">num_spin</span> <span class="o">/</span> <span class="n">den_spin</span>

        <span class="n">res</span> <span class="o">=</span> <span class="n">A21_0</span> <span class="o">*</span> <span class="n">X12</span> <span class="o">*</span> <span class="n">A21_orb</span> <span class="o">+</span> <span class="n">A21_spin</span>

    <span class="k">elif</span> <span class="p">(</span><span class="n">l</span> <span class="o">==</span> <span class="mi">3</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">m</span> <span class="o">==</span> <span class="mi">3</span><span class="p">):</span>  <span class="c1"># eqs. C33-C37 of arXiv:2001.09082v2</span>

        <span class="n">b1_A</span> <span class="o">=</span> <span class="p">(</span><span class="n">b_1_A33</span> <span class="o">+</span> <span class="n">c_11_A33</span> <span class="o">*</span> <span class="n">nu</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">c_12_A33</span> <span class="o">*</span> <span class="n">nu</span> <span class="o">+</span> <span class="n">c_13_A33</span> <span class="o">*</span> <span class="n">nu2</span><span class="p">)</span>
        <span class="n">b2_A</span> <span class="o">=</span> <span class="p">(</span><span class="n">b_2_A33</span> <span class="o">+</span> <span class="n">c_21_A33</span> <span class="o">*</span> <span class="n">nu</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">c_22_A33</span> <span class="o">*</span> <span class="n">nu</span> <span class="o">+</span> <span class="n">c_23_A33</span> <span class="o">*</span> <span class="n">nu2</span><span class="p">)</span>

        <span class="n">num_orb</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">a_1_A33</span> <span class="o">*</span> <span class="n">nu</span> <span class="o">+</span> <span class="n">a_2_A33</span> <span class="o">*</span> <span class="n">nu2</span>
        <span class="n">den_orb</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">a_3_A33</span> <span class="o">*</span> <span class="n">nu</span>

        <span class="k">if</span> <span class="n">nu</span> <span class="o">==</span> <span class="mf">0.25</span><span class="p">:</span>  <span class="c1"># TEOBResumSFits.c, line 2472</span>
            <span class="n">num_spin</span> <span class="o">=</span> <span class="n">b1_A</span> <span class="o">*</span> <span class="n">a12_33</span>
            <span class="n">den_spin</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">b2_A</span> <span class="o">*</span> <span class="n">a12_33</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">num_spin</span> <span class="o">=</span> <span class="n">b1_A</span> <span class="o">*</span> <span class="n">a12</span>
            <span class="n">den_spin</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">b2_A</span> <span class="o">*</span> <span class="n">a12</span>

        <span class="n">A33_orb</span> <span class="o">=</span> <span class="n">num_orb</span> <span class="o">/</span> <span class="n">den_orb</span>
        <span class="n">A33_spin</span> <span class="o">=</span> <span class="n">num_spin</span> <span class="o">/</span> <span class="n">den_spin</span>

        <span class="n">res</span> <span class="o">=</span> <span class="n">A33_0</span> <span class="o">*</span> <span class="n">X12</span> <span class="o">*</span> <span class="n">A33_orb</span> <span class="o">+</span> <span class="n">A33_spin</span>

    <span class="k">elif</span> <span class="p">(</span><span class="n">l</span> <span class="o">==</span> <span class="mi">3</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">m</span> <span class="o">==</span> <span class="mi">2</span><span class="p">):</span>  <span class="c1"># eqs. C46-C49 of arXiv:2001.09082v2</span>

        <span class="n">b1_A</span> <span class="o">=</span> <span class="p">(</span><span class="n">b_1_A32</span> <span class="o">+</span> <span class="n">c_11_A32</span> <span class="o">*</span> <span class="n">nu</span> <span class="o">+</span> <span class="n">c_12_A32</span> <span class="o">*</span> <span class="n">nu2</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span>
            <span class="mi">1</span> <span class="o">+</span> <span class="n">c_13_A32</span> <span class="o">*</span> <span class="n">nu</span> <span class="o">+</span> <span class="n">c_14_A32</span> <span class="o">*</span> <span class="n">nu2</span>
        <span class="p">)</span>
        <span class="n">b2_A</span> <span class="o">=</span> <span class="p">(</span><span class="n">b_2_A32</span> <span class="o">+</span> <span class="n">c_21_A32</span> <span class="o">*</span> <span class="n">nu</span> <span class="o">+</span> <span class="n">c_22_A32</span> <span class="o">*</span> <span class="n">nu2</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span>
            <span class="mi">1</span> <span class="o">+</span> <span class="n">c_23_A32</span> <span class="o">*</span> <span class="n">nu</span> <span class="o">+</span> <span class="n">c_24_A32</span> <span class="o">*</span> <span class="n">nu2</span>
        <span class="p">)</span>

        <span class="n">num_orb</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">a_1_A32</span> <span class="o">*</span> <span class="n">nu</span> <span class="o">+</span> <span class="n">a_2_A32</span> <span class="o">*</span> <span class="n">nu2</span>
        <span class="n">den_orb</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">a_3_A32</span> <span class="o">*</span> <span class="n">nu</span>
        <span class="n">num_spin</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">b1_A</span> <span class="o">*</span> <span class="n">a0</span>
        <span class="n">den_spin</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">b2_A</span> <span class="o">*</span> <span class="n">a0</span>

        <span class="n">A32_orb</span> <span class="o">=</span> <span class="n">num_orb</span> <span class="o">/</span> <span class="n">den_orb</span>
        <span class="n">A32_spin</span> <span class="o">=</span> <span class="n">num_spin</span> <span class="o">/</span> <span class="n">den_spin</span>

        <span class="n">res</span> <span class="o">=</span> <span class="n">A32_0</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">nu</span><span class="p">)</span> <span class="o">*</span> <span class="n">A32_orb</span> <span class="o">*</span> <span class="n">A32_spin</span>

        <span class="n">scale</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">a0</span> <span class="o">*</span> <span class="p">(</span><span class="n">omega_peak</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">**</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">/</span> <span class="mi">3</span><span class="p">)</span>  <span class="c1"># TEOBResumSFits.c, line 2451</span>
        <span class="n">res</span> <span class="o">=</span> <span class="n">res</span> <span class="o">*</span> <span class="n">scale</span>

    <span class="k">elif</span> <span class="p">(</span><span class="n">l</span> <span class="o">==</span> <span class="mi">3</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">m</span> <span class="o">==</span> <span class="mi">1</span><span class="p">):</span>  <span class="c1"># eq. 5.19 of arXiv:1904.09550v2</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        if (nu==0.25):    # TEOBResumSFits.c, line 2685</span>
<span class="sd">            res = 0.</span>

<span class="sd">        else:</span>
<span class="sd">            A31_orb = 1 + n_1_A31*nu + n_2_A31*nu2</span>

<span class="sd">            res = A31_0 * X12 * A31_orb&quot;&quot;&quot;</span>

        <span class="n">res</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># not implemented in TEOBResumSFits.c, line 2452</span>

    <span class="k">elif</span> <span class="p">(</span><span class="n">l</span> <span class="o">==</span> <span class="mi">4</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">m</span> <span class="o">==</span> <span class="mi">4</span><span class="p">):</span>  <span class="c1"># eqs. C61-C64 of arXiv:2001.09082v2</span>

        <span class="n">b1_A</span> <span class="o">=</span> <span class="p">(</span><span class="n">b_1_A44</span> <span class="o">+</span> <span class="n">c_11_A44</span> <span class="o">*</span> <span class="n">nu</span> <span class="o">+</span> <span class="n">c_12_A44</span> <span class="o">*</span> <span class="n">nu2</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span>
            <span class="mi">1</span> <span class="o">+</span> <span class="n">c_13_A44</span> <span class="o">*</span> <span class="n">nu</span> <span class="o">+</span> <span class="n">c_14_A44</span> <span class="o">*</span> <span class="n">nu2</span>
        <span class="p">)</span>
        <span class="n">b2_A</span> <span class="o">=</span> <span class="p">(</span><span class="n">b_2_A44</span> <span class="o">+</span> <span class="n">c_21_A44</span> <span class="o">*</span> <span class="n">nu</span> <span class="o">+</span> <span class="n">c_22_A44</span> <span class="o">*</span> <span class="n">nu2</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span>
            <span class="mi">1</span> <span class="o">+</span> <span class="n">c_23_A44</span> <span class="o">*</span> <span class="n">nu</span> <span class="o">+</span> <span class="n">c_24_A44</span> <span class="o">*</span> <span class="n">nu2</span>
        <span class="p">)</span>
        <span class="n">b3_A</span> <span class="o">=</span> <span class="p">(</span><span class="n">b_3_A44</span> <span class="o">+</span> <span class="n">c_31_A44</span> <span class="o">*</span> <span class="n">nu</span> <span class="o">+</span> <span class="n">c_32_A44</span> <span class="o">*</span> <span class="n">nu2</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span>
            <span class="mi">1</span> <span class="o">+</span> <span class="n">c_33_A44</span> <span class="o">*</span> <span class="n">nu</span> <span class="o">+</span> <span class="n">c_34_A44</span> <span class="o">*</span> <span class="n">nu2</span>
        <span class="p">)</span>

        <span class="n">num_orb</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">a_1_A44</span> <span class="o">*</span> <span class="n">nu</span> <span class="o">+</span> <span class="n">a_2_A44</span> <span class="o">*</span> <span class="n">nu2</span>
        <span class="n">den_orb</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">a_3_A44</span> <span class="o">*</span> <span class="n">nu</span>
        <span class="n">num_spin</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">b1_A</span> <span class="o">*</span> <span class="n">S_hat</span> <span class="o">+</span> <span class="n">b2_A</span> <span class="o">*</span> <span class="n">S_hat2</span>
        <span class="n">den_spin</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">b3_A</span> <span class="o">*</span> <span class="n">S_hat</span>

        <span class="n">A44_orb</span> <span class="o">=</span> <span class="n">num_orb</span> <span class="o">/</span> <span class="n">den_orb</span>
        <span class="n">A44_spin</span> <span class="o">=</span> <span class="n">num_spin</span> <span class="o">/</span> <span class="n">den_spin</span>

        <span class="n">res</span> <span class="o">=</span> <span class="n">A44_0</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">nu</span><span class="p">)</span> <span class="o">*</span> <span class="n">A44_orb</span> <span class="o">*</span> <span class="n">A44_spin</span>

        <span class="n">scale</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">S_hat</span> <span class="o">*</span> <span class="n">omega_peak</span>  <span class="c1"># eq. C10 of arXiv:2001.09082v2</span>
        <span class="n">res</span> <span class="o">=</span> <span class="n">res</span> <span class="o">*</span> <span class="n">scale</span>

    <span class="k">elif</span> <span class="p">(</span><span class="n">l</span> <span class="o">==</span> <span class="mi">4</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">m</span> <span class="o">==</span> <span class="mi">3</span><span class="p">):</span>  <span class="c1"># eqs. C73-C77 of arXiv:2001.09082v2</span>

        <span class="k">if</span> <span class="n">nu</span> <span class="o">==</span> <span class="mf">0.25</span><span class="p">:</span>  <span class="c1"># TEOBResumSFits.c, line 2515</span>
            <span class="n">num_peak</span> <span class="o">=</span> <span class="n">b_1_A43_nu</span> <span class="o">+</span> <span class="n">b_2_A43_nu</span> <span class="o">*</span> <span class="n">a12</span> <span class="o">+</span> <span class="n">b_3_A43_nu</span> <span class="o">*</span> <span class="n">a12_2</span>
            <span class="n">den_peak</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">b_4_A43_nu</span> <span class="o">*</span> <span class="n">a12</span>
            <span class="n">A43_peak</span> <span class="o">=</span> <span class="n">num_peak</span> <span class="o">/</span> <span class="n">den_peak</span>

            <span class="n">res</span> <span class="o">=</span> <span class="n">A43_peak</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">b1_A</span> <span class="o">=</span> <span class="p">(</span><span class="n">b_1_A43</span> <span class="o">+</span> <span class="n">c_11_A43</span> <span class="o">*</span> <span class="n">nu</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">c_12_A43</span> <span class="o">*</span> <span class="n">nu</span> <span class="o">+</span> <span class="n">c_13_A43</span> <span class="o">*</span> <span class="n">nu2</span><span class="p">)</span>
            <span class="n">b2_A</span> <span class="o">=</span> <span class="p">(</span><span class="n">b_2_A43</span> <span class="o">+</span> <span class="n">c_21_A43</span> <span class="o">*</span> <span class="n">nu</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">c_22_A43</span> <span class="o">*</span> <span class="n">nu</span> <span class="o">+</span> <span class="n">c_23_A43</span> <span class="o">*</span> <span class="n">nu2</span><span class="p">)</span>
            <span class="n">b3_A</span> <span class="o">=</span> <span class="p">(</span><span class="n">b_3_A43</span> <span class="o">+</span> <span class="n">c_31_A43</span> <span class="o">*</span> <span class="n">nu</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">c_32_A43</span> <span class="o">*</span> <span class="n">nu</span> <span class="o">+</span> <span class="n">c_33_A43</span> <span class="o">*</span> <span class="n">nu2</span><span class="p">)</span>

            <span class="n">num_orb</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">a_1_A43</span> <span class="o">*</span> <span class="n">nu</span> <span class="o">+</span> <span class="n">a_2_A43</span> <span class="o">*</span> <span class="n">nu2</span>
            <span class="n">den_orb</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">a_3_A43</span> <span class="o">*</span> <span class="n">nu</span>
            <span class="n">num_spin</span> <span class="o">=</span> <span class="n">b1_A</span> <span class="o">*</span> <span class="n">a0</span> <span class="o">+</span> <span class="n">b2_A</span> <span class="o">*</span> <span class="n">a0_2</span>
            <span class="n">den_spin</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">b3_A</span> <span class="o">*</span> <span class="n">a0</span>

            <span class="n">A43_orb</span> <span class="o">=</span> <span class="n">num_orb</span> <span class="o">/</span> <span class="n">den_orb</span>
            <span class="n">A43_spin</span> <span class="o">=</span> <span class="n">num_spin</span> <span class="o">/</span> <span class="n">den_spin</span>

            <span class="n">res</span> <span class="o">=</span> <span class="n">A43_0</span> <span class="o">*</span> <span class="n">X12</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">nu</span><span class="p">)</span> <span class="o">*</span> <span class="n">A43_orb</span> <span class="o">+</span> <span class="n">A43_spin</span>

    <span class="k">elif</span> <span class="p">(</span><span class="n">l</span> <span class="o">==</span> <span class="mi">4</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">m</span> <span class="o">==</span> <span class="mi">2</span><span class="p">):</span>  <span class="c1"># eqs. C86-C89 of arXiv:2001.09082v2</span>

        <span class="n">b1_A</span> <span class="o">=</span> <span class="p">(</span><span class="n">b_1_A42</span> <span class="o">+</span> <span class="n">c_11_A42</span> <span class="o">*</span> <span class="n">nu</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">c_12_A42</span> <span class="o">*</span> <span class="n">nu</span><span class="p">)</span>
        <span class="n">b2_A</span> <span class="o">=</span> <span class="p">(</span><span class="n">b_2_A42</span> <span class="o">+</span> <span class="n">c_21_A42</span> <span class="o">*</span> <span class="n">nu</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">c_22_A42</span> <span class="o">*</span> <span class="n">nu</span><span class="p">)</span>
        <span class="n">b3_A</span> <span class="o">=</span> <span class="p">(</span><span class="n">b_3_A42</span> <span class="o">+</span> <span class="n">c_31_A42</span> <span class="o">*</span> <span class="n">nu</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">c_32_A42</span> <span class="o">*</span> <span class="n">nu</span><span class="p">)</span>
        <span class="n">b4_A</span> <span class="o">=</span> <span class="p">(</span><span class="n">b_4_A42</span> <span class="o">+</span> <span class="n">c_41_A42</span> <span class="o">*</span> <span class="n">nu</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">c_42_A42</span> <span class="o">*</span> <span class="n">nu</span><span class="p">)</span>

        <span class="n">A42_orb</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">a_1_A42</span> <span class="o">*</span> <span class="n">nu</span> <span class="o">+</span> <span class="n">a_2_A42</span> <span class="o">*</span> <span class="n">nu2</span>
        <span class="n">num_spin</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">b1_A</span> <span class="o">*</span> <span class="n">S_hat</span> <span class="o">+</span> <span class="n">b2_A</span> <span class="o">*</span> <span class="n">S_hat2</span>
        <span class="n">den_spin</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">b3_A</span> <span class="o">*</span> <span class="n">S_hat</span> <span class="o">+</span> <span class="n">b4_A</span> <span class="o">*</span> <span class="n">S_hat2</span>

        <span class="n">A42_spin</span> <span class="o">=</span> <span class="n">num_spin</span> <span class="o">/</span> <span class="n">den_spin</span>

        <span class="n">res</span> <span class="o">=</span> <span class="n">A42_0</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">nu</span><span class="p">)</span> <span class="o">*</span> <span class="n">A42_orb</span> <span class="o">*</span> <span class="n">A42_spin</span>

        <span class="n">scale</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">a0</span> <span class="o">*</span> <span class="p">(</span><span class="n">omega_peak</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span> <span class="o">**</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">/</span> <span class="mi">3</span><span class="p">)</span>  <span class="c1"># TEOBResumSFits.c, line 2506</span>
        <span class="n">res</span> <span class="o">=</span> <span class="n">res</span> <span class="o">*</span> <span class="n">scale</span>

    <span class="k">elif</span> <span class="p">(</span><span class="n">l</span> <span class="o">==</span> <span class="mi">4</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">m</span> <span class="o">==</span> <span class="mi">1</span><span class="p">):</span>  <span class="c1"># eq. 5.19 of arXiv:1904.09550v2</span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot;num_orb = 1 + n_1_A41*nu + n_2_A41*nu2</span>
<span class="sd">        den_orb = 1 + d_1_A41*nu</span>

<span class="sd">        A41_orb = num_orb/den_orb</span>

<span class="sd">        res = A41_0 * A41_orb&quot;&quot;&quot;</span>

        <span class="n">res</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># TEOBResumSFits.c, line 2695</span>

    <span class="k">elif</span> <span class="p">(</span><span class="n">l</span> <span class="o">==</span> <span class="mi">5</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">m</span> <span class="o">==</span> <span class="mi">5</span><span class="p">):</span>  <span class="c1"># eqs. C98-C102 of arXiv:2001.09082v2</span>

        <span class="n">b1_A</span> <span class="o">=</span> <span class="n">b_1_A55</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">c_11_A55</span> <span class="o">*</span> <span class="n">nu</span> <span class="o">+</span> <span class="n">c_12_A55</span> <span class="o">*</span> <span class="n">nu2</span><span class="p">)</span>
        <span class="n">b2_A</span> <span class="o">=</span> <span class="n">b_2_A55</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">c_21_A55</span> <span class="o">*</span> <span class="n">nu</span> <span class="o">+</span> <span class="n">c_22_A55</span> <span class="o">*</span> <span class="n">nu2</span><span class="p">)</span>

        <span class="n">A55_orb</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">a_1_A55</span> <span class="o">*</span> <span class="n">nu</span> <span class="o">+</span> <span class="n">a_2_A55</span> <span class="o">*</span> <span class="n">nu2</span>
        <span class="n">num_spin</span> <span class="o">=</span> <span class="n">b1_A</span> <span class="o">*</span> <span class="n">a12</span>
        <span class="n">den_spin</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">b2_A</span> <span class="o">*</span> <span class="n">a12</span>

        <span class="n">A55_spin</span> <span class="o">=</span> <span class="n">num_spin</span> <span class="o">/</span> <span class="n">den_spin</span>

        <span class="n">res</span> <span class="o">=</span> <span class="n">A55_0</span> <span class="o">*</span> <span class="n">X12</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">nu</span><span class="p">)</span> <span class="o">*</span> <span class="n">A55_orb</span> <span class="o">+</span> <span class="n">A55_spin</span>

    <span class="k">return</span> <span class="n">res</span></div>



<div class="viewcode-block" id="_omega_peak">
<a class="viewcode-back" href="../../../autoapi/PyART/models/ringdown_fits/index.html#PyART.models.ringdown_fits._omega_peak">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">_omega_peak</span><span class="p">(</span><span class="n">nu</span><span class="p">,</span> <span class="n">X12</span><span class="p">,</span> <span class="n">S_hat</span><span class="p">,</span> <span class="n">a0</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">m</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Function returning the value of Omega at the peak of the strain, following appendix C.2 of arXiv:2001.09082v2.</span>
<span class="sd">    It is called in function EOBPM_SetupFitCoefficients of waveform.pyx.</span>
<span class="sd">    -----------------------------------------------------------------------------------</span>
<span class="sd">    The fitting coefficients and equations are implemented from:</span>
<span class="sd">    (2,2) (2,1) (3,3) (3,2) (4,4) (4,3) (4,2) (5,5) - arXiv:2001.09082v2, appendix C.3</span>
<span class="sd">    (3,1) (4,1) - arXiv:1904.09550v2, section V.D</span>
<span class="sd">    -----------------------------------------------------------------------------------</span>
<span class="sd">    Note that paper arXiv:1904.09550v2 refers to the non-spinning case, while arXiv:2001.09082v2 includes spin effects.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">res</span> <span class="o">=</span> <span class="mf">0.0</span>
    <span class="n">nu2</span> <span class="o">=</span> <span class="n">nu</span> <span class="o">*</span> <span class="n">nu</span>
    <span class="n">X12_2</span> <span class="o">=</span> <span class="n">X12</span> <span class="o">*</span> <span class="n">X12</span>
    <span class="n">S_hat2</span> <span class="o">=</span> <span class="n">S_hat</span> <span class="o">*</span> <span class="n">S_hat</span>
    <span class="n">S_hat3</span> <span class="o">=</span> <span class="n">S_hat2</span> <span class="o">*</span> <span class="n">S_hat</span>
    <span class="n">a0_2</span> <span class="o">=</span> <span class="n">a0</span> <span class="o">*</span> <span class="n">a0</span>

    <span class="c1"># ------------------------------------------------------------------------------------------------------------------------------------------------ #</span>
    <span class="c1"># (2,2) - TEOBResumSFits.c, line 2226-2236</span>
    <span class="n">omg22_0</span> <span class="o">=</span> <span class="mf">0.273356</span>  <span class="c1"># TEOBResumSFits.c, line 2003</span>
    <span class="n">a_1_omg22</span> <span class="o">=</span> <span class="mf">0.84074</span>
    <span class="n">a_2_omg22</span> <span class="o">=</span> <span class="mf">1.6976</span>
    <span class="n">b_1_omg22</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.42311</span>
    <span class="n">b_2_omg22</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.066699</span>
    <span class="n">b_3_omg22</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.83053</span>
    <span class="n">c_11_omg22</span> <span class="o">=</span> <span class="mf">0.066045</span>
    <span class="n">c_12_omg22</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.23876</span>
    <span class="n">c_31_omg22</span> <span class="o">=</span> <span class="mf">0.76819</span>
    <span class="n">c_32_omg22</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.9201</span>

    <span class="c1"># (2;1) - TEOBResumSFits.c; line 2184-2189</span>
    <span class="n">omg21_0</span> <span class="o">=</span> <span class="mf">0.2906425497</span>  <span class="c1"># TEOBResumSFits.c; line 2002</span>
    <span class="n">a_1_omg21</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.563075</span>
    <span class="n">a_2_omg21</span> <span class="o">=</span> <span class="mf">3.28677</span>
    <span class="n">b_1_omg21</span> <span class="o">=</span> <span class="mf">0.179639</span>
    <span class="n">b_2_omg21</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.302122</span>
    <span class="n">c_1_omg21</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.20684</span>
    <span class="n">c_2_omg21</span> <span class="o">=</span> <span class="mf">0.425645</span>

    <span class="c1"># (3;3) - TEOBResumSFits.c; line 2258-2266</span>
    <span class="n">omg33_0</span> <span class="o">=</span> <span class="mf">0.4541278937</span>  <span class="c1"># TEOBResumSFits.c; line 2006</span>
    <span class="n">a_1_omg33</span> <span class="o">=</span> <span class="mf">1.08224</span>
    <span class="n">a_2_omg33</span> <span class="o">=</span> <span class="mf">2.59333</span>
    <span class="n">b_1_omg33</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.406161</span>
    <span class="n">b_2_omg33</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.0647944</span>
    <span class="n">b_3_omg33</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.748126</span>
    <span class="n">c_11_omg33</span> <span class="o">=</span> <span class="mf">0.85777</span>
    <span class="n">c_12_omg33</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.70066</span>
    <span class="n">c_31_omg33</span> <span class="o">=</span> <span class="mf">2.97025</span>
    <span class="n">c_32_omg33</span> <span class="o">=</span> <span class="o">-</span><span class="mf">3.96242</span>

    <span class="c1"># (3;2) - TEOBResumSFits.c; line 2240-2248</span>
    <span class="n">omg32_0</span> <span class="o">=</span> <span class="mf">0.4516072248</span>  <span class="c1"># TEOBResumSFits.c; line 2005</span>
    <span class="n">a_1_omg32</span> <span class="o">=</span> <span class="o">-</span><span class="mf">9.13525</span>
    <span class="n">a_2_omg32</span> <span class="o">=</span> <span class="mf">21.488</span>
    <span class="n">a_3_omg32</span> <span class="o">=</span> <span class="o">-</span><span class="mf">8.81384</span>
    <span class="n">a_4_omg32</span> <span class="o">=</span> <span class="mf">20.0595</span>
    <span class="n">b_1_omg32</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.458126</span>
    <span class="n">b_2_omg32</span> <span class="o">=</span> <span class="mf">0.0474616</span>
    <span class="n">b_3_omg32</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.486049</span>
    <span class="n">c_11_omg32</span> <span class="o">=</span> <span class="mf">3.25319</span>
    <span class="n">c_12_omg32</span> <span class="o">=</span> <span class="mf">0.535555</span>
    <span class="n">c_13_omg32</span> <span class="o">=</span> <span class="o">-</span><span class="mf">8.07905</span>
    <span class="n">c_21_omg32</span> <span class="o">=</span> <span class="mf">1.00066</span>
    <span class="n">c_22_omg32</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.1333</span>
    <span class="n">c_23_omg32</span> <span class="o">=</span> <span class="mf">0.601572</span>

    <span class="c1"># (3;1) - TEOBResumSFits.c; line 2691</span>
    <span class="n">omg31_0</span> <span class="o">=</span> <span class="mf">0.411755</span>  <span class="c1"># TEOBResumSFits.c; line 2004</span>
    <span class="n">n_2_omg31</span> <span class="o">=</span> <span class="mf">7.5362</span>
    <span class="n">d_1_omg31</span> <span class="o">=</span> <span class="o">-</span><span class="mf">2.7555</span>
    <span class="n">d_2_omg31</span> <span class="o">=</span> <span class="mf">38.572</span>

    <span class="c1"># (4;4) - TEOBResumSFits.c; line 2330-2353</span>
    <span class="n">omg44_0</span> <span class="o">=</span> <span class="mf">0.6356586393</span>  <span class="c1"># TEOBResumSFits.c; line 2010</span>
    <span class="n">a_1_omg44</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.964614</span>
    <span class="n">a_2_omg44</span> <span class="o">=</span> <span class="o">-</span><span class="mf">11.1828</span>
    <span class="n">a_3_omg44</span> <span class="o">=</span> <span class="o">-</span><span class="mf">2.08471</span>
    <span class="n">a_4_omg44</span> <span class="o">=</span> <span class="o">-</span><span class="mf">6.89287</span>
    <span class="n">b_1_omg44</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.445192</span>
    <span class="n">b_2_omg44</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.0985658</span>
    <span class="n">b_3_omg44</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.0307812</span>
    <span class="n">b_4_omg44</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.801552</span>
    <span class="n">c_11_omg44</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.92902</span>
    <span class="n">c_12_omg44</span> <span class="o">=</span> <span class="mf">10.86310</span>
    <span class="n">c_13_omg44</span> <span class="o">=</span> <span class="o">-</span><span class="mf">4.44930</span>
    <span class="n">c_14_omg44</span> <span class="o">=</span> <span class="mf">3.01808</span>
    <span class="n">c_21_omg44</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">c_22_omg44</span> <span class="o">=</span> <span class="mf">1.62523</span>
    <span class="n">c_23_omg44</span> <span class="o">=</span> <span class="o">-</span><span class="mf">7.70486</span>
    <span class="n">c_24_omg44</span> <span class="o">=</span> <span class="mf">15.06517</span>
    <span class="n">c_41_omg44</span> <span class="o">=</span> <span class="mf">0.93790</span>
    <span class="n">c_42_omg44</span> <span class="o">=</span> <span class="mf">8.36038</span>
    <span class="n">c_43_omg44</span> <span class="o">=</span> <span class="o">-</span><span class="mf">4.85774</span>
    <span class="n">c_44_omg44</span> <span class="o">=</span> <span class="mf">4.80446</span>

    <span class="c1"># (4;3) - TEOBResumSFits.c; line 2305-2320</span>
    <span class="n">omg43_0</span> <span class="o">=</span> <span class="mf">0.6361300619</span>  <span class="c1"># TEOBResumSFits.c; line 2009</span>
    <span class="n">a_1_omg43</span> <span class="o">=</span> <span class="o">-</span><span class="mf">9.02463</span>
    <span class="n">a_2_omg43</span> <span class="o">=</span> <span class="mf">21.9802</span>
    <span class="n">a_3_omg43</span> <span class="o">=</span> <span class="o">-</span><span class="mf">8.75892</span>
    <span class="n">a_4_omg43</span> <span class="o">=</span> <span class="mf">20.5624</span>
    <span class="n">b_1_omg43</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.973324</span>
    <span class="n">b_2_omg43</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.109921</span>
    <span class="n">b_3_omg43</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.08036</span>
    <span class="n">c_11_omg43</span> <span class="o">=</span> <span class="mf">11.5224</span>
    <span class="n">c_12_omg43</span> <span class="o">=</span> <span class="o">-</span><span class="mf">26.8421</span>
    <span class="n">c_13_omg43</span> <span class="o">=</span> <span class="o">-</span><span class="mf">2.84285</span>
    <span class="n">c_21_omg43</span> <span class="o">=</span> <span class="mf">3.51943</span>
    <span class="n">c_22_omg43</span> <span class="o">=</span> <span class="o">-</span><span class="mf">12.1688</span>
    <span class="n">c_23_omg43</span> <span class="o">=</span> <span class="o">-</span><span class="mf">3.96385</span>
    <span class="n">c_31_omg43</span> <span class="o">=</span> <span class="mf">5.53433</span>
    <span class="n">c_32_omg43</span> <span class="o">=</span> <span class="mf">3.73988</span>
    <span class="n">c_33_omg43</span> <span class="o">=</span> <span class="mf">4.219</span>

    <span class="c1"># (4;2) - TEOBResumSFits.c; line 2275-2294</span>
    <span class="n">omg42_0</span> <span class="o">=</span> <span class="mf">0.6175331548</span>  <span class="c1"># TEOBResumSFits.c; line 2008</span>
    <span class="n">a_1_omg42</span> <span class="o">=</span> <span class="o">-</span><span class="mf">7.44121</span>
    <span class="n">a_2_omg42</span> <span class="o">=</span> <span class="mf">14.233</span>
    <span class="n">a_3_omg42</span> <span class="o">=</span> <span class="o">-</span><span class="mf">6.61754</span>
    <span class="n">a_4_omg42</span> <span class="o">=</span> <span class="mf">11.4329</span>
    <span class="n">b_1_omg42</span> <span class="o">=</span> <span class="o">-</span><span class="mf">2.37589</span>
    <span class="n">b_2_omg42</span> <span class="o">=</span> <span class="mf">1.97249</span>
    <span class="n">b_3_omg42</span> <span class="o">=</span> <span class="o">-</span><span class="mf">2.36107</span>
    <span class="n">b_4_omg42</span> <span class="o">=</span> <span class="mf">2.16383</span>
    <span class="n">c_11_omg42</span> <span class="o">=</span> <span class="mf">10.1045</span>
    <span class="n">c_12_omg42</span> <span class="o">=</span> <span class="o">-</span><span class="mf">6.94127</span>
    <span class="n">c_13_omg42</span> <span class="o">=</span> <span class="mf">12.1857</span>
    <span class="n">c_21_omg42</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.62866</span>
    <span class="n">c_22_omg42</span> <span class="o">=</span> <span class="o">-</span><span class="mf">2.6756</span>
    <span class="n">c_23_omg42</span> <span class="o">=</span> <span class="o">-</span><span class="mf">4.7536</span>
    <span class="n">c_31_omg42</span> <span class="o">=</span> <span class="mf">10.071</span>
    <span class="n">c_32_omg42</span> <span class="o">=</span> <span class="o">-</span><span class="mf">6.7299</span>
    <span class="n">c_33_omg42</span> <span class="o">=</span> <span class="mf">12.0377</span>
    <span class="n">c_41_omg42</span> <span class="o">=</span> <span class="o">-</span><span class="mf">8.56139</span>
    <span class="n">c_42_omg42</span> <span class="o">=</span> <span class="o">-</span><span class="mf">5.27136</span>
    <span class="n">c_43_omg42</span> <span class="o">=</span> <span class="mf">5.10653</span>

    <span class="c1"># (4;1) - TEOBResumSFits.c; line 2696</span>
    <span class="n">omg41_0</span> <span class="o">=</span> <span class="mf">0.552201</span>  <span class="c1"># TEOBResumSFits.c; line 2007</span>
    <span class="n">n_1_omg41</span> <span class="o">=</span> <span class="o">-</span><span class="mf">10.876</span>
    <span class="n">n_2_omg41</span> <span class="o">=</span> <span class="mf">37.904</span>
    <span class="n">d_1_omg41</span> <span class="o">=</span> <span class="o">-</span><span class="mf">11.194</span>
    <span class="n">d_2_omg41</span> <span class="o">=</span> <span class="mf">42.77</span>

    <span class="c1"># (5;5) - TEOBResumSFits.c; line 2364-2369</span>
    <span class="n">omg55_0</span> <span class="o">=</span> <span class="mf">0.818117</span>  <span class="c1"># TEOBResumSFits.c; line 2011</span>
    <span class="n">a_1_omg55</span> <span class="o">=</span> <span class="o">-</span><span class="mf">2.8918</span>
    <span class="n">a_2_omg55</span> <span class="o">=</span> <span class="o">-</span><span class="mf">3.2012</span>
    <span class="n">a_3_omg55</span> <span class="o">=</span> <span class="o">-</span><span class="mf">3.773</span>
    <span class="n">b_1_omg55</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.332703</span>
    <span class="n">b_2_omg55</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.675738</span>
    <span class="n">c_11_omg55</span> <span class="o">=</span> <span class="mf">1.487294</span>
    <span class="n">c_12_omg55</span> <span class="o">=</span> <span class="o">-</span><span class="mf">2.058537</span>
    <span class="n">c_21_omg55</span> <span class="o">=</span> <span class="mf">1.454248</span>
    <span class="n">c_22_omg55</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.301284</span>
    <span class="c1"># ------------------------------------------------------------------------------------------------------------------------------------------------ #</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">l</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">m</span> <span class="o">==</span> <span class="mi">2</span><span class="p">):</span>  <span class="c1"># eqs. C17-C20 of arXiv:2001.09082v2</span>

        <span class="n">b1_omg</span> <span class="o">=</span> <span class="p">(</span><span class="n">b_1_omg22</span> <span class="o">+</span> <span class="n">c_11_omg22</span> <span class="o">*</span> <span class="n">X12</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">c_12_omg22</span> <span class="o">*</span> <span class="n">X12</span><span class="p">)</span>
        <span class="n">b2_omg</span> <span class="o">=</span> <span class="n">b_2_omg22</span>
        <span class="n">b3_omg</span> <span class="o">=</span> <span class="p">(</span><span class="n">b_3_omg22</span> <span class="o">+</span> <span class="n">c_31_omg22</span> <span class="o">*</span> <span class="n">X12</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">c_32_omg22</span> <span class="o">*</span> <span class="n">X12</span><span class="p">)</span>

        <span class="n">omg22_orb</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">a_1_omg22</span> <span class="o">*</span> <span class="n">nu</span> <span class="o">+</span> <span class="n">a_2_omg22</span> <span class="o">*</span> <span class="n">nu2</span>
        <span class="n">num_spin</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">b1_omg</span> <span class="o">*</span> <span class="n">S_hat</span> <span class="o">+</span> <span class="n">b2_omg</span> <span class="o">*</span> <span class="n">S_hat2</span>
        <span class="n">den_spin</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">b3_omg</span> <span class="o">*</span> <span class="n">S_hat</span>

        <span class="n">omg22_spin</span> <span class="o">=</span> <span class="n">num_spin</span> <span class="o">/</span> <span class="n">den_spin</span>

        <span class="n">res</span> <span class="o">=</span> <span class="n">omg22_0</span> <span class="o">*</span> <span class="n">omg22_orb</span> <span class="o">*</span> <span class="n">omg22_spin</span>

    <span class="k">elif</span> <span class="p">(</span><span class="n">l</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">m</span> <span class="o">==</span> <span class="mi">1</span><span class="p">):</span>  <span class="c1"># eqs. C25-C28 of arXiv:2001.09082v2</span>

        <span class="n">b1_omg</span> <span class="o">=</span> <span class="n">b_1_omg21</span> <span class="o">+</span> <span class="n">c_1_omg21</span> <span class="o">*</span> <span class="n">nu</span>
        <span class="n">b2_omg</span> <span class="o">=</span> <span class="n">b_2_omg21</span> <span class="o">+</span> <span class="n">c_2_omg21</span> <span class="o">*</span> <span class="n">nu</span>

        <span class="n">omg21_orb</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">a_1_omg21</span> <span class="o">*</span> <span class="n">nu</span> <span class="o">+</span> <span class="n">a_2_omg21</span> <span class="o">*</span> <span class="n">nu2</span>
        <span class="n">omg21_spin</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">b1_omg</span> <span class="o">*</span> <span class="n">S_hat</span> <span class="o">+</span> <span class="n">b2_omg</span> <span class="o">*</span> <span class="n">S_hat2</span>

        <span class="n">res</span> <span class="o">=</span> <span class="n">omg21_0</span> <span class="o">*</span> <span class="n">omg21_orb</span> <span class="o">*</span> <span class="n">omg21_spin</span>

    <span class="k">elif</span> <span class="p">(</span><span class="n">l</span> <span class="o">==</span> <span class="mi">3</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">m</span> <span class="o">==</span> <span class="mi">3</span><span class="p">):</span>  <span class="c1"># eqs. C38-C41 of arXiv:2001.09082v2</span>

        <span class="n">b1_omg</span> <span class="o">=</span> <span class="p">(</span><span class="n">b_1_omg33</span> <span class="o">+</span> <span class="n">c_11_omg33</span> <span class="o">*</span> <span class="n">nu</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">c_12_omg33</span> <span class="o">*</span> <span class="n">nu</span><span class="p">)</span>
        <span class="n">b2_omg</span> <span class="o">=</span> <span class="n">b_2_omg33</span>
        <span class="n">b3_omg</span> <span class="o">=</span> <span class="p">(</span><span class="n">b_3_omg33</span> <span class="o">+</span> <span class="n">c_31_omg33</span> <span class="o">*</span> <span class="n">nu</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">c_32_omg33</span> <span class="o">*</span> <span class="n">nu</span><span class="p">)</span>

        <span class="n">omg33_orb</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">a_1_omg33</span> <span class="o">*</span> <span class="n">nu</span> <span class="o">+</span> <span class="n">a_2_omg33</span> <span class="o">*</span> <span class="n">nu2</span>
        <span class="n">num_spin</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">b1_omg</span> <span class="o">*</span> <span class="n">S_hat</span> <span class="o">+</span> <span class="n">b2_omg</span> <span class="o">*</span> <span class="n">S_hat2</span>
        <span class="n">den_spin</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">b3_omg</span> <span class="o">*</span> <span class="n">S_hat</span>

        <span class="n">omg33_spin</span> <span class="o">=</span> <span class="n">num_spin</span> <span class="o">/</span> <span class="n">den_spin</span>

        <span class="n">res</span> <span class="o">=</span> <span class="n">omg33_0</span> <span class="o">*</span> <span class="n">omg33_orb</span> <span class="o">*</span> <span class="n">omg33_spin</span>

    <span class="k">elif</span> <span class="p">(</span><span class="n">l</span> <span class="o">==</span> <span class="mi">3</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">m</span> <span class="o">==</span> <span class="mi">2</span><span class="p">):</span>  <span class="c1"># eqs. C50-C53 of arXiv:2001.09082v2</span>

        <span class="n">b1_omg</span> <span class="o">=</span> <span class="p">(</span><span class="n">b_1_omg32</span> <span class="o">+</span> <span class="n">c_11_omg32</span> <span class="o">*</span> <span class="n">X12</span> <span class="o">+</span> <span class="n">c_12_omg32</span> <span class="o">*</span> <span class="n">X12_2</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span>
            <span class="mi">1</span> <span class="o">+</span> <span class="n">c_13_omg32</span> <span class="o">*</span> <span class="n">X12</span>
        <span class="p">)</span>
        <span class="n">b2_omg</span> <span class="o">=</span> <span class="p">(</span><span class="n">b_2_omg32</span> <span class="o">+</span> <span class="n">c_21_omg32</span> <span class="o">*</span> <span class="n">X12</span> <span class="o">+</span> <span class="n">c_22_omg32</span> <span class="o">*</span> <span class="n">X12_2</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span>
            <span class="mi">1</span> <span class="o">+</span> <span class="n">c_23_omg32</span> <span class="o">*</span> <span class="n">X12</span>
        <span class="p">)</span>
        <span class="n">b3_omg</span> <span class="o">=</span> <span class="n">b_3_omg32</span>

        <span class="n">num_orb</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">a_1_omg32</span> <span class="o">*</span> <span class="n">nu</span> <span class="o">+</span> <span class="n">a_2_omg32</span> <span class="o">*</span> <span class="n">nu2</span>
        <span class="n">den_orb</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">a_3_omg32</span> <span class="o">*</span> <span class="n">nu</span> <span class="o">+</span> <span class="n">a_4_omg32</span> <span class="o">*</span> <span class="n">nu2</span>
        <span class="n">num_spin</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">b1_omg</span> <span class="o">*</span> <span class="n">a0</span> <span class="o">+</span> <span class="n">b2_omg</span> <span class="o">*</span> <span class="n">a0_2</span>
        <span class="n">den_spin</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">b3_omg</span> <span class="o">*</span> <span class="n">a0</span>

        <span class="n">omg32_orb</span> <span class="o">=</span> <span class="n">num_orb</span> <span class="o">/</span> <span class="n">den_orb</span>
        <span class="n">omg32_spin</span> <span class="o">=</span> <span class="n">num_spin</span> <span class="o">/</span> <span class="n">den_spin</span>

        <span class="n">res</span> <span class="o">=</span> <span class="n">omg32_0</span> <span class="o">*</span> <span class="n">omg32_orb</span> <span class="o">*</span> <span class="n">omg32_spin</span>

    <span class="k">elif</span> <span class="p">(</span><span class="n">l</span> <span class="o">==</span> <span class="mi">3</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">m</span> <span class="o">==</span> <span class="mi">1</span><span class="p">):</span>  <span class="c1"># eq. 5.19 of arXiv:1904.09550v2</span>

        <span class="k">if</span> <span class="n">nu</span> <span class="o">==</span> <span class="mf">0.25</span><span class="p">:</span>  <span class="c1"># TEOBResumSFits.c, line 2685</span>
            <span class="n">res</span> <span class="o">=</span> <span class="mf">0.0</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">num_orb</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">n_2_omg31</span> <span class="o">*</span> <span class="n">nu2</span>
            <span class="n">den_orb</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">d_1_omg31</span> <span class="o">*</span> <span class="n">nu</span> <span class="o">+</span> <span class="n">d_2_omg31</span> <span class="o">*</span> <span class="n">nu2</span>

            <span class="n">omg31_orb</span> <span class="o">=</span> <span class="n">num_orb</span> <span class="o">/</span> <span class="n">den_orb</span>

            <span class="n">res</span> <span class="o">=</span> <span class="n">omg31_0</span> <span class="o">*</span> <span class="n">omg31_orb</span>

    <span class="k">elif</span> <span class="p">(</span><span class="n">l</span> <span class="o">==</span> <span class="mi">4</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">m</span> <span class="o">==</span> <span class="mi">4</span><span class="p">):</span>  <span class="c1"># eqs. C65-C68 of arXiv:2001.09082v2</span>

        <span class="n">b1_omg</span> <span class="o">=</span> <span class="p">(</span><span class="n">b_1_omg44</span> <span class="o">+</span> <span class="n">c_11_omg44</span> <span class="o">*</span> <span class="n">nu</span> <span class="o">+</span> <span class="n">c_12_omg44</span> <span class="o">*</span> <span class="n">nu2</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span>
            <span class="mi">1</span> <span class="o">+</span> <span class="n">c_13_omg44</span> <span class="o">*</span> <span class="n">nu</span> <span class="o">+</span> <span class="n">c_14_omg44</span> <span class="o">*</span> <span class="n">nu2</span>
        <span class="p">)</span>
        <span class="n">b2_omg</span> <span class="o">=</span> <span class="p">(</span><span class="n">b_2_omg44</span> <span class="o">+</span> <span class="n">c_21_omg44</span> <span class="o">*</span> <span class="n">nu</span> <span class="o">+</span> <span class="n">c_22_omg44</span> <span class="o">*</span> <span class="n">nu2</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span>
            <span class="mi">1</span> <span class="o">+</span> <span class="n">c_23_omg44</span> <span class="o">*</span> <span class="n">nu</span> <span class="o">+</span> <span class="n">c_24_omg44</span> <span class="o">*</span> <span class="n">nu2</span>
        <span class="p">)</span>
        <span class="n">b3_omg</span> <span class="o">=</span> <span class="n">b_3_omg44</span>
        <span class="n">b4_omg</span> <span class="o">=</span> <span class="p">(</span><span class="n">b_4_omg44</span> <span class="o">+</span> <span class="n">c_41_omg44</span> <span class="o">*</span> <span class="n">nu</span> <span class="o">+</span> <span class="n">c_42_omg44</span> <span class="o">*</span> <span class="n">nu2</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span>
            <span class="mi">1</span> <span class="o">+</span> <span class="n">c_43_omg44</span> <span class="o">*</span> <span class="n">nu</span> <span class="o">+</span> <span class="n">c_44_omg44</span> <span class="o">*</span> <span class="n">nu2</span>
        <span class="p">)</span>

        <span class="n">num_orb</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">a_1_omg44</span> <span class="o">*</span> <span class="n">nu</span> <span class="o">+</span> <span class="n">a_2_omg44</span> <span class="o">*</span> <span class="n">nu2</span>
        <span class="n">den_orb</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">a_3_omg44</span> <span class="o">*</span> <span class="n">nu</span> <span class="o">+</span> <span class="n">a_4_omg44</span> <span class="o">*</span> <span class="n">nu2</span>
        <span class="n">num_spin</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">b1_omg</span> <span class="o">*</span> <span class="n">S_hat</span> <span class="o">+</span> <span class="n">b2_omg</span> <span class="o">*</span> <span class="n">S_hat2</span> <span class="o">+</span> <span class="n">b3_omg</span> <span class="o">*</span> <span class="n">S_hat3</span>
        <span class="n">den_spin</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">b4_omg</span> <span class="o">*</span> <span class="n">S_hat</span>

        <span class="n">omg44_orb</span> <span class="o">=</span> <span class="n">num_orb</span> <span class="o">/</span> <span class="n">den_orb</span>
        <span class="n">omg44_spin</span> <span class="o">=</span> <span class="n">num_spin</span> <span class="o">/</span> <span class="n">den_spin</span>

        <span class="n">res</span> <span class="o">=</span> <span class="n">omg44_0</span> <span class="o">*</span> <span class="n">omg44_orb</span> <span class="o">*</span> <span class="n">omg44_spin</span>

    <span class="k">elif</span> <span class="p">(</span><span class="n">l</span> <span class="o">==</span> <span class="mi">4</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">m</span> <span class="o">==</span> <span class="mi">3</span><span class="p">):</span>  <span class="c1"># eqs. C78-C81 of arXiv:2001.09082v2</span>

        <span class="n">b1_omg</span> <span class="o">=</span> <span class="p">(</span><span class="n">b_1_omg43</span> <span class="o">+</span> <span class="n">c_11_omg43</span> <span class="o">*</span> <span class="n">nu</span> <span class="o">+</span> <span class="n">c_12_omg43</span> <span class="o">*</span> <span class="n">nu2</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span>
            <span class="mi">1</span> <span class="o">+</span> <span class="n">c_13_omg43</span> <span class="o">*</span> <span class="n">nu</span>
        <span class="p">)</span>
        <span class="n">b2_omg</span> <span class="o">=</span> <span class="p">(</span><span class="n">b_2_omg43</span> <span class="o">+</span> <span class="n">c_21_omg43</span> <span class="o">*</span> <span class="n">nu</span> <span class="o">+</span> <span class="n">c_22_omg43</span> <span class="o">*</span> <span class="n">nu2</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span>
            <span class="mi">1</span> <span class="o">+</span> <span class="n">c_23_omg43</span> <span class="o">*</span> <span class="n">nu</span>
        <span class="p">)</span>
        <span class="n">b3_omg</span> <span class="o">=</span> <span class="p">(</span><span class="n">b_3_omg43</span> <span class="o">+</span> <span class="n">c_31_omg43</span> <span class="o">*</span> <span class="n">nu</span> <span class="o">+</span> <span class="n">c_32_omg43</span> <span class="o">*</span> <span class="n">nu2</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span>
            <span class="mi">1</span> <span class="o">+</span> <span class="n">c_33_omg43</span> <span class="o">*</span> <span class="n">nu</span>
        <span class="p">)</span>

        <span class="n">num_orb</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">a_1_omg43</span> <span class="o">*</span> <span class="n">nu</span> <span class="o">+</span> <span class="n">a_2_omg43</span> <span class="o">*</span> <span class="n">nu2</span>
        <span class="n">den_orb</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">a_3_omg43</span> <span class="o">*</span> <span class="n">nu</span> <span class="o">+</span> <span class="n">a_4_omg43</span> <span class="o">*</span> <span class="n">nu2</span>
        <span class="n">num_spin</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">b1_omg</span> <span class="o">*</span> <span class="n">S_hat</span> <span class="o">+</span> <span class="n">b2_omg</span> <span class="o">*</span> <span class="n">S_hat2</span>
        <span class="n">den_spin</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">b3_omg</span> <span class="o">*</span> <span class="n">S_hat</span>

        <span class="n">omg43_orb</span> <span class="o">=</span> <span class="n">num_orb</span> <span class="o">/</span> <span class="n">den_orb</span>
        <span class="n">omg43_spin</span> <span class="o">=</span> <span class="n">num_spin</span> <span class="o">/</span> <span class="n">den_spin</span>

        <span class="n">res</span> <span class="o">=</span> <span class="n">omg43_0</span> <span class="o">*</span> <span class="n">omg43_orb</span> <span class="o">*</span> <span class="n">omg43_spin</span>

    <span class="k">elif</span> <span class="p">(</span><span class="n">l</span> <span class="o">==</span> <span class="mi">4</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">m</span> <span class="o">==</span> <span class="mi">2</span><span class="p">):</span>  <span class="c1"># eqs. C90-C93 of arXiv:2001.09082v2</span>

        <span class="n">b1_omg</span> <span class="o">=</span> <span class="p">(</span><span class="n">b_1_omg42</span> <span class="o">+</span> <span class="n">c_11_omg42</span> <span class="o">*</span> <span class="n">nu</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span>
            <span class="mi">1</span> <span class="o">+</span> <span class="n">c_12_omg42</span> <span class="o">*</span> <span class="n">nu</span> <span class="o">+</span> <span class="n">c_13_omg42</span> <span class="o">*</span> <span class="n">nu2</span>
        <span class="p">)</span>
        <span class="n">b2_omg</span> <span class="o">=</span> <span class="p">(</span><span class="n">b_2_omg42</span> <span class="o">+</span> <span class="n">c_21_omg42</span> <span class="o">*</span> <span class="n">nu</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span>
            <span class="mi">1</span> <span class="o">+</span> <span class="n">c_22_omg42</span> <span class="o">*</span> <span class="n">nu</span> <span class="o">+</span> <span class="n">c_23_omg42</span> <span class="o">*</span> <span class="n">nu2</span>
        <span class="p">)</span>
        <span class="n">b3_omg</span> <span class="o">=</span> <span class="p">(</span><span class="n">b_3_omg42</span> <span class="o">+</span> <span class="n">c_31_omg42</span> <span class="o">*</span> <span class="n">nu</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span>
            <span class="mi">1</span> <span class="o">+</span> <span class="n">c_32_omg42</span> <span class="o">*</span> <span class="n">nu</span> <span class="o">+</span> <span class="n">c_33_omg42</span> <span class="o">*</span> <span class="n">nu2</span>
        <span class="p">)</span>
        <span class="n">b4_omg</span> <span class="o">=</span> <span class="p">(</span><span class="n">b_4_omg42</span> <span class="o">+</span> <span class="n">c_41_omg42</span> <span class="o">*</span> <span class="n">nu</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span>
            <span class="mi">1</span> <span class="o">+</span> <span class="n">c_42_omg42</span> <span class="o">*</span> <span class="n">nu</span> <span class="o">+</span> <span class="n">c_43_omg42</span> <span class="o">*</span> <span class="n">nu2</span>
        <span class="p">)</span>

        <span class="n">num_orb</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">a_1_omg42</span> <span class="o">*</span> <span class="n">nu</span> <span class="o">+</span> <span class="n">a_2_omg42</span> <span class="o">*</span> <span class="n">nu2</span>
        <span class="n">den_orb</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">a_3_omg42</span> <span class="o">*</span> <span class="n">nu</span> <span class="o">+</span> <span class="n">a_4_omg42</span> <span class="o">*</span> <span class="n">nu2</span>
        <span class="n">num_spin</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">b1_omg</span> <span class="o">*</span> <span class="n">S_hat</span> <span class="o">+</span> <span class="n">b2_omg</span> <span class="o">*</span> <span class="n">S_hat2</span>
        <span class="n">den_spin</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">b3_omg</span> <span class="o">*</span> <span class="n">S_hat</span> <span class="o">+</span> <span class="n">b4_omg</span> <span class="o">*</span> <span class="n">S_hat2</span>

        <span class="n">omg42_orb</span> <span class="o">=</span> <span class="n">num_orb</span> <span class="o">/</span> <span class="n">den_orb</span>
        <span class="n">omg42_spin</span> <span class="o">=</span> <span class="n">num_spin</span> <span class="o">/</span> <span class="n">den_spin</span>

        <span class="n">res</span> <span class="o">=</span> <span class="n">omg42_0</span> <span class="o">*</span> <span class="n">omg42_orb</span> <span class="o">*</span> <span class="n">omg42_spin</span>

    <span class="k">elif</span> <span class="p">(</span><span class="n">l</span> <span class="o">==</span> <span class="mi">4</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">m</span> <span class="o">==</span> <span class="mi">1</span><span class="p">):</span>  <span class="c1"># eq. 5.19 of arXiv:1904.09550v2</span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot;num_orb = 1 + n_1_omg41*nu + n_2_omg41*nu2</span>
<span class="sd">        den_orb = 1 + d_1_omg41*nu + d_2_omg41*nu2</span>

<span class="sd">        omg41_orb = num_orb/den_orb</span>

<span class="sd">        res = omg41_0 * omg41_orb&quot;&quot;&quot;</span>

        <span class="n">res</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># TEOBResumSFits.c, line 2696</span>

    <span class="k">elif</span> <span class="p">(</span><span class="n">l</span> <span class="o">==</span> <span class="mi">5</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">m</span> <span class="o">==</span> <span class="mi">5</span><span class="p">):</span>  <span class="c1"># eqs. C103-C106 of arXiv:2001.09082v2</span>

        <span class="n">b1_omg</span> <span class="o">=</span> <span class="p">(</span><span class="n">b_1_omg55</span> <span class="o">+</span> <span class="n">c_11_omg55</span> <span class="o">*</span> <span class="n">nu</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">c_12_omg55</span> <span class="o">*</span> <span class="n">nu</span><span class="p">)</span>
        <span class="n">b2_omg</span> <span class="o">=</span> <span class="p">(</span><span class="n">b_2_omg55</span> <span class="o">+</span> <span class="n">c_21_omg55</span> <span class="o">*</span> <span class="n">nu</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">c_22_omg55</span> <span class="o">*</span> <span class="n">nu</span><span class="p">)</span>

        <span class="n">num_orb</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">a_1_omg55</span> <span class="o">*</span> <span class="n">nu</span> <span class="o">+</span> <span class="n">a_2_omg55</span> <span class="o">*</span> <span class="n">nu2</span>
        <span class="n">den_orb</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">a_3_omg55</span> <span class="o">*</span> <span class="n">nu</span>
        <span class="n">num_spin</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">b1_omg</span> <span class="o">*</span> <span class="n">S_hat</span>
        <span class="n">den_spin</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">b2_omg</span> <span class="o">*</span> <span class="n">S_hat</span>

        <span class="n">omg55_orb</span> <span class="o">=</span> <span class="n">num_orb</span> <span class="o">/</span> <span class="n">den_orb</span>
        <span class="n">omg55_spin</span> <span class="o">=</span> <span class="n">num_spin</span> <span class="o">/</span> <span class="n">den_spin</span>

        <span class="n">res</span> <span class="o">=</span> <span class="n">omg55_0</span> <span class="o">*</span> <span class="n">omg55_orb</span> <span class="o">*</span> <span class="n">omg55_spin</span>

    <span class="k">return</span> <span class="n">res</span></div>



<span class="c1">###################################################################</span>
<span class="c1"># Utils Section 5: Fits for remnant mass and spin                 #</span>
<span class="c1"># functions: JimenezFortezaRemnantMass, JimenezFortezaRemnantSpin #</span>
<span class="c1">###################################################################</span>


<div class="viewcode-block" id="_JimenezFortezaRemnantMass">
<a class="viewcode-back" href="../../../autoapi/PyART/models/ringdown_fits/index.html#PyART.models.ringdown_fits._JimenezFortezaRemnantMass">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">_JimenezFortezaRemnantMass</span><span class="p">(</span><span class="n">nu</span><span class="p">,</span> <span class="n">X1</span><span class="p">,</span> <span class="n">X2</span><span class="p">,</span> <span class="n">chi1</span><span class="p">,</span> <span class="n">chi2</span><span class="p">,</span> <span class="n">M</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Compute the BH final mass with the aligned-spin NR fit by Xisco Jimenez Forteza,</span>
<span class="sd">    David Keitel, Sascha Husa et al.: see arXiv:1611.00332v2</span>
<span class="sd">    -----------------------------------------------------------------------------------</span>
<span class="sd">    m1, m2: component masses. chi1, chi2: dimensionless spins</span>
<span class="sd">    Note that it is assumed m1&gt;m2</span>
<span class="sd">    -----------------------------------------------------------------------------------</span>
<span class="sd">    Note: In arXiv:1611.00332v2 the symmetric mass ratio is called &#39;eta&#39;, contrary to</span>
<span class="sd">          the rest of our implementation where is &#39;nu&#39;.</span>
<span class="sd">          For clarity, we continue to use the symbol &#39;nu&#39; also for the</span>
<span class="sd">          functions JimenezFortezaRemnantMass and JimenezFortezaRemnantSpin</span>
<span class="sd">    Note: In arXiv:1611.00332v2, S_hat has a slighly different definition wrt the</span>
<span class="sd">          rest of the implementation</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">X12</span> <span class="o">=</span> <span class="n">X1</span> <span class="o">-</span> <span class="n">X2</span>
    <span class="n">X1_2</span> <span class="o">=</span> <span class="n">X1</span> <span class="o">*</span> <span class="n">X1</span>
    <span class="n">X2_2</span> <span class="o">=</span> <span class="n">X2</span> <span class="o">*</span> <span class="n">X2</span>
    <span class="n">S</span> <span class="o">=</span> <span class="p">(</span><span class="n">X1_2</span> <span class="o">*</span> <span class="n">chi1</span> <span class="o">+</span> <span class="n">X2_2</span> <span class="o">*</span> <span class="n">chi2</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">X1_2</span> <span class="o">+</span> <span class="n">X2_2</span><span class="p">)</span>
    <span class="n">Dchi</span> <span class="o">=</span> <span class="n">chi1</span> <span class="o">-</span> <span class="n">chi2</span>

    <span class="n">res</span> <span class="o">=</span> <span class="mf">0.0</span>
    <span class="n">nu2</span> <span class="o">=</span> <span class="n">nu</span> <span class="o">*</span> <span class="n">nu</span>
    <span class="n">nu3</span> <span class="o">=</span> <span class="n">nu2</span> <span class="o">*</span> <span class="n">nu</span>
    <span class="n">nu4</span> <span class="o">=</span> <span class="n">nu3</span> <span class="o">*</span> <span class="n">nu</span>
    <span class="n">S_2</span> <span class="o">=</span> <span class="n">S</span> <span class="o">*</span> <span class="n">S</span>
    <span class="n">S_3</span> <span class="o">=</span> <span class="n">S_2</span> <span class="o">*</span> <span class="n">S</span>
    <span class="n">Dchi_2</span> <span class="o">=</span> <span class="n">Dchi</span> <span class="o">*</span> <span class="n">Dchi</span>

    <span class="c1"># 1D fits - Table VII from arXiv:1611.00332v2</span>
    <span class="n">a2</span> <span class="o">=</span> <span class="mf">0.5610</span>
    <span class="n">a3</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.847</span>
    <span class="n">a4</span> <span class="o">=</span> <span class="mf">3.145</span>

    <span class="c1"># 1D fits - Table VIII from arXiv:1611.00332v2</span>
    <span class="n">b1</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.209</span>
    <span class="n">b2</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.197</span>
    <span class="n">b3</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.159</span>
    <span class="n">b5</span> <span class="o">=</span> <span class="mf">2.985</span>

    <span class="c1"># 2D fits - Table IX from arXiv:1611.00332v2</span>
    <span class="n">f20</span> <span class="o">=</span> <span class="mf">4.27</span>
    <span class="n">f30</span> <span class="o">=</span> <span class="mf">31.09</span>
    <span class="n">f50</span> <span class="o">=</span> <span class="mf">1.56735</span>
    <span class="n">f10</span> <span class="o">=</span> <span class="p">(</span>
        <span class="o">-</span><span class="mf">0.574752</span> <span class="o">*</span> <span class="n">f20</span> <span class="o">-</span> <span class="mf">0.280958</span> <span class="o">*</span> <span class="n">f30</span> <span class="o">+</span> <span class="mf">64.6408</span> <span class="o">*</span> <span class="n">f50</span> <span class="o">-</span> <span class="mf">88.3165</span>
    <span class="p">)</span>  <span class="c1"># eq. 26 of arXiv:1611.00332v2</span>

    <span class="c1"># 3D fits - Table X from arXiv:1611.00332v2</span>
    <span class="n">d10</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.098</span>
    <span class="n">d11</span> <span class="o">=</span> <span class="o">-</span><span class="mf">3.23</span>
    <span class="n">d20</span> <span class="o">=</span> <span class="mf">0.0112</span>
    <span class="n">d30</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.0198</span>
    <span class="n">d31</span> <span class="o">=</span> <span class="o">-</span><span class="mf">4.92</span>
    <span class="n">f11</span> <span class="o">=</span> <span class="mf">15.7</span>
    <span class="n">f21</span> <span class="o">=</span> <span class="mf">0.0</span>
    <span class="n">f31</span> <span class="o">=</span> <span class="o">-</span><span class="mf">243.6</span>
    <span class="n">f51</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.58</span>

<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Fit coefficients at increased numerical precision, taken from:</span>
<span class="sd">    https://git.ligo.org/uib-papers/finalstate2016/blob/master/LALInference/EradUIB2016v2_pyform_coeffs.txt</span>
<span class="sd">    git commit f490774d3593adff5bb09ae26b7efc6deab76a42</span>
<span class="sd">    -----------------------------------------------------------------------------------</span>
<span class="sd">    # 1D fits - Table VII from arXiv:1611.00332v2</span>
<span class="sd">    a2 = 0.5609904135313374, a3 = -0.84667563764404, a4 = 3.145145224278187</span>

<span class="sd">    # 1D fits - Table VIII from arXiv:1611.00332v2</span>
<span class="sd">    b1 = -0.2091189048177395, b2 = -0.19709136361080587, b3 = -0.1588185739358418, b5 = 2.9852925538232014</span>

<span class="sd">    # 2D fits - Table IX from arXiv:1611.00332v2</span>
<span class="sd">    f20 = 4.271313308472851, f30 = 31.08987570280556, f50 = 1.5673498395263061</span>
<span class="sd">    f10 = -0.574752*f20 - 0.280958*f30 + 64.6408*f50 - 88.3165   # eq. 26 of arXiv:1611.00332v2</span>

<span class="sd">    # 3D fits - Table X from arXiv:1611.00332v2</span>
<span class="sd">    d10 = -0.09803730445895877, d11 = -3.2283713377939134, d20 = 0.01118530335431078, d30 = -0.01978238971523653, d31 = -4.91667749015812</span>
<span class="sd">    f11 = 15.738082204419655, f21 = 0., f31 = -243.6299258830685, f51 = -0.5808669012986468</span>
<span class="sd">    -----------------------------------------------------------------------------------</span>
<span class="sd">    FIXME: URL is not still available: ask Greg where to find these coefficients.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># 1D fits</span>
    <span class="n">Erad_nu_0</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">a4</span> <span class="o">*</span> <span class="n">nu4</span> <span class="o">+</span> <span class="n">a3</span> <span class="o">*</span> <span class="n">nu3</span> <span class="o">+</span> <span class="n">a2</span> <span class="o">*</span> <span class="n">nu2</span> <span class="o">+</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="mf">2.0</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="mf">3.0</span><span class="p">)</span> <span class="o">*</span> <span class="n">nu</span>
    <span class="p">)</span>  <span class="c1"># eq. 21 of arXiv:1611.00332v2</span>

    <span class="c1"># 2D fits</span>
    <span class="n">f12</span> <span class="o">=</span> <span class="mf">16.0</span> <span class="o">-</span> <span class="mf">16.0</span> <span class="o">*</span> <span class="n">f10</span> <span class="o">-</span> <span class="mf">4.0</span> <span class="o">*</span> <span class="n">f11</span>  <span class="c1"># eq. 24 of arXiv:1611.00332v2</span>
    <span class="n">f22</span> <span class="o">=</span> <span class="mf">16.0</span> <span class="o">-</span> <span class="mf">16.0</span> <span class="o">*</span> <span class="n">f20</span> <span class="o">-</span> <span class="mf">4.0</span> <span class="o">*</span> <span class="n">f21</span>
    <span class="n">f32</span> <span class="o">=</span> <span class="mf">16.0</span> <span class="o">-</span> <span class="mf">16.0</span> <span class="o">*</span> <span class="n">f30</span> <span class="o">-</span> <span class="mf">4.0</span> <span class="o">*</span> <span class="n">f31</span>
    <span class="n">f52</span> <span class="o">=</span> <span class="mf">16.0</span> <span class="o">-</span> <span class="mf">16.0</span> <span class="o">*</span> <span class="n">f50</span> <span class="o">-</span> <span class="mf">4.0</span> <span class="o">*</span> <span class="n">f51</span>

    <span class="n">b1_nu</span> <span class="o">=</span> <span class="n">b1</span> <span class="o">*</span> <span class="p">(</span><span class="n">f10</span> <span class="o">+</span> <span class="n">f11</span> <span class="o">*</span> <span class="n">nu</span> <span class="o">+</span> <span class="n">f12</span> <span class="o">*</span> <span class="n">nu2</span><span class="p">)</span>  <span class="c1"># eq. 9 of arXiv:1611.00332v2</span>
    <span class="n">b2_nu</span> <span class="o">=</span> <span class="n">b2</span> <span class="o">*</span> <span class="p">(</span><span class="n">f20</span> <span class="o">+</span> <span class="n">f21</span> <span class="o">*</span> <span class="n">nu</span> <span class="o">+</span> <span class="n">f22</span> <span class="o">*</span> <span class="n">nu2</span><span class="p">)</span>
    <span class="n">b3_nu</span> <span class="o">=</span> <span class="n">b3</span> <span class="o">*</span> <span class="p">(</span><span class="n">f30</span> <span class="o">+</span> <span class="n">f31</span> <span class="o">*</span> <span class="n">nu</span> <span class="o">+</span> <span class="n">f32</span> <span class="o">*</span> <span class="n">nu2</span><span class="p">)</span>
    <span class="n">b5_nu</span> <span class="o">=</span> <span class="n">b5</span> <span class="o">*</span> <span class="p">(</span><span class="n">f50</span> <span class="o">+</span> <span class="n">f51</span> <span class="o">*</span> <span class="n">nu</span> <span class="o">+</span> <span class="n">f52</span> <span class="o">*</span> <span class="n">nu2</span><span class="p">)</span>

    <span class="n">Erad_nu25_S</span> <span class="o">=</span> <span class="p">(</span>
        <span class="mf">0.0484161</span>
        <span class="o">*</span> <span class="p">(</span><span class="mf">0.128</span> <span class="o">*</span> <span class="n">b3_nu</span> <span class="o">*</span> <span class="n">S_3</span> <span class="o">+</span> <span class="mf">0.211</span> <span class="o">*</span> <span class="n">b2_nu</span> <span class="o">*</span> <span class="n">S_2</span> <span class="o">+</span> <span class="mf">0.346</span> <span class="o">*</span> <span class="n">b1_nu</span> <span class="o">*</span> <span class="n">S</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
        <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="mf">0.212</span> <span class="o">*</span> <span class="n">b5_nu</span> <span class="o">*</span> <span class="n">S</span><span class="p">)</span>
    <span class="p">)</span>  <span class="c1"># eq. 22 of arXiv:1611.00332v2</span>
    <span class="n">Erad_nu25_0</span> <span class="o">=</span> <span class="mf">0.0484161</span>  <span class="c1"># see discussion at the beginning od sec. IV.B</span>

    <span class="n">Erad_nu_S</span> <span class="o">=</span> <span class="n">Erad_nu_0</span> <span class="o">*</span> <span class="n">Erad_nu25_S</span> <span class="o">/</span> <span class="n">Erad_nu25_0</span>  <span class="c1"># eq. 23 of arXiv:1611.00332v2</span>

    <span class="c1"># 3D fits</span>
    <span class="n">A1</span> <span class="o">=</span> <span class="n">d10</span> <span class="o">*</span> <span class="n">X12</span> <span class="o">*</span> <span class="n">nu2</span> <span class="o">*</span> <span class="p">(</span><span class="n">d11</span> <span class="o">*</span> <span class="n">nu</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>  <span class="c1"># eqs. 27(a-c) of arXiv:1611.00332v2</span>
    <span class="n">A2</span> <span class="o">=</span> <span class="n">d20</span> <span class="o">*</span> <span class="n">nu3</span>
    <span class="n">A3</span> <span class="o">=</span> <span class="n">d30</span> <span class="o">*</span> <span class="n">X12</span> <span class="o">*</span> <span class="n">nu</span> <span class="o">*</span> <span class="p">(</span><span class="n">d31</span> <span class="o">*</span> <span class="n">nu</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>

    <span class="n">DErad_nu_S_Dchi</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">A1</span> <span class="o">*</span> <span class="n">Dchi</span> <span class="o">+</span> <span class="n">A2</span> <span class="o">*</span> <span class="n">Dchi_2</span> <span class="o">+</span> <span class="n">A3</span> <span class="o">*</span> <span class="n">S</span> <span class="o">*</span> <span class="n">Dchi</span>
    <span class="p">)</span>  <span class="c1"># eq. 15 of arXiv:1611.00332v2</span>
    <span class="n">Erad</span> <span class="o">=</span> <span class="n">Erad_nu_S</span> <span class="o">+</span> <span class="n">DErad_nu_S_Dchi</span>  <span class="c1"># eq. 28 of arXiv:1611.00332v2</span>
    <span class="n">res</span> <span class="o">=</span> <span class="n">M</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">Erad</span><span class="p">)</span>  <span class="c1"># see discussion at the beginning of sec. IV</span>

    <span class="k">return</span> <span class="n">res</span></div>



<div class="viewcode-block" id="_JimenezFortezaRemnantSpin">
<a class="viewcode-back" href="../../../autoapi/PyART/models/ringdown_fits/index.html#PyART.models.ringdown_fits._JimenezFortezaRemnantSpin">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">_JimenezFortezaRemnantSpin</span><span class="p">(</span><span class="n">nu</span><span class="p">,</span> <span class="n">X1</span><span class="p">,</span> <span class="n">X2</span><span class="p">,</span> <span class="n">chi1</span><span class="p">,</span> <span class="n">chi2</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Compute the BH final spin with the aligned-spin NR fit by Xisco Jimenez Forteza,</span>
<span class="sd">    David Keitel, Sascha Husa et al.: see arXiv:1611.00332v2</span>
<span class="sd">    -----------------------------------------------------------------------------------</span>
<span class="sd">    m1, m2: component masses. chi1, chi2: dimensionless spins</span>
<span class="sd">    Note that it is assumed m1&gt;m2</span>
<span class="sd">    -----------------------------------------------------------------------------------</span>
<span class="sd">    Note: In arXiv:1611.00332v2 the symmetric mass ratio is called &#39;eta&#39;, contrary to</span>
<span class="sd">          the rest of the implementation where is &#39;nu&#39;.</span>
<span class="sd">          For clarity, we continue to use the symbol &#39;nu&#39; also for the</span>
<span class="sd">          functions JimenezFortezaRemnantMass and JimenezFortezaRemnantSpin</span>
<span class="sd">    Note: In arXiv:1611.00332v2, S_hat has a slighly different definition wrt the</span>
<span class="sd">        rest of the implementation</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">X12</span> <span class="o">=</span> <span class="n">X1</span> <span class="o">-</span> <span class="n">X2</span>
    <span class="n">X1_2</span> <span class="o">=</span> <span class="n">X1</span> <span class="o">*</span> <span class="n">X1</span>
    <span class="n">X2_2</span> <span class="o">=</span> <span class="n">X2</span> <span class="o">*</span> <span class="n">X2</span>
    <span class="n">S</span> <span class="o">=</span> <span class="p">(</span><span class="n">X1_2</span> <span class="o">*</span> <span class="n">chi1</span> <span class="o">+</span> <span class="n">X2_2</span> <span class="o">*</span> <span class="n">chi2</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">X1_2</span> <span class="o">+</span> <span class="n">X2_2</span><span class="p">)</span>
    <span class="n">Dchi</span> <span class="o">=</span> <span class="n">chi1</span> <span class="o">-</span> <span class="n">chi2</span>

    <span class="n">res</span> <span class="o">=</span> <span class="mf">0.0</span>
    <span class="n">nu2</span> <span class="o">=</span> <span class="n">nu</span> <span class="o">*</span> <span class="n">nu</span>
    <span class="n">nu3</span> <span class="o">=</span> <span class="n">nu2</span> <span class="o">*</span> <span class="n">nu</span>
    <span class="n">S_2</span> <span class="o">=</span> <span class="n">S</span> <span class="o">*</span> <span class="n">S</span>
    <span class="n">S_3</span> <span class="o">=</span> <span class="n">S_2</span> <span class="o">*</span> <span class="n">S</span>
    <span class="n">Dchi_2</span> <span class="o">=</span> <span class="n">Dchi</span> <span class="o">*</span> <span class="n">Dchi</span>

    <span class="c1"># 1D fits - Table I from arXiv:1611.00332v2</span>
    <span class="n">a2</span> <span class="o">=</span> <span class="mf">3.833</span>
    <span class="n">a3</span> <span class="o">=</span> <span class="o">-</span><span class="mf">9.49</span>
    <span class="n">a5</span> <span class="o">=</span> <span class="mf">2.513</span>

    <span class="c1"># 1D fits - Table II from arXiv:1611.00332v2</span>
    <span class="n">b1</span> <span class="o">=</span> <span class="mf">1.00096</span>
    <span class="n">b2</span> <span class="o">=</span> <span class="mf">0.788</span>
    <span class="n">b3</span> <span class="o">=</span> <span class="mf">0.654</span>
    <span class="n">b5</span> <span class="o">=</span> <span class="mf">0.840</span>

    <span class="c1"># 2D fits - Table III from arXiv:1611.00332v2</span>
    <span class="n">f21</span> <span class="o">=</span> <span class="mf">8.774</span>
    <span class="n">f31</span> <span class="o">=</span> <span class="mf">22.83</span>
    <span class="n">f50</span> <span class="o">=</span> <span class="mf">1.8805</span>
    <span class="n">f11</span> <span class="o">=</span> <span class="p">(</span>
        <span class="mf">0.345225</span> <span class="o">*</span> <span class="n">f21</span> <span class="o">+</span> <span class="mf">0.0321306</span> <span class="o">*</span> <span class="n">f31</span> <span class="o">-</span> <span class="mf">3.66556</span> <span class="o">*</span> <span class="n">f50</span> <span class="o">+</span> <span class="mf">7.5397</span>
    <span class="p">)</span>  <span class="c1"># eq. 13 of arXiv:1611.00332v2</span>

    <span class="c1"># 3D fits - Table IV from arXiv:1611.00332v2</span>
    <span class="n">d10</span> <span class="o">=</span> <span class="mf">0.322</span>
    <span class="n">d11</span> <span class="o">=</span> <span class="mf">9.33</span>
    <span class="n">d20</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.0598</span>
    <span class="n">d30</span> <span class="o">=</span> <span class="mf">2.32</span>
    <span class="n">d31</span> <span class="o">=</span> <span class="o">-</span><span class="mf">3.26</span>
    <span class="n">f12</span> <span class="o">=</span> <span class="mf">0.512</span>
    <span class="n">f22</span> <span class="o">=</span> <span class="o">-</span><span class="mf">32.1</span>
    <span class="n">f32</span> <span class="o">=</span> <span class="o">-</span><span class="mi">154</span>
    <span class="n">f51</span> <span class="o">=</span> <span class="o">-</span><span class="mf">4.77</span>

    <span class="c1"># 1D fits</span>
    <span class="n">Lorb_nu_0</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.3</span> <span class="o">*</span> <span class="n">a3</span> <span class="o">*</span> <span class="n">nu3</span> <span class="o">+</span> <span class="mf">5.24</span> <span class="o">*</span> <span class="n">a2</span> <span class="o">*</span> <span class="n">nu2</span> <span class="o">+</span> <span class="mf">2.0</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">*</span> <span class="n">nu</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span>
        <span class="mf">2.88</span> <span class="o">*</span> <span class="n">a5</span> <span class="o">*</span> <span class="n">nu</span> <span class="o">+</span> <span class="mi">1</span>
    <span class="p">)</span>  <span class="c1"># eq. 7 of arXiv:1611.00332v2</span>

    <span class="c1"># 2D fits</span>
    <span class="n">f13</span> <span class="o">=</span> <span class="mi">64</span> <span class="o">-</span> <span class="mf">16.0</span> <span class="o">*</span> <span class="n">f11</span> <span class="o">-</span> <span class="mf">4.0</span> <span class="o">*</span> <span class="n">f12</span>  <span class="c1"># eq. 11 of arXiv:1611.00332v2</span>
    <span class="n">f23</span> <span class="o">=</span> <span class="mi">64</span> <span class="o">-</span> <span class="mf">16.0</span> <span class="o">*</span> <span class="n">f21</span> <span class="o">-</span> <span class="mf">4.0</span> <span class="o">*</span> <span class="n">f22</span>
    <span class="n">f33</span> <span class="o">=</span> <span class="mi">64</span> <span class="o">-</span> <span class="mf">16.0</span> <span class="o">*</span> <span class="n">f31</span> <span class="o">-</span> <span class="mf">4.0</span> <span class="o">*</span> <span class="n">f32</span>
    <span class="n">f53</span> <span class="o">=</span> <span class="mi">64</span> <span class="o">-</span> <span class="mf">64.0</span> <span class="o">*</span> <span class="n">f50</span> <span class="o">-</span> <span class="mf">16.0</span> <span class="o">*</span> <span class="n">f51</span>

    <span class="n">b1_nu</span> <span class="o">=</span> <span class="n">b1</span> <span class="o">*</span> <span class="p">(</span><span class="n">f11</span> <span class="o">*</span> <span class="n">nu</span> <span class="o">+</span> <span class="n">f12</span> <span class="o">*</span> <span class="n">nu2</span> <span class="o">+</span> <span class="n">f13</span> <span class="o">*</span> <span class="n">nu3</span><span class="p">)</span>  <span class="c1"># eq. 9 of arXiv:1611.00332v2</span>
    <span class="n">b2_nu</span> <span class="o">=</span> <span class="n">b2</span> <span class="o">*</span> <span class="p">(</span><span class="n">f21</span> <span class="o">*</span> <span class="n">nu</span> <span class="o">+</span> <span class="n">f22</span> <span class="o">*</span> <span class="n">nu2</span> <span class="o">+</span> <span class="n">f23</span> <span class="o">*</span> <span class="n">nu3</span><span class="p">)</span>
    <span class="n">b3_nu</span> <span class="o">=</span> <span class="n">b3</span> <span class="o">*</span> <span class="p">(</span><span class="n">f31</span> <span class="o">*</span> <span class="n">nu</span> <span class="o">+</span> <span class="n">f32</span> <span class="o">*</span> <span class="n">nu2</span> <span class="o">+</span> <span class="n">f33</span> <span class="o">*</span> <span class="n">nu3</span><span class="p">)</span>
    <span class="n">b5_nu</span> <span class="o">=</span> <span class="n">b5</span> <span class="o">*</span> <span class="p">(</span><span class="n">f50</span> <span class="o">+</span> <span class="n">f51</span> <span class="o">*</span> <span class="n">nu</span> <span class="o">+</span> <span class="n">f53</span> <span class="o">*</span> <span class="n">nu3</span><span class="p">)</span>

    <span class="n">Lorb_nu25_S</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.00954</span> <span class="o">*</span> <span class="n">b3_nu</span> <span class="o">*</span> <span class="n">S_3</span> <span class="o">+</span> <span class="mf">0.0851</span> <span class="o">*</span> <span class="n">b2_nu</span> <span class="o">*</span> <span class="n">S_2</span> <span class="o">-</span> <span class="mf">0.194</span> <span class="o">*</span> <span class="n">b1_nu</span> <span class="o">*</span> <span class="n">S</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span>
        <span class="mi">1</span> <span class="o">-</span> <span class="mf">0.579</span> <span class="o">*</span> <span class="n">b5_nu</span> <span class="o">*</span> <span class="n">S</span>
    <span class="p">)</span> <span class="o">+</span> <span class="mf">0.68637</span>  <span class="c1"># eq. 8 of arXiv:1611.00332v2</span>
    <span class="n">Lorb_nu25_0</span> <span class="o">=</span> <span class="mf">0.68637</span>  <span class="c1"># follow from eq. 8 by imposing S=0</span>

    <span class="n">Lorb_nu_S</span> <span class="o">=</span> <span class="n">Lorb_nu_0</span> <span class="o">+</span> <span class="n">Lorb_nu25_S</span> <span class="o">-</span> <span class="n">Lorb_nu25_0</span>  <span class="c1"># eq. 10 of arXiv:1611.00332v2</span>

    <span class="c1"># 3D fits</span>
    <span class="n">A1</span> <span class="o">=</span> <span class="n">d10</span> <span class="o">*</span> <span class="n">X12</span> <span class="o">*</span> <span class="n">nu2</span> <span class="o">*</span> <span class="p">(</span><span class="n">d11</span> <span class="o">*</span> <span class="n">nu</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>  <span class="c1"># eqs. 19(a-c) of arXiv:1611.00332v2</span>
    <span class="n">A2</span> <span class="o">=</span> <span class="n">d20</span> <span class="o">*</span> <span class="n">nu3</span>
    <span class="n">A3</span> <span class="o">=</span> <span class="n">d30</span> <span class="o">*</span> <span class="n">X12</span> <span class="o">*</span> <span class="n">nu3</span> <span class="o">*</span> <span class="p">(</span><span class="n">d31</span> <span class="o">*</span> <span class="n">nu</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>

    <span class="n">DLorb_nu_S_Dchi</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">A1</span> <span class="o">*</span> <span class="n">Dchi</span> <span class="o">+</span> <span class="n">A2</span> <span class="o">*</span> <span class="n">Dchi_2</span> <span class="o">+</span> <span class="n">A3</span> <span class="o">*</span> <span class="n">S</span> <span class="o">*</span> <span class="n">Dchi</span>
    <span class="p">)</span>  <span class="c1"># eq. 15 of arXiv:1611.00332v2</span>
    <span class="n">Lorb</span> <span class="o">=</span> <span class="n">Lorb_nu_S</span> <span class="o">+</span> <span class="n">DLorb_nu_S_Dchi</span>  <span class="c1"># eq. 16 of arXiv:1611.00332v2</span>
    <span class="n">res</span> <span class="o">=</span> <span class="n">Lorb</span> <span class="o">+</span> <span class="n">X1_2</span> <span class="o">*</span> <span class="n">chi1</span> <span class="o">+</span> <span class="n">X2_2</span> <span class="o">*</span> <span class="n">chi2</span>  <span class="c1"># see discussion in sec. III.A</span>

    <span class="k">return</span> <span class="n">res</span></div>



<span class="c1">###################################################</span>
<span class="c1"># Utils Section 6: Fits for time and phase delays #</span>
<span class="c1"># functions: DeltaT, DeltaPhi                     #</span>
<span class="c1">###################################################</span>


<div class="viewcode-block" id="_DeltaT">
<a class="viewcode-back" href="../../../autoapi/PyART/models/ringdown_fits/index.html#PyART.models.ringdown_fits._DeltaT">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">_DeltaT</span><span class="p">(</span><span class="n">nu</span><span class="p">,</span> <span class="n">X12</span><span class="p">,</span> <span class="n">S_hat</span><span class="p">,</span> <span class="n">a0</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">m</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Function returning the value of Delta_t, following appendix C.2 of arXiv:2001.09082v2.</span>
<span class="sd">    It is called in function EOBPM_SetupFitCoefficients of waveform.pyx.</span>
<span class="sd">    -----------------------------------------------------------------------------------</span>
<span class="sd">    The fitting coefficients and equations are implemented from:</span>
<span class="sd">    (2,2) (2,1) (3,3) (3,2) (4,4) (4,3) (4,2) - arXiv:2001.09082v2, appendix C.3</span>
<span class="sd">    (3,1) (4,1) (5,5) - arXiv:1904.09550v2, section V.D</span>
<span class="sd">    -----------------------------------------------------------------------------------</span>
<span class="sd">    Note that paper arXiv:1904.09550v2 refers to the non-spinning case, while arXiv:2001.09082v2 includes spin effects.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">res</span> <span class="o">=</span> <span class="mf">0.0</span>
    <span class="n">nu2</span> <span class="o">=</span> <span class="n">nu</span> <span class="o">*</span> <span class="n">nu</span>
    <span class="n">nu3</span> <span class="o">=</span> <span class="n">nu2</span> <span class="o">*</span> <span class="n">nu</span>
    <span class="n">nu4</span> <span class="o">=</span> <span class="n">nu3</span> <span class="o">*</span> <span class="n">nu</span>
    <span class="n">X12_2</span> <span class="o">=</span> <span class="n">X12</span> <span class="o">*</span> <span class="n">X12</span>
    <span class="n">X12_3</span> <span class="o">=</span> <span class="n">X12_2</span> <span class="o">*</span> <span class="n">X12</span>
    <span class="n">S_hat2</span> <span class="o">=</span> <span class="n">S_hat</span> <span class="o">*</span> <span class="n">S_hat</span>
    <span class="n">S_hat3</span> <span class="o">=</span> <span class="n">S_hat2</span> <span class="o">*</span> <span class="n">S_hat</span>
    <span class="n">a0_2</span> <span class="o">=</span> <span class="n">a0</span> <span class="o">*</span> <span class="n">a0</span>

    <span class="c1"># ------------------------------------------------------------------------------------------------------------------------------------------------ #</span>
    <span class="c1"># (2,1) - TEOBResumSFits.c, line 673-680</span>
    <span class="n">Dt21_0</span> <span class="o">=</span> <span class="mf">11.75925</span>
    <span class="n">Dt21_0_nu</span> <span class="o">=</span> <span class="mf">6.6264</span>  <span class="c1"># TEOBResumSFits.c; line 640</span>
    <span class="n">a_1_Dt21</span> <span class="o">=</span> <span class="o">-</span><span class="mf">2.0728</span>
    <span class="n">b_1_Dt21</span> <span class="o">=</span> <span class="mf">0.0472289</span>
    <span class="n">b_2_Dt21</span> <span class="o">=</span> <span class="mf">0.115583</span>
    <span class="n">c_11_Dt21</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1976.13</span>
    <span class="n">c_12_Dt21</span> <span class="o">=</span> <span class="mf">3719.88</span>
    <span class="n">c_21_Dt21</span> <span class="o">=</span> <span class="o">-</span><span class="mf">2545.41</span>
    <span class="n">c_22_Dt21</span> <span class="o">=</span> <span class="mf">5277.62</span>

    <span class="c1"># (3;3) - TEOBResumSFits.c; line 736-738</span>
    <span class="n">Dt33_0</span> <span class="o">=</span> <span class="mf">3.42593</span>  <span class="c1"># TEOBResumSFits.c; line 643</span>
    <span class="n">a_1_Dt33</span> <span class="o">=</span> <span class="mf">0.183349</span>
    <span class="n">a_2_Dt33</span> <span class="o">=</span> <span class="mf">4.22361</span>
    <span class="n">b_1_Dt33</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.49791</span>
    <span class="n">b_2_Dt33</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.18754</span>
    <span class="n">b_3_Dt33</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.07291</span>
    <span class="n">c_11_Dt33</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.9478</span>
    <span class="n">c_12_Dt33</span> <span class="o">=</span> <span class="mf">13.9828</span>
    <span class="n">c_21_Dt33</span> <span class="o">=</span> <span class="mf">1.25084</span>
    <span class="n">c_22_Dt33</span> <span class="o">=</span> <span class="o">-</span><span class="mf">3.41811</span>
    <span class="n">c_31_Dt33</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1043.15</span>
    <span class="n">c_32_Dt33</span> <span class="o">=</span> <span class="mf">1033.85</span>

    <span class="c1"># (3;2) - TEOBResumSFits.c; line 686-729</span>
    <span class="n">Dt32_0</span> <span class="o">=</span> <span class="mf">9.16665</span>  <span class="c1"># TEOBResumSFits.c; line 642</span>
    <span class="n">a_1_Dt32</span> <span class="o">=</span> <span class="o">-</span><span class="mf">11.3497</span>
    <span class="n">a_2_Dt32</span> <span class="o">=</span> <span class="mf">32.9144</span>
    <span class="n">a_3_Dt32</span> <span class="o">=</span> <span class="o">-</span><span class="mf">8.36579</span>
    <span class="n">a_4_Dt32</span> <span class="o">=</span> <span class="mf">20.1017</span>
    <span class="n">b_1_Dt32</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.34161</span>
    <span class="n">b_2_Dt32</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.46107</span>
    <span class="n">b_3_Dt32</span> <span class="o">=</span> <span class="mf">0.34744</span>
    <span class="n">b_1_Dt32_nu</span> <span class="o">=</span> <span class="mf">0.15477</span>
    <span class="n">b_2_Dt32_nu</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.755639</span>
    <span class="n">b_3_Dt32_nu</span> <span class="o">=</span> <span class="mf">0.21816</span>
    <span class="n">c_11_Dt32</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.037634</span>
    <span class="n">c_12_Dt32</span> <span class="o">=</span> <span class="mf">12.456704</span>
    <span class="n">c_13_Dt32</span> <span class="o">=</span> <span class="mf">2.670868</span>
    <span class="n">c_14_Dt32</span> <span class="o">=</span> <span class="o">-</span><span class="mf">12.255859</span>
    <span class="n">c_15_Dt32</span> <span class="o">=</span> <span class="mf">37.843505</span>
    <span class="n">c_21_Dt32</span> <span class="o">=</span> <span class="o">-</span><span class="mf">25.058475</span>
    <span class="n">c_22_Dt32</span> <span class="o">=</span> <span class="mf">449.470722</span>
    <span class="n">c_23_Dt32</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1413.508735</span>
    <span class="n">c_24_Dt32</span> <span class="o">=</span> <span class="o">-</span><span class="mf">11.852596</span>
    <span class="n">c_25_Dt32</span> <span class="o">=</span> <span class="mf">41.348059</span>
    <span class="n">c_31_Dt32</span> <span class="o">=</span> <span class="o">-</span><span class="mf">5.650710</span>
    <span class="n">c_32_Dt32</span> <span class="o">=</span> <span class="o">-</span><span class="mf">9.567484</span>
    <span class="n">c_33_Dt32</span> <span class="o">=</span> <span class="mf">173.182999</span>
    <span class="n">c_34_Dt32</span> <span class="o">=</span> <span class="o">-</span><span class="mf">10.938605</span>
    <span class="n">c_35_Dt32</span> <span class="o">=</span> <span class="mf">35.670656</span>
    <span class="n">c_11_Dt32_X</span> <span class="o">=</span> <span class="mf">2.497188</span>
    <span class="n">c_12_Dt32_X</span> <span class="o">=</span> <span class="o">-</span><span class="mf">7.532596</span>
    <span class="n">c_13_Dt32_X</span> <span class="o">=</span> <span class="mf">4.645986</span>
    <span class="n">c_14_Dt32_X</span> <span class="o">=</span> <span class="o">-</span><span class="mf">3.652524</span>
    <span class="n">c_15_Dt32_X</span> <span class="o">=</span> <span class="mf">3.398687</span>
    <span class="n">c_21_Dt32_X</span> <span class="o">=</span> <span class="mf">7.054185</span>
    <span class="n">c_22_Dt32_X</span> <span class="o">=</span> <span class="o">-</span><span class="mf">12.260185</span>
    <span class="n">c_23_Dt32_X</span> <span class="o">=</span> <span class="mf">5.724802</span>
    <span class="n">c_24_Dt32_X</span> <span class="o">=</span> <span class="o">-</span><span class="mf">3.242611</span>
    <span class="n">c_25_Dt32_X</span> <span class="o">=</span> <span class="mf">2.714232</span>
    <span class="n">c_31_Dt32_X</span> <span class="o">=</span> <span class="mf">2.614565</span>
    <span class="n">c_32_Dt32_X</span> <span class="o">=</span> <span class="o">-</span><span class="mf">9.507583</span>
    <span class="n">c_33_Dt32_X</span> <span class="o">=</span> <span class="mf">7.321586</span>
    <span class="n">c_34_Dt32_X</span> <span class="o">=</span> <span class="o">-</span><span class="mf">3.937568</span>
    <span class="n">c_35_Dt32_X</span> <span class="o">=</span> <span class="mf">4.584970</span>

    <span class="c1"># (3;1) - TEOBResumSFits.c; line 793</span>
    <span class="n">Dt31_0</span> <span class="o">=</span> <span class="mf">12.9338</span>  <span class="c1"># TEOBResumSFits.c; line 641</span>
    <span class="n">n_2_Dt31</span> <span class="o">=</span> <span class="o">-</span><span class="mf">25.615</span>
    <span class="n">d_1_Dt31</span> <span class="o">=</span> <span class="mf">0.88803</span>
    <span class="n">d_2_Dt31</span> <span class="o">=</span> <span class="mf">16.292</span>

    <span class="c1"># (4;4) - TEOBResumSFits.c; line 781-787</span>
    <span class="n">Dt44_0</span> <span class="o">=</span> <span class="mf">5.27778</span>  <span class="c1"># TEOBResumSFits.c; line 647</span>
    <span class="n">a_1_Dt44</span> <span class="o">=</span> <span class="o">-</span><span class="mf">8.35574</span>
    <span class="n">a_2_Dt44</span> <span class="o">=</span> <span class="mf">17.5288</span>
    <span class="n">a_3_Dt44</span> <span class="o">=</span> <span class="o">-</span><span class="mf">6.50259</span>
    <span class="n">a_4_Dt44</span> <span class="o">=</span> <span class="mf">10.1575</span>
    <span class="n">b_1_Dt44_nu</span> <span class="o">=</span> <span class="mf">0.00159701</span>
    <span class="n">b_2_Dt44_nu</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.14134</span>
    <span class="n">c_11_Dt44</span> <span class="o">=</span> <span class="o">-</span><span class="mf">2.28656</span>
    <span class="n">c_12_Dt44</span> <span class="o">=</span> <span class="mf">1.66532</span>
    <span class="n">c_21_Dt44</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.589331</span>
    <span class="n">c_22_Dt44</span> <span class="o">=</span> <span class="mf">0.708784</span>

    <span class="c1"># (4;3) - TEOBResumSFits.c; line 759-777</span>
    <span class="n">Dt43_0</span> <span class="o">=</span> <span class="mf">9.53705</span>  <span class="c1"># TEOBResumSFits.c; line 646</span>
    <span class="n">a_1_Dt43</span> <span class="o">=</span> <span class="o">-</span><span class="mf">11.2377</span>
    <span class="n">a_2_Dt43</span> <span class="o">=</span> <span class="mf">38.3177</span>
    <span class="n">a_3_Dt43</span> <span class="o">=</span> <span class="o">-</span><span class="mf">7.29734</span>
    <span class="n">a_4_Dt43</span> <span class="o">=</span> <span class="mf">21.4267</span>
    <span class="n">b_1_Dt43</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.371832</span>
    <span class="n">b_2_Dt43</span> <span class="o">=</span> <span class="mf">0.362375</span>
    <span class="n">b_3_Dt43</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.0808402</span>
    <span class="n">c_11_Dt43</span> <span class="o">=</span> <span class="mf">3.215984</span>
    <span class="n">c_12_Dt43</span> <span class="o">=</span> <span class="mf">42.133767</span>
    <span class="n">c_13_Dt43</span> <span class="o">=</span> <span class="o">-</span><span class="mf">9.440398</span>
    <span class="n">c_14_Dt43</span> <span class="o">=</span> <span class="mf">35.160776</span>
    <span class="n">c_21_Dt43</span> <span class="o">=</span> <span class="mf">1.133942</span>
    <span class="n">c_22_Dt43</span> <span class="o">=</span> <span class="o">-</span><span class="mf">10.356311</span>
    <span class="n">c_23_Dt43</span> <span class="o">=</span> <span class="o">-</span><span class="mf">6.701429</span>
    <span class="n">c_24_Dt43</span> <span class="o">=</span> <span class="mf">10.726960</span>
    <span class="n">c_31_Dt43</span> <span class="o">=</span> <span class="o">-</span><span class="mf">6.036207</span>
    <span class="n">c_32_Dt43</span> <span class="o">=</span> <span class="mf">67.730599</span>
    <span class="n">c_33_Dt43</span> <span class="o">=</span> <span class="o">-</span><span class="mf">3.082275</span>
    <span class="n">c_34_Dt43</span> <span class="o">=</span> <span class="mf">11.547917</span>

    <span class="c1"># (4;2) - TEOBResumSFits.c; line 742-755</span>
    <span class="n">Dt42_0</span> <span class="o">=</span> <span class="mf">11.66665</span>  <span class="c1"># TEOBResumSFits.c; line 645</span>
    <span class="n">a_1_Dt42</span> <span class="o">=</span> <span class="o">-</span><span class="mf">9.8446172795</span>
    <span class="n">a_2_Dt42</span> <span class="o">=</span> <span class="mf">23.3229430582</span>
    <span class="n">a_3_Dt42</span> <span class="o">=</span> <span class="o">-</span><span class="mf">5.7604819848</span>
    <span class="n">a_4_Dt42</span> <span class="o">=</span> <span class="mf">7.1217930024</span>
    <span class="n">b_1_Dt42</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.3002045</span>
    <span class="n">b_2_Dt42</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.9494348</span>
    <span class="n">c_11_Dt42</span> <span class="o">=</span> <span class="mf">24.604717</span>
    <span class="n">c_12_Dt42</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.808279</span>
    <span class="n">c_21_Dt42</span> <span class="o">=</span> <span class="mf">62.471781</span>
    <span class="n">c_22_Dt42</span> <span class="o">=</span> <span class="mf">48.340961</span>

    <span class="c1"># (4;1) - TEOBResumSFits.c; line 795</span>
    <span class="n">Dt41_0</span> <span class="o">=</span> <span class="mf">13.1116</span>  <span class="c1"># TEOBResumSFits.c; line 644</span>
    <span class="n">n_1_Dt41</span> <span class="o">=</span> <span class="o">-</span><span class="mf">9.6225</span>
    <span class="n">n_2_Dt41</span> <span class="o">=</span> <span class="mf">38.451</span>
    <span class="n">d_1_Dt41</span> <span class="o">=</span> <span class="o">-</span><span class="mf">7.7998</span>
    <span class="n">d_2_Dt41</span> <span class="o">=</span> <span class="mf">32.405</span>

    <span class="c1"># (5;5) - TEOBResumSFits.c; line 800</span>
    <span class="n">Dt55_0</span> <span class="o">=</span> <span class="mf">6.561811</span>  <span class="c1"># TEOBResumSFits.c; line 648</span>
    <span class="n">n_1_Dt55</span> <span class="o">=</span> <span class="o">-</span><span class="mf">91.4401</span>
    <span class="n">n_2_Dt55</span> <span class="o">=</span> <span class="mf">2548.5975</span>
    <span class="n">n_3_Dt55</span> <span class="o">=</span> <span class="o">-</span><span class="mf">11086.4884</span>
    <span class="n">n_4_Dt55</span> <span class="o">=</span> <span class="mf">27137.0063</span>
    <span class="n">d_1_Dt55</span> <span class="o">=</span> <span class="o">-</span><span class="mf">67.156</span>
    <span class="n">d_2_Dt55</span> <span class="o">=</span> <span class="mf">1773.5942</span>
    <span class="c1"># ------------------------------------------------------------------------------------------------------------------------------------------------ #</span>

    <span class="k">if</span> <span class="p">(</span><span class="n">l</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">m</span> <span class="o">==</span> <span class="mi">2</span><span class="p">):</span>

        <span class="n">res</span> <span class="o">=</span> <span class="mf">0.0</span>

    <span class="k">elif</span> <span class="p">(</span><span class="n">l</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">m</span> <span class="o">==</span> <span class="mi">1</span><span class="p">):</span>  <span class="c1"># eqs. C29-C32 of arXiv:2001.09082v2</span>

        <span class="n">b1_Dt</span> <span class="o">=</span> <span class="p">(</span><span class="n">b_1_Dt21</span> <span class="o">+</span> <span class="n">c_11_Dt21</span> <span class="o">*</span> <span class="n">X12</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">c_12_Dt21</span> <span class="o">*</span> <span class="n">X12</span><span class="p">)</span>
        <span class="n">b2_Dt</span> <span class="o">=</span> <span class="p">(</span><span class="n">b_2_Dt21</span> <span class="o">+</span> <span class="n">c_21_Dt21</span> <span class="o">*</span> <span class="n">X12</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">c_22_Dt21</span> <span class="o">*</span> <span class="n">X12</span><span class="p">)</span>

        <span class="n">Dt21_orb</span> <span class="o">=</span> <span class="p">(</span><span class="n">Dt21_0</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">nu</span><span class="p">)</span> <span class="o">+</span> <span class="n">Dt21_0_nu</span> <span class="o">*</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">nu</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span>
            <span class="mi">1</span> <span class="o">+</span> <span class="n">a_1_Dt21</span> <span class="o">*</span> <span class="n">nu</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">nu</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="n">Dt21_spin</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">b1_Dt</span> <span class="o">*</span> <span class="n">a0</span> <span class="o">+</span> <span class="n">b2_Dt</span> <span class="o">*</span> <span class="n">a0_2</span>

        <span class="n">res</span> <span class="o">=</span> <span class="n">Dt21_orb</span> <span class="o">*</span> <span class="n">Dt21_spin</span>

    <span class="k">elif</span> <span class="p">(</span><span class="n">l</span> <span class="o">==</span> <span class="mi">3</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">m</span> <span class="o">==</span> <span class="mi">3</span><span class="p">):</span>  <span class="c1"># eqs. C42-C45 of arXiv:2001.09082v2</span>

        <span class="n">b1_Dt</span> <span class="o">=</span> <span class="p">(</span><span class="n">b_1_Dt33</span> <span class="o">+</span> <span class="n">c_11_Dt33</span> <span class="o">*</span> <span class="n">nu</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">c_12_Dt33</span> <span class="o">*</span> <span class="n">nu</span><span class="p">)</span>
        <span class="n">b2_Dt</span> <span class="o">=</span> <span class="p">(</span><span class="n">b_2_Dt33</span> <span class="o">+</span> <span class="n">c_21_Dt33</span> <span class="o">*</span> <span class="n">nu</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">c_22_Dt33</span> <span class="o">*</span> <span class="n">nu</span><span class="p">)</span>
        <span class="n">b3_Dt</span> <span class="o">=</span> <span class="p">(</span><span class="n">b_3_Dt33</span> <span class="o">+</span> <span class="n">c_31_Dt33</span> <span class="o">*</span> <span class="n">nu</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">c_32_Dt33</span> <span class="o">*</span> <span class="n">nu</span><span class="p">)</span>

        <span class="n">Dt33_orb</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">a_1_Dt33</span> <span class="o">*</span> <span class="n">nu</span> <span class="o">+</span> <span class="n">a_2_Dt33</span> <span class="o">*</span> <span class="n">nu2</span>
        <span class="n">num_spin</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">b1_Dt</span> <span class="o">*</span> <span class="n">S_hat</span> <span class="o">+</span> <span class="n">b2_Dt</span> <span class="o">*</span> <span class="n">S_hat2</span>
        <span class="n">den_spin</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">b3_Dt</span> <span class="o">*</span> <span class="n">S_hat</span>

        <span class="n">Dt33_spin</span> <span class="o">=</span> <span class="n">num_spin</span> <span class="o">/</span> <span class="n">den_spin</span>

        <span class="n">res</span> <span class="o">=</span> <span class="n">Dt33_0</span> <span class="o">*</span> <span class="n">Dt33_orb</span> <span class="o">*</span> <span class="n">Dt33_spin</span>

    <span class="k">elif</span> <span class="p">(</span><span class="n">l</span> <span class="o">==</span> <span class="mi">3</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">m</span> <span class="o">==</span> <span class="mi">2</span><span class="p">):</span>  <span class="c1"># eqs. C54-C60 of arXiv:2001.09082v2</span>

        <span class="k">if</span> <span class="n">nu</span> <span class="o">&gt;=</span> <span class="mf">0.2</span><span class="p">:</span>

            <span class="n">b1_Dt_nu</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">b_1_Dt32_nu</span>
                <span class="o">+</span> <span class="n">c_11_Dt32_X</span> <span class="o">*</span> <span class="n">X12</span>
                <span class="o">+</span> <span class="n">c_12_Dt32_X</span> <span class="o">*</span> <span class="n">X12_2</span>
                <span class="o">+</span> <span class="n">c_13_Dt32_X</span> <span class="o">*</span> <span class="n">X12_3</span>
            <span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">c_14_Dt32_X</span> <span class="o">*</span> <span class="n">X12</span> <span class="o">+</span> <span class="n">c_15_Dt32_X</span> <span class="o">*</span> <span class="n">X12_2</span><span class="p">)</span>
            <span class="n">b2_Dt_nu</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">b_2_Dt32_nu</span>
                <span class="o">+</span> <span class="n">c_21_Dt32_X</span> <span class="o">*</span> <span class="n">X12</span>
                <span class="o">+</span> <span class="n">c_22_Dt32_X</span> <span class="o">*</span> <span class="n">X12_2</span>
                <span class="o">+</span> <span class="n">c_23_Dt32_X</span> <span class="o">*</span> <span class="n">X12_3</span>
            <span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">c_24_Dt32_X</span> <span class="o">*</span> <span class="n">X12</span> <span class="o">+</span> <span class="n">c_25_Dt32_X</span> <span class="o">*</span> <span class="n">X12_2</span><span class="p">)</span>
            <span class="n">b3_Dt_nu</span> <span class="o">=</span> <span class="p">(</span>
                <span class="n">b_3_Dt32_nu</span>
                <span class="o">+</span> <span class="n">c_31_Dt32_X</span> <span class="o">*</span> <span class="n">X12</span>
                <span class="o">+</span> <span class="n">c_32_Dt32_X</span> <span class="o">*</span> <span class="n">X12_2</span>
                <span class="o">+</span> <span class="n">c_33_Dt32_X</span> <span class="o">*</span> <span class="n">X12_3</span>
            <span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">c_34_Dt32_X</span> <span class="o">*</span> <span class="n">X12</span> <span class="o">+</span> <span class="n">c_35_Dt32_X</span> <span class="o">*</span> <span class="n">X12_2</span><span class="p">)</span>

            <span class="n">num_spin</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">b1_Dt_nu</span> <span class="o">*</span> <span class="n">S_hat</span> <span class="o">+</span> <span class="n">b2_Dt_nu</span> <span class="o">*</span> <span class="n">S_hat2</span>
            <span class="n">den_spin</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">b3_Dt_nu</span> <span class="o">*</span> <span class="n">S_hat</span>

        <span class="k">else</span><span class="p">:</span>

            <span class="n">b1_Dt</span> <span class="o">=</span> <span class="p">(</span><span class="n">b_1_Dt32</span> <span class="o">+</span> <span class="n">c_11_Dt32</span> <span class="o">*</span> <span class="n">nu</span> <span class="o">+</span> <span class="n">c_12_Dt32</span> <span class="o">*</span> <span class="n">nu2</span> <span class="o">+</span> <span class="n">c_13_Dt32</span> <span class="o">*</span> <span class="n">nu3</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span>
                <span class="mi">1</span> <span class="o">+</span> <span class="n">c_14_Dt32</span> <span class="o">*</span> <span class="n">nu</span> <span class="o">+</span> <span class="n">c_15_Dt32</span> <span class="o">*</span> <span class="n">nu2</span>
            <span class="p">)</span>
            <span class="n">b2_Dt</span> <span class="o">=</span> <span class="p">(</span><span class="n">b_2_Dt32</span> <span class="o">+</span> <span class="n">c_21_Dt32</span> <span class="o">*</span> <span class="n">nu</span> <span class="o">+</span> <span class="n">c_22_Dt32</span> <span class="o">*</span> <span class="n">nu2</span> <span class="o">+</span> <span class="n">c_23_Dt32</span> <span class="o">*</span> <span class="n">nu3</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span>
                <span class="mi">1</span> <span class="o">+</span> <span class="n">c_24_Dt32</span> <span class="o">*</span> <span class="n">nu</span> <span class="o">+</span> <span class="n">c_25_Dt32</span> <span class="o">*</span> <span class="n">nu2</span>
            <span class="p">)</span>
            <span class="n">b3_Dt</span> <span class="o">=</span> <span class="p">(</span><span class="n">b_3_Dt32</span> <span class="o">+</span> <span class="n">c_31_Dt32</span> <span class="o">*</span> <span class="n">nu</span> <span class="o">+</span> <span class="n">c_32_Dt32</span> <span class="o">*</span> <span class="n">nu2</span> <span class="o">+</span> <span class="n">c_33_Dt32</span> <span class="o">*</span> <span class="n">nu3</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span>
                <span class="mi">1</span> <span class="o">+</span> <span class="n">c_34_Dt32</span> <span class="o">*</span> <span class="n">nu</span> <span class="o">+</span> <span class="n">c_35_Dt32</span> <span class="o">*</span> <span class="n">nu2</span>
            <span class="p">)</span>

            <span class="n">num_spin</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">b1_Dt</span> <span class="o">*</span> <span class="n">S_hat</span> <span class="o">+</span> <span class="n">b2_Dt</span> <span class="o">*</span> <span class="n">S_hat2</span>
            <span class="n">den_spin</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">b3_Dt</span> <span class="o">*</span> <span class="n">S_hat</span>

        <span class="n">num_orb</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">a_1_Dt32</span> <span class="o">*</span> <span class="n">nu</span> <span class="o">+</span> <span class="n">a_2_Dt32</span> <span class="o">*</span> <span class="n">nu2</span>
        <span class="n">den_orb</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">a_3_Dt32</span> <span class="o">*</span> <span class="n">nu</span> <span class="o">+</span> <span class="n">a_4_Dt32</span> <span class="o">*</span> <span class="n">nu2</span>

        <span class="n">Dt32_orb</span> <span class="o">=</span> <span class="n">num_orb</span> <span class="o">/</span> <span class="n">den_orb</span>
        <span class="n">Dt32_spin</span> <span class="o">=</span> <span class="n">num_spin</span> <span class="o">/</span> <span class="n">den_spin</span>

        <span class="n">res</span> <span class="o">=</span> <span class="n">Dt32_0</span> <span class="o">*</span> <span class="n">Dt32_orb</span> <span class="o">*</span> <span class="n">Dt32_spin</span>

    <span class="k">elif</span> <span class="p">(</span><span class="n">l</span> <span class="o">==</span> <span class="mi">3</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">m</span> <span class="o">==</span> <span class="mi">1</span><span class="p">):</span>  <span class="c1"># eq. 5.23-24 of arXiv:1904.09550v2</span>

        <span class="n">num_orb</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">n_2_Dt31</span> <span class="o">*</span> <span class="n">nu2</span>
        <span class="n">den_orb</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">d_1_Dt31</span> <span class="o">*</span> <span class="n">nu</span> <span class="o">+</span> <span class="n">d_2_Dt31</span> <span class="o">*</span> <span class="n">nu2</span>

        <span class="n">Dt31_orb</span> <span class="o">=</span> <span class="n">num_orb</span> <span class="o">/</span> <span class="n">den_orb</span>

        <span class="n">res</span> <span class="o">=</span> <span class="n">Dt31_0</span> <span class="o">*</span> <span class="n">Dt31_orb</span>

    <span class="k">elif</span> <span class="p">(</span><span class="n">l</span> <span class="o">==</span> <span class="mi">4</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">m</span> <span class="o">==</span> <span class="mi">4</span><span class="p">):</span>  <span class="c1"># eqs. C69-C72 of arXiv:2001.09082v2</span>

        <span class="n">b1_Dt</span> <span class="o">=</span> <span class="n">b_1_Dt44_nu</span> <span class="o">+</span> <span class="n">c_11_Dt44</span> <span class="o">*</span> <span class="n">X12</span> <span class="o">+</span> <span class="n">c_12_Dt44</span> <span class="o">*</span> <span class="n">X12_2</span>
        <span class="n">b2_Dt</span> <span class="o">=</span> <span class="n">b_2_Dt44_nu</span> <span class="o">+</span> <span class="n">c_21_Dt44</span> <span class="o">*</span> <span class="n">X12</span> <span class="o">+</span> <span class="n">c_22_Dt44</span> <span class="o">*</span> <span class="n">X12_2</span>

        <span class="n">num_orb</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">a_1_Dt44</span> <span class="o">*</span> <span class="n">nu</span> <span class="o">+</span> <span class="n">a_2_Dt44</span> <span class="o">*</span> <span class="n">nu2</span>
        <span class="n">den_orb</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">a_3_Dt44</span> <span class="o">*</span> <span class="n">nu</span> <span class="o">+</span> <span class="n">a_4_Dt44</span> <span class="o">*</span> <span class="n">nu2</span>
        <span class="n">num_spin</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">b1_Dt</span> <span class="o">*</span> <span class="n">S_hat</span>
        <span class="n">den_spin</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">b2_Dt</span> <span class="o">*</span> <span class="n">S_hat</span>

        <span class="n">Dt44_orb</span> <span class="o">=</span> <span class="n">num_orb</span> <span class="o">/</span> <span class="n">den_orb</span>
        <span class="n">Dt44_spin</span> <span class="o">=</span> <span class="n">num_spin</span> <span class="o">/</span> <span class="n">den_spin</span>

        <span class="n">res</span> <span class="o">=</span> <span class="n">Dt44_0</span> <span class="o">*</span> <span class="n">Dt44_orb</span> <span class="o">*</span> <span class="n">Dt44_spin</span>

    <span class="k">elif</span> <span class="p">(</span><span class="n">l</span> <span class="o">==</span> <span class="mi">4</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">m</span> <span class="o">==</span> <span class="mi">3</span><span class="p">):</span>  <span class="c1"># eqs. C82-C85 of arXiv:2001.09082v2</span>

        <span class="n">b1_Dt</span> <span class="o">=</span> <span class="p">(</span><span class="n">b_1_Dt43</span> <span class="o">+</span> <span class="n">c_11_Dt43</span> <span class="o">*</span> <span class="n">nu</span> <span class="o">+</span> <span class="n">c_12_Dt43</span> <span class="o">*</span> <span class="n">nu2</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span>
            <span class="mi">1</span> <span class="o">+</span> <span class="n">c_13_Dt43</span> <span class="o">*</span> <span class="n">nu</span> <span class="o">+</span> <span class="n">c_14_Dt43</span> <span class="o">*</span> <span class="n">nu2</span>
        <span class="p">)</span>
        <span class="n">b2_Dt</span> <span class="o">=</span> <span class="p">(</span><span class="n">b_2_Dt43</span> <span class="o">+</span> <span class="n">c_21_Dt43</span> <span class="o">*</span> <span class="n">nu</span> <span class="o">+</span> <span class="n">c_22_Dt43</span> <span class="o">*</span> <span class="n">nu2</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span>
            <span class="mi">1</span> <span class="o">+</span> <span class="n">c_23_Dt43</span> <span class="o">*</span> <span class="n">nu</span> <span class="o">+</span> <span class="n">c_24_Dt43</span> <span class="o">*</span> <span class="n">nu2</span>
        <span class="p">)</span>
        <span class="n">b3_Dt</span> <span class="o">=</span> <span class="p">(</span><span class="n">b_3_Dt43</span> <span class="o">+</span> <span class="n">c_31_Dt43</span> <span class="o">*</span> <span class="n">nu</span> <span class="o">+</span> <span class="n">c_32_Dt43</span> <span class="o">*</span> <span class="n">nu2</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span>
            <span class="mi">1</span> <span class="o">+</span> <span class="n">c_33_Dt43</span> <span class="o">*</span> <span class="n">nu</span> <span class="o">+</span> <span class="n">c_34_Dt43</span> <span class="o">*</span> <span class="n">nu2</span>
        <span class="p">)</span>

        <span class="n">num_orb</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">a_1_Dt43</span> <span class="o">*</span> <span class="n">nu</span> <span class="o">+</span> <span class="n">a_2_Dt43</span> <span class="o">*</span> <span class="n">nu2</span>
        <span class="n">den_orb</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">a_3_Dt43</span> <span class="o">*</span> <span class="n">nu</span> <span class="o">+</span> <span class="n">a_4_Dt43</span> <span class="o">*</span> <span class="n">nu2</span>
        <span class="n">num_spin</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">b1_Dt</span> <span class="o">*</span> <span class="n">S_hat</span> <span class="o">+</span> <span class="n">b2_Dt</span> <span class="o">*</span> <span class="n">S_hat2</span>
        <span class="n">den_spin</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">b3_Dt</span> <span class="o">*</span> <span class="n">S_hat</span>

        <span class="n">Dt43_orb</span> <span class="o">=</span> <span class="n">num_orb</span> <span class="o">/</span> <span class="n">den_orb</span>
        <span class="n">Dt43_spin</span> <span class="o">=</span> <span class="n">num_spin</span> <span class="o">/</span> <span class="n">den_spin</span>

        <span class="n">res</span> <span class="o">=</span> <span class="n">Dt43_0</span> <span class="o">*</span> <span class="n">Dt43_orb</span> <span class="o">*</span> <span class="n">Dt43_spin</span>

    <span class="k">elif</span> <span class="p">(</span><span class="n">l</span> <span class="o">==</span> <span class="mi">4</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">m</span> <span class="o">==</span> <span class="mi">2</span><span class="p">):</span>  <span class="c1"># eqs. C94-C97 of arXiv:2001.09082v2</span>

        <span class="k">if</span> <span class="n">nu</span> <span class="o">&lt;</span> <span class="mf">6.0</span> <span class="o">/</span> <span class="mf">25.0</span><span class="p">:</span>
            <span class="n">b1_Dt</span> <span class="o">=</span> <span class="n">b_1_Dt42</span>
            <span class="n">b2_Dt</span> <span class="o">=</span> <span class="n">b_2_Dt42</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">b1_Dt</span> <span class="o">=</span> <span class="p">(</span><span class="n">b_1_Dt42</span> <span class="o">+</span> <span class="n">c_11_Dt42</span> <span class="o">*</span> <span class="n">nu</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">c_12_Dt42</span> <span class="o">*</span> <span class="n">nu</span><span class="p">)</span>
            <span class="n">b2_Dt</span> <span class="o">=</span> <span class="p">(</span><span class="n">b_2_Dt42</span> <span class="o">+</span> <span class="n">c_21_Dt42</span> <span class="o">*</span> <span class="n">nu</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">c_22_Dt42</span> <span class="o">*</span> <span class="n">nu</span><span class="p">)</span>

        <span class="n">num_orb</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">a_1_Dt42</span> <span class="o">*</span> <span class="n">nu</span> <span class="o">+</span> <span class="n">a_2_Dt42</span> <span class="o">*</span> <span class="n">nu2</span>
        <span class="n">den_orb</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">a_3_Dt42</span> <span class="o">*</span> <span class="n">nu</span> <span class="o">+</span> <span class="n">a_4_Dt42</span> <span class="o">*</span> <span class="n">nu2</span>
        <span class="n">num_spin</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">b1_Dt</span> <span class="o">*</span> <span class="n">S_hat</span>
        <span class="n">den_spin</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">b2_Dt</span> <span class="o">*</span> <span class="n">S_hat</span>

        <span class="n">Dt42_orb</span> <span class="o">=</span> <span class="n">num_orb</span> <span class="o">/</span> <span class="n">den_orb</span>
        <span class="n">Dt42_spin</span> <span class="o">=</span> <span class="n">num_spin</span> <span class="o">/</span> <span class="n">den_spin</span>

        <span class="n">res</span> <span class="o">=</span> <span class="n">Dt42_0</span> <span class="o">*</span> <span class="n">Dt42_orb</span> <span class="o">*</span> <span class="n">Dt42_spin</span>

    <span class="k">elif</span> <span class="p">(</span><span class="n">l</span> <span class="o">==</span> <span class="mi">4</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">m</span> <span class="o">==</span> <span class="mi">1</span><span class="p">):</span>  <span class="c1"># eq. 5.23-24 of arXiv:1904.09550v2</span>

        <span class="n">num_orb</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">n_1_Dt41</span> <span class="o">*</span> <span class="n">nu</span> <span class="o">+</span> <span class="n">n_2_Dt41</span> <span class="o">*</span> <span class="n">nu2</span>
        <span class="n">den_orb</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">d_1_Dt41</span> <span class="o">*</span> <span class="n">nu</span> <span class="o">+</span> <span class="n">d_2_Dt41</span> <span class="o">*</span> <span class="n">nu2</span>

        <span class="n">Dt41_orb</span> <span class="o">=</span> <span class="n">num_orb</span> <span class="o">/</span> <span class="n">den_orb</span>

        <span class="n">res</span> <span class="o">=</span> <span class="n">Dt41_0</span> <span class="o">*</span> <span class="n">Dt41_orb</span>

    <span class="k">elif</span> <span class="p">(</span><span class="n">l</span> <span class="o">==</span> <span class="mi">5</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">m</span> <span class="o">==</span> <span class="mi">5</span><span class="p">):</span>  <span class="c1"># TEOBResumSFits.c, line 800</span>

        <span class="n">num_orb</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">n_1_Dt55</span> <span class="o">*</span> <span class="n">nu</span> <span class="o">+</span> <span class="n">n_2_Dt55</span> <span class="o">*</span> <span class="n">nu2</span> <span class="o">+</span> <span class="n">n_3_Dt55</span> <span class="o">*</span> <span class="n">nu3</span> <span class="o">+</span> <span class="n">n_4_Dt55</span> <span class="o">*</span> <span class="n">nu4</span>
        <span class="n">den_orb</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">+</span> <span class="n">d_1_Dt55</span> <span class="o">*</span> <span class="n">nu</span> <span class="o">+</span> <span class="n">d_2_Dt55</span> <span class="o">*</span> <span class="n">nu2</span>

        <span class="n">Dt55_orb</span> <span class="o">=</span> <span class="n">num_orb</span> <span class="o">/</span> <span class="n">den_orb</span>

        <span class="n">res</span> <span class="o">=</span> <span class="n">Dt55_0</span> <span class="o">*</span> <span class="n">Dt55_orb</span>

    <span class="k">return</span> <span class="n">res</span></div>



<div class="viewcode-block" id="_DeltaPhi">
<a class="viewcode-back" href="../../../autoapi/PyART/models/ringdown_fits/index.html#PyART.models.ringdown_fits._DeltaPhi">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">_DeltaPhi</span><span class="p">(</span><span class="n">nu</span><span class="p">,</span> <span class="n">X12</span><span class="p">,</span> <span class="n">S_hat</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">m</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Not implemented</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">res</span> <span class="o">=</span> <span class="mf">0.0</span>

    <span class="k">if</span> <span class="n">l</span> <span class="o">==</span> <span class="mi">2</span> <span class="ow">and</span> <span class="n">m</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>

        <span class="n">res</span> <span class="o">=</span> <span class="mf">0.0</span>

    <span class="k">elif</span> <span class="n">l</span> <span class="o">==</span> <span class="mi">2</span> <span class="ow">and</span> <span class="n">m</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>

        <span class="n">res</span> <span class="o">=</span> <span class="mf">0.0</span>

    <span class="k">elif</span> <span class="n">l</span> <span class="o">==</span> <span class="mi">3</span> <span class="ow">and</span> <span class="n">m</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>

        <span class="n">res</span> <span class="o">=</span> <span class="mf">0.0</span>

    <span class="k">elif</span> <span class="n">l</span> <span class="o">==</span> <span class="mi">3</span> <span class="ow">and</span> <span class="n">m</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>

        <span class="n">res</span> <span class="o">=</span> <span class="mf">0.0</span>

    <span class="k">elif</span> <span class="n">l</span> <span class="o">==</span> <span class="mi">3</span> <span class="ow">and</span> <span class="n">m</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>

        <span class="n">res</span> <span class="o">=</span> <span class="mf">0.0</span>

    <span class="k">elif</span> <span class="n">l</span> <span class="o">==</span> <span class="mi">4</span> <span class="ow">and</span> <span class="n">m</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>

        <span class="n">res</span> <span class="o">=</span> <span class="mf">0.0</span>

    <span class="k">elif</span> <span class="n">l</span> <span class="o">==</span> <span class="mi">4</span> <span class="ow">and</span> <span class="n">m</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>

        <span class="n">res</span> <span class="o">=</span> <span class="mf">0.0</span>

    <span class="k">elif</span> <span class="n">l</span> <span class="o">==</span> <span class="mi">4</span> <span class="ow">and</span> <span class="n">m</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>

        <span class="n">res</span> <span class="o">=</span> <span class="mf">0.0</span>

    <span class="k">elif</span> <span class="n">l</span> <span class="o">==</span> <span class="mi">4</span> <span class="ow">and</span> <span class="n">m</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>

        <span class="n">res</span> <span class="o">=</span> <span class="mf">0.0</span>

    <span class="k">elif</span> <span class="n">l</span> <span class="o">==</span> <span class="mi">5</span> <span class="ow">and</span> <span class="n">m</span> <span class="o">==</span> <span class="mi">5</span><span class="p">:</span>

        <span class="n">res</span> <span class="o">=</span> <span class="mf">0.0</span>

    <span class="k">return</span> <span class="n">res</span></div>

</pre></div>
        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          
          
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2025, Simone Albanesi, Danilo Chiaramello, Rossella Gamba, Koustav Chandra
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer no-toc">
      
      
      
    </aside>
  </div>
</div><script src="../../../_static/documentation_options.js?v=1b65bdd7"></script>
    <script src="../../../_static/doctools.js?v=fd6eb6e6"></script>
    <script src="../../../_static/sphinx_highlight.js?v=6ffebe34"></script>
    <script src="../../../_static/scripts/furo.js?v=46bd48cc"></script>
    </body>
</html>